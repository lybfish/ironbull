(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b323bf6"],{"41cb":function(t,e,a){},"7cf8":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));var i=a("bc3a"),r=a.n(i);function n(){return r.a.get("/monitor/status")}function s(t={}){return r.a.get("/audit-logs",{params:t})}},8012:function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"f",(function(){return u})),a.d(e,"g",(function(){return h})),a.d(e,"a",(function(){return p}));var i=a("bc3a"),r=a.n(i);let n={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function s(t){return{...n,...t}}function o(t={}){return r.a.get("/orders",{params:s({limit:50,...t})})}function l(t={}){return r.a.get("/fills",{params:s({limit:50,...t})})}function c(t={}){return r.a.get("/positions",{params:s({limit:100,...t})})}function d(t={}){return r.a.get("/accounts",{params:s({limit:50,...t})})}function u(t={}){return r.a.get("/transactions",{params:s({limit:50,...t})})}function h(t){return r.a.post("/manual-order",t)}function p(t){return r.a.post("/close-position",t)}},8697:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body ele-body-card"},[a("el-card",{attrs:{shadow:"never","body-style":"padding: 20px;"}},[a("div",{staticClass:"ele-cell workplace-user-card"},[a("div",{staticClass:"ele-cell-content ele-cell"},[a("el-avatar",{attrs:{size:68,src:t.loginUser.avatar||t.defaultAvatar}}),a("div",{staticClass:"ele-cell-content"},[a("h4",{staticClass:"ele-elip"},[t._v("你好，【"+t._s(t.loginUser.nickname||"Admin")+"】，欢迎使用 Aigo 管理后台！")]),a("div",{staticClass:"ele-text-secondary ele-elip",staticStyle:{"margin-top":"8px"}},[a("i",{staticClass:"el-icon-sunny"}),a("span",[t._v("祝您交易顺利，收益满满!")])])])],1),a("div",{staticClass:"workplace-count-group"},[a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:"primary",size:"small"}},[a("i",{staticClass:"el-icon-wallet"})]),a("span",{staticClass:"workplace-count-name"},[t._v("总余额")])],1),a("div",{staticClass:"workplace-count-num"},[t._v("$"+t._s(t.formatMoney(t.tenant.equity)))])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:t.tenant.dailyPnl>=0?"success":"danger",size:"small"}},[a("i",{staticClass:"el-icon-s-data"})]),a("span",{staticClass:"workplace-count-name"},[t._v("日收益")])],1),a("div",{staticClass:"workplace-count-num",class:t.tenant.dailyPnl>=0?"text-success":"text-danger"},[t._v(" $"+t._s(t.formatMoney(t.tenant.dailyPnl))+" ")])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:"warning",size:"small"}},[a("i",{staticClass:"el-icon-s-order"})]),a("span",{staticClass:"workplace-count-name"},[t._v("持仓数")])],1),a("div",{staticClass:"workplace-count-num"},[t._v(t._s(t.tenant.positions||0))])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{size:"small"}},[a("i",{staticClass:"el-icon-s-operation"})]),a("span",{staticClass:"workplace-count-name"},[t._v("活跃策略")])],1),a("div",{staticClass:"workplace-count-num"},[t._v(t._s(t.platform.active_bindings||0))])])])])]),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"租户总数",value:t.platform.total_tenants,icon:"el-icon-s-custom",color:"primary","help-text":"平台注册租户数量",loading:t.loading},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"ele-text-secondary"},[t._v("活跃 "+t._s(t.platform.active_tenants))])]},proxy:!0}])})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"用户总数",value:t.platform.total_users,icon:"el-icon-user",color:"success","help-text":"平台注册用户总数",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"订单总数",value:t.platform.total_orders,icon:"el-icon-document",color:"warning","help-text":"平台累计订单数量",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"执行节点",value:t.platform.total_nodes,icon:"el-icon-s-platform",color:"info","help-text":"已注册的执行节点",loading:t.loading},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"ele-text-secondary"},[t._v("在线 "+t._s(t.platform.online_nodes))])]},proxy:!0}])})],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:16,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("绩效摘要")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("el-row",{attrs:{gutter:20}},t._l(t.perfItems,(function(e){return a("el-col",{key:e.label,staticClass:"perf-item",attrs:{span:4}},[a("div",{staticClass:"perf-label"},[t._v(t._s(e.label))]),a("div",{staticClass:"perf-value",class:e.cls||""},[t._v(t._s(e.value))])])})),1)],1)],1),a("el-col",{attrs:{lg:8,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("系统状态")]),a("el-tag",{attrs:{type:t.systemHealthy?"success":"danger",size:"small"}},[t._v(" "+t._s(t.systemHealthy?"正常":"异常")+" ")])],1),a("div",{staticClass:"system-status-grid"},[a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("data-api")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.data_api?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.data_api?"在线":"离线")+" ")])],1)]),a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("signal-monitor")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.signal_monitor?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.signal_monitor?"在线":"离线")+" ")])],1)]),a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("数据库")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.database?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.database?"正常":"异常")+" ")])],1)])]),a("div",{staticStyle:{"text-align":"center","margin-top":"15px"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v(" 刷新数据 ")])],1)])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日订单量")]),a("el-radio-group",{attrs:{size:"mini"},on:{change:t.fetchTrends},model:{value:t.trendDays,callback:function(e){t.trendDays=e},expression:"trendDays"}},[a("el-radio-button",{attrs:{label:7}},[t._v("7天")]),a("el-radio-button",{attrs:{label:30}},[t._v("30天")]),a("el-radio-button",{attrs:{label:60}},[t._v("60天")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartOrders",staticStyle:{height:"260px"}})])],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日新增用户")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartUsers",staticStyle:{height:"260px"}})])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日成交额 (USDT)")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartVolume",staticStyle:{height:"260px"}})])],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日利润池入池 (USDT)")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartPool",staticStyle:{height:"260px"}})])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/orders"}},[a("i",{staticClass:"app-link-icon el-icon-s-order"}),a("div",{staticClass:"app-link-title"},[t._v("订单管理")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/positions"}},[a("i",{staticClass:"app-link-icon el-icon-s-data",staticStyle:{color:"#95de64"}}),a("div",{staticClass:"app-link-title"},[t._v("当前持仓")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/strategy/list"}},[a("i",{staticClass:"app-link-icon el-icon-s-opportunity",staticStyle:{color:"#ff9c6e"}}),a("div",{staticClass:"app-link-title"},[t._v("策略目录")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/monitor/signal-control"}},[a("i",{staticClass:"app-link-icon el-icon-connection",staticStyle:{color:"#b37feb"}}),a("div",{staticClass:"app-link-title"},[t._v("信号监控")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/system/tenants"}},[a("i",{staticClass:"app-link-icon el-icon-s-custom",staticStyle:{color:"#ffd666"}}),a("div",{staticClass:"app-link-title"},[t._v("租户管理")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/user/exchange-accounts"}},[a("i",{staticClass:"app-link-icon el-icon-wallet",staticStyle:{color:"#5cdbd3"}}),a("div",{staticClass:"app-link-title"},[t._v("交易账户")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/monitor/nodes"}},[a("i",{staticClass:"app-link-icon el-icon-s-platform",staticStyle:{color:"#ff85c0"}}),a("div",{staticClass:"app-link-title"},[t._v("执行节点")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/analytics"}},[a("i",{staticClass:"app-link-icon el-icon-data-analysis",staticStyle:{color:"#ffc069"}}),a("div",{staticClass:"app-link-title"},[t._v("绩效分析")])])],1)],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{span:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("近期信号")]),a("router-link",{attrs:{to:"/strategy/signal-history"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看全部")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.recentSignals,stripe:"",size:"mini","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"signal_id",label:"信号ID",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{staticStyle:{"font-family":"monospace","font-size":"12px"}},[t._v(t._s((i.signal_id||"").slice(0,16)))])]}}])}),a("el-table-column",{attrs:{prop:"event_type",label:"事件",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{type:t.signalTagType(i.event_type),size:"mini"}},[t._v(t._s(i.event_type))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{type:"SUCCESS"===i.status?"success":"FAILED"===i.status?"danger":"warning",size:"mini"}},[t._v(" "+t._s(i.status)+" ")])]}}])}),a("el-table-column",{attrs:{label:"详情","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{staticStyle:{"font-size":"12px",color:"#606266"}},[t._v(t._s(t.signalDetail(i)))])]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(i.created_at||"-"))])]}}])})],1),t.loading||0!==t.recentSignals.length?t._e():a("el-empty",{attrs:{description:"暂无信号记录","image-size":60}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("账户资产")]),a("router-link",{attrs:{to:"/trading/accounts"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("详情")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("当前权益")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.formatMoney(t.tenant.equity))+" USDT")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("累计收益率")]),a("div",{staticClass:"trade-overview-value",class:t.tenant.totalReturn>=0?"text-success":"text-danger"},[t._v(" "+t._s(t.fmtPct(t.tenant.totalReturn))+" ")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("最大回撤")]),a("div",{staticClass:"trade-overview-value text-danger"},[t._v(t._s(t.fmtPct(t.tenant.maxDrawdown)))])])])],1),a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("持仓概览")]),a("router-link",{attrs:{to:"/trading/positions"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("管理")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("活跃持仓")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.positions||0)+" 个")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("总订单数")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.orders||0))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("胜率")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.fmtPct(t.tenant.winRate,1)))])])])],1),a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("风险指标")]),a("router-link",{attrs:{to:"/trading/analytics"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("夏普比率")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(null!==t.tenant.sharpeRatio&&void 0!==t.tenant.sharpeRatio?t.tenant.sharpeRatio.toFixed(2):"-"))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("总交易次数")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.totalTrades||"-"))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("日收益")]),a("div",{staticClass:"trade-overview-value",class:t.tenant.dailyPnl>=0?"text-success":"text-danger"},[t._v(" "+t._s(null!==t.tenant.dailyPnl&&void 0!==t.tenant.dailyPnl?t.tenant.dailyPnl.toFixed(2):"-")+" ")])])])],1)],1)],1)},r=[],n=(a("0643"),a("fffc"),a("4e3e"),a("a573"),a("de2b")),s=a("8012"),o=a("7cf8"),l=a("50fc"),c=a("22b4"),d=a("1be7"),u=a("3620"),h=a("6d8b"),p=a("9d57"),g=a("fdde"),v=a("9ab4"),f=a("4f85"),m=a("3301"),y=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(v["a"])(e,t),e.prototype.getInitialData=function(t,e){return Object(m["a"])(this.getSource(),this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t){var e=this.coordinateSystem;if(e){var a=e.dataToPoint(e.clampData(t)),i=this.getData(),r=i.getLayout("offset"),n=i.getLayout("size"),s=e.getBaseAxis().isHorizontal()?0:1;return a[s]+=r+n/2,a}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(f["a"]);f["a"].registerClass(y);var _=y,b=a("8918"),w=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(v["a"])(e,t),e.prototype.getInitialData=function(){return Object(m["a"])(this.getSource(),this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return e>t&&(t=e),t},e.prototype.brushSelector=function(t,e,a){return a.rect(e.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=Object(b["d"])(_.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(_),x=w,C=a("cbe5"),S=a("2dc5"),I=a("2306"),O=a("c7a2"),k=a("4aa2"),A=a("861c"),P=a("7d6c"),D=a("7837"),L=a("88b3"),R=a("b0af"),M=function(){function t(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}return t}(),j=function(t){function e(e){var a=t.call(this,e)||this;return a.type="sausage",a}return Object(v["a"])(e,t),e.prototype.getDefaultShape=function(){return new M},e.prototype.buildPath=function(t,e){var a=e.cx,i=e.cy,r=Math.max(e.r0||0,0),n=Math.max(e.r,0),s=.5*(n-r),o=r+s,l=e.startAngle,c=e.endAngle,d=e.clockwise,u=Math.cos(l),h=Math.sin(l),p=Math.cos(c),g=Math.sin(c),v=d?c-l<2*Math.PI:l-c<2*Math.PI;v&&(t.moveTo(u*r+a,h*r+i),t.arc(u*o+a,h*o+i,s,-Math.PI+l,l,!d)),t.arc(a,i,n,l,c,!d),t.moveTo(p*n+a,g*n+i),t.arc(p*o+a,g*o+i,s,c-2*Math.PI,c-Math.PI,!d),0!==r&&(t.arc(a,i,r,c,l,d),t.moveTo(u*r+a,g*r+i)),t.closePath()},e}(C["b"]),z=j,T=a("e887"),G=a("5426"),E=a("c775"),B=[0,0],N=Math.max,W=Math.min;function F(t,e){var a=t.getArea&&t.getArea();if(Object(G["a"])(t,"cartesian2d")){var i=t.getBaseAxis();if("category"!==i.type||!i.onBand){var r=e.getLayout("bandWidth");i.isHorizontal()?(a.x-=r,a.width+=2*r):(a.y-=r,a.height+=2*r)}}return a}var V=function(t){function e(){var a=t.call(this)||this;return a.type=e.type,a._isFirstFrame=!0,a}return Object(v["a"])(e,t),e.prototype.render=function(t,e,a,i){this._model=t,this._removeOnRenderedListener(a),this._updateDrawMode(t);var r=t.get("coordinateSystem");("cartesian2d"===r||"polar"===r)&&(this._isLargeDraw?this._renderLarge(t,e,a):this._renderNormal(t,e,a,i))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,e){this._incrementalRenderLarge(t,e)},e.prototype._updateDrawMode=function(t){var e=t.pipelineContext.large;null!=this._isLargeDraw&&e===this._isLargeDraw||(this._isLargeDraw=e,this._clear())},e.prototype._renderNormal=function(t,e,a,i){var r,n=this.group,s=t.getData(),o=this._data,l=t.coordinateSystem,c=l.getBaseAxis();"cartesian2d"===l.type?r=c.isHorizontal():"polar"===l.type&&(r="angle"===c.dim);var d=t.isAnimationEnabled()?t:null,u=Y(t,l);u&&this._enableRealtimeSort(u,s,a);var h=t.get("clip",!0)||u,p=F(l,s);n.removeClipPath();var g=t.get("roundCap",!0),v=t.get("showBackground",!0),f=t.getModel("backgroundStyle"),m=f.get("borderRadius")||0,y=[],_=this._backgroundEls,b=i&&i.isInitSort,w=i&&"changeAxisOrder"===i.type;function x(t){var e=X[l.type](s,t),a=st(l,r,e);return a.useStyle(f.getItemStyle()),"cartesian2d"===l.type&&a.setShape("r",m),y[t]=a,a}s.diff(o).add((function(e){var a=s.getItemModel(e),i=X[l.type](s,e,a);if(v&&x(e),s.hasValue(e)){var o=!1;h&&(o=H[l.type](p,i));var f=U[l.type](t,s,e,i,r,d,c.model,!1,g);J(f,s,e,a,i,t,r,"polar"===l.type),b?f.attr({shape:i}):u?q(u,d,f,i,e,r,!1,!1):Object(I["initProps"])(f,{shape:i},t,e),s.setItemGraphicEl(e,f),n.add(f),f.ignore=o}})).update((function(e,a){var i=s.getItemModel(e),C=X[l.type](s,e,i);if(v){var S=void 0;0===_.length?S=x(a):(S=_[a],S.useStyle(f.getItemStyle()),"cartesian2d"===l.type&&S.setShape("r",m),y[e]=S);var O=X[l.type](s,e),k=nt(r,O,l);Object(I["updateProps"])(S,{shape:k},d,e)}var A=o.getItemGraphicEl(a);if(!s.hasValue(e))return n.remove(A),void(A=null);var P=!1;h&&(P=H[l.type](p,C),P&&n.remove(A)),A||(A=U[l.type](t,s,e,C,r,d,c.model,!!A,g)),w||J(A,s,e,i,C,t,r,"polar"===l.type),b?A.attr({shape:C}):u?q(u,d,A,C,e,r,!0,w):Object(I["updateProps"])(A,{shape:C},t,e,null),s.setItemGraphicEl(e,A),A.ignore=P,n.add(A)})).remove((function(e){var a=o.getItemGraphicEl(e);a&&Object(I["removeElementWithFadeOut"])(a,t,e)})).execute();var C=this._backgroundGroup||(this._backgroundGroup=new S["a"]);C.removeAll();for(var O=0;O<y.length;++O)C.add(y[O]);n.add(C),this._backgroundEls=y,this._data=s},e.prototype._renderLarge=function(t,e,a){this._clear(),tt(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,e){this._removeBackground(),tt(e,this.group,!0)},e.prototype._updateLargeClip=function(t){var e=t.get("clip",!0)?Object(R["a"])(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},e.prototype._enableRealtimeSort=function(t,e,a){var i=this;if(e.count()){var r=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(e,t,a),this._isFirstFrame=!1;else{var n=function(t){var a=e.getItemGraphicEl(t);if(a){var i=a.shape;return(r.isHorizontal()?Math.abs(i.height):Math.abs(i.width))||0}return 0};this._onRendered=function(){i._updateSortWithinSameData(e,n,r,a)},a.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,e,a){var i=[];return t.each(t.mapDimension(e.dim),(function(t,e){var r=a(e);r=null==r?NaN:r,i.push({dataIndex:e,mappedValue:r,ordinalNumber:t})})),i.sort((function(t,e){return e.mappedValue-t.mappedValue})),{ordinalNumbers:Object(h["E"])(i,(function(t){return t.ordinalNumber}))}},e.prototype._isOrderChangedWithinSameData=function(t,e,a){for(var i=a.scale,r=t.mapDimension(a.dim),n=Number.MAX_VALUE,s=0,o=i.getOrdinalMeta().categories.length;s<o;++s){var l=t.rawIndexOf(r,i.getRawOrdinalNumber(s)),c=l<0?Number.MIN_VALUE:e(t.indexOfRawIndex(l));if(c>n)return!0;n=c}return!1},e.prototype._isOrderDifferentInView=function(t,e){for(var a=e.scale,i=a.getExtent(),r=Math.max(0,i[0]),n=Math.min(i[1],a.getOrdinalMeta().categories.length-1);r<=n;++r)if(t.ordinalNumbers[r]!==a.getRawOrdinalNumber(r))return!0},e.prototype._updateSortWithinSameData=function(t,e,a,i){if(this._isOrderChangedWithinSameData(t,e,a)){var r=this._dataSort(t,a,e);this._isOrderDifferentInView(r,a)&&(this._removeOnRenderedListener(i),i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",axisId:a.index,sortInfo:r}))}},e.prototype._dispatchInitSort=function(t,e,a){var i=e.baseAxis,r=this._dataSort(t,i,(function(a){return t.get(t.mapDimension(e.otherAxis.dim),a)}));a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",isInitSort:!0,axisId:i.index,sortInfo:r,animation:{duration:0}})},e.prototype.remove=function(t,e){this._clear(this._model),this._removeOnRenderedListener(e)},e.prototype.dispose=function(t,e){this._removeOnRenderedListener(e)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var e=this.group,a=this._data;t&&t.isAnimationEnabled()&&a&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],a.eachItemGraphicEl((function(e){Object(I["removeElementWithFadeOut"])(e,t,Object(A["a"])(e).dataIndex)}))):e.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(T["a"]),H={cartesian2d:function(t,e){var a=e.width<0?-1:1,i=e.height<0?-1:1;a<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height);var r=t.x+t.width,n=t.y+t.height,s=N(e.x,t.x),o=W(e.x+e.width,r),l=N(e.y,t.y),c=W(e.y+e.height,n),d=o<s,u=c<l;return e.x=d&&s>r?o:s,e.y=u&&l>n?c:l,e.width=d?0:o-s,e.height=u?0:c-l,a<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height),d||u},polar:function(t,e){var a=e.r0<=e.r?1:-1;if(a<0){var i=e.r;e.r=e.r0,e.r0=i}var r=W(e.r,t.r),n=N(e.r0,t.r0);e.r=r,e.r0=n;var s=r-n<0;if(a<0){i=e.r;e.r=e.r0,e.r0=i}return s}},U={cartesian2d:function(t,e,a,i,r,n,s,o,l){var c=new O["a"]({shape:Object(h["l"])({},i),z2:1});if(c.__dataIndex=a,c.name="item",n){var d=c.shape,u=r?"height":"width";d[u]=0}return c},polar:function(t,e,a,i,r,n,s,o,l){var c=i.startAngle<i.endAngle,d=!r&&l?z:k["a"],u=new d({shape:Object(h["i"])({clockwise:c},i),z2:1});if(u.name="item",n){var p=u.shape,g=r?"r":"endAngle",v={};p[g]=r?0:i.startAngle,v[g]=i[g],(o?I["updateProps"]:I["initProps"])(u,{shape:v},n)}return u}};function Y(t,e){var a=t.get("realtimeSort",!0),i=e.getBaseAxis();if(a&&"category"===i.type&&"cartesian2d"===e.type)return{baseAxis:i,otherAxis:e.getOtherAxis(i)}}function q(t,e,a,i,r,n,s,o){var l,c;n?(c={x:i.x,width:i.width},l={y:i.y,height:i.height}):(c={y:i.y,height:i.height},l={x:i.x,width:i.width}),o||(s?I["updateProps"]:I["initProps"])(a,{shape:l},e,r,null);var d=e?t.baseAxis.model:null;(s?I["updateProps"]:I["initProps"])(a,{shape:c},d,r)}var X={cartesian2d:function(t,e,a){var i=t.getItemLayout(e),r=a?Z(a,i):0,n=i.width>0?1:-1,s=i.height>0?1:-1;return{x:i.x+n*r/2,y:i.y+s*r/2,width:i.width-n*r,height:i.height-s*r}},polar:function(t,e,a){var i=t.getItemLayout(e);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle}}};function $(t){return null!=t.startAngle&&null!=t.endAngle&&t.startAngle===t.endAngle}function J(t,e,a,i,r,n,s,o){var l=e.getItemVisual(a,"style");o||t.setShape("r",i.get(["itemStyle","borderRadius"])||0),t.useStyle(l);var c=i.getShallow("cursor");if(c&&t.attr("cursor",c),!o){var d=s?r.height>0?"bottom":"top":r.width>0?"left":"right",u=Object(D["d"])(i);Object(D["f"])(t,u,{labelFetcher:n,labelDataIndex:a,defaultText:Object(E["b"])(n.getData(),a),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var p=t.getTextContent();Object(D["g"])(p,u,n.getRawValue(a),(function(t){return Object(E["a"])(e,t)}))}var g=i.getModel(["emphasis"]);Object(P["m"])(t,g.get("focus"),g.get("blurScope")),Object(P["D"])(t,i),$(r)&&(t.style.fill="none",t.style.stroke="none",Object(h["j"])(t.states,(function(t){t.style&&(t.style.fill=t.style.stroke="none")})))}function Z(t,e){var a=t.get(["itemStyle","borderColor"]);if(!a||"none"===a)return 0;var i=t.get(["itemStyle","borderWidth"])||0,r=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),n=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(i,r,n)}var K=function(){function t(){}return t}(),Q=function(t){function e(e){var a=t.call(this,e)||this;return a.type="largeBar",a}return Object(v["a"])(e,t),e.prototype.getDefaultShape=function(){return new K},e.prototype.buildPath=function(t,e){for(var a=e.points,i=this.__startPoint,r=this.__baseDimIdx,n=0;n<a.length;n+=2)i[r]=a[n+r],t.moveTo(i[0],i[1]),t.lineTo(a[n],a[n+1])},e}(C["b"]);function tt(t,e,a){var i=t.getData(),r=[],n=i.getLayout("valueAxisHorizontal")?1:0;r[1-n]=i.getLayout("valueAxisStart");var s=i.getLayout("largeDataIndices"),o=i.getLayout("barWidth"),l=t.getModel("backgroundStyle"),c=t.get("showBackground",!0);if(c){var d=i.getLayout("largeBackgroundPoints"),u=[];u[1-n]=i.getLayout("backgroundStart");var h=new Q({shape:{points:d},incremental:!!a,silent:!0,z2:0});h.__startPoint=u,h.__baseDimIdx=n,h.__largeDataIndices=s,h.__barWidth=o,rt(h,l,i),e.add(h)}var p=new Q({shape:{points:i.getLayout("largePoints")},incremental:!!a});p.__startPoint=r,p.__baseDimIdx=n,p.__largeDataIndices=s,p.__barWidth=o,e.add(p),it(p,t,i),Object(A["a"])(p).seriesIndex=t.seriesIndex,t.get("silent")||(p.on("mousedown",et),p.on("mousemove",et))}var et=Object(L["c"])((function(t){var e=this,a=at(e,t.offsetX,t.offsetY);Object(A["a"])(e).dataIndex=a>=0?a:null}),30,!1);function at(t,e,a){var i=t.__baseDimIdx,r=1-i,n=t.shape.points,s=t.__largeDataIndices,o=Math.abs(t.__barWidth/2),l=t.__startPoint[r];B[0]=e,B[1]=a;for(var c=B[i],d=B[1-i],u=c-o,h=c+o,p=0,g=n.length/2;p<g;p++){var v=2*p,f=n[v+i],m=n[v+r];if(f>=u&&f<=h&&(l<=m?d>=l&&d<=m:d>=m&&d<=l))return s[p]}return-1}function it(t,e,a){var i=a.getVisual("style");t.useStyle(Object(h["l"])({},i)),t.style.fill=null,t.style.stroke=i.fill,t.style.lineWidth=a.getLayout("barWidth")}function rt(t,e,a){var i=e.get("borderColor")||e.get("color"),r=e.getItemStyle();t.useStyle(r),t.style.fill=null,t.style.stroke=i,t.style.lineWidth=a.getLayout("barWidth")}function nt(t,e,a){if(Object(G["a"])(a,"cartesian2d")){var i=e,r=a.getArea();return{x:t?i.x:r.x,y:t?r.y:i.y,width:t?i.width:r.width,height:t?r.height:i.height}}r=a.getArea();var n=e;return{cx:r.cx,cy:r.cy,r0:t?r.r0:n.r0,r:t?r.r:n.r,startAngle:t?n.startAngle:0,endAngle:t?n.endAngle:2*Math.PI}}function st(t,e,a){var i="polar"===t.type?k["a"]:O["a"];return new i({shape:nt(e,a,t),silent:!0,z2:0})}var ot=V;function lt(t){t.registerChartView(ot),t.registerSeriesModel(x),t.registerLayout(t.PRIORITY.VISUAL.LAYOUT,h["h"](p["b"],"bar")),t.registerLayout(t.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,p["a"]),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,Object(g["a"])("bar")),t.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},(function(t,e){var a=t.componentType||"series";e.eachComponent({mainType:a,query:t},(function(e){t.sortInfo&&e.axis.setCategorySortInfo(t.sortInfo)}))}))}var ct=a("4b2a"),dt=a("2da7"),ut=a("4319"),ht=a("e0d3"),pt=a("6cb7"),gt=function(t,e){return"all"===e?{type:"all",title:t.getLocale(["legend","selector","all"])}:"inverse"===e?{type:"inverse",title:t.getLocale(["legend","selector","inverse"])}:void 0},vt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.layoutMode={type:"box",ignoreSize:!0},a}return Object(v["a"])(e,t),e.prototype.init=function(t,e,a){this.mergeDefaultAndTheme(t,a),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(e,a){t.prototype.mergeOption.call(this,e,a),this._updateSelector(e)},e.prototype._updateSelector=function(t){var e=t.selector,a=this.ecModel;!0===e&&(e=t.selector=["all","inverse"]),h["r"](e)&&h["j"](e,(function(t,i){h["z"](t)&&(t={type:t}),e[i]=h["F"](t,gt(a,t.type))}))},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,a=0;a<t.length;a++){var i=t[a].get("name");if(this.isSelected(i)){this.select(i),e=!0;break}}!e&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var e=[],a=[];t.eachRawSeries((function(i){var r,n=i.name;if(a.push(n),i.legendVisualProvider){var s=i.legendVisualProvider,o=s.getAllNames();t.isSeriesFiltered(i)||(a=a.concat(o)),o.length?e=e.concat(o):r=!0}else r=!0;r&&Object(ht["l"])(i)&&e.push(i.name)})),this._availableNames=a;var i=this.get("data")||e,r=h["E"](i,(function(t){return"string"!==typeof t&&"number"!==typeof t||(t={name:t}),new ut["a"](t,this,this.ecModel)}),this);this._data=r},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var e=this.option.selected,a=this.get("selectedMode");if("single"===a){var i=this._data;h["j"](i,(function(t){e[t.get("name")]=!1}))}e[t]=!0},e.prototype.unSelect=function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,e=this.option.selected;h["j"](t,(function(t){e[t.get("name",!0)]=!0}))},e.prototype.inverseSelect=function(){var t=this._data,e=this.option.selected;h["j"](t,(function(t){var a=t.get("name",!0);e.hasOwnProperty(a)||(e[a]=!0),e[a]=!e[a]}))},e.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&h["p"](this._availableNames,t)>=0},e.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",decal:"inherit",shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit",shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(pt["a"]),ft=vt,mt=a("41ef"),yt=a("76a5"),_t=a("f934"),bt=a("eda2");function wt(t,e){var a=bt["g"](e.get("padding")),i=e.getItemStyle(["color","opacity"]);return i.fill=e.get("backgroundColor"),t=new O["a"]({shape:{x:t.x-a[3],y:t.y-a[0],width:t.width+a[1]+a[3],height:t.height+a[0]+a[2],r:e.get("borderRadius")},style:i,silent:!0,z2:-1}),t}var xt=a("b12f"),Ct=a("3901"),St=a("551f"),It=a("a15a"),Ot=h["h"],kt=h["j"],At=S["a"],Pt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.newlineDisabled=!1,a}return Object(v["a"])(e,t),e.prototype.init=function(){this.group.add(this._contentGroup=new At),this.group.add(this._selectorGroup=new At),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,e,a){var i=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var r=t.get("align"),n=t.get("orient");r&&"auto"!==r||(r="right"===t.get("left")&&"vertical"===n?"right":"left");var s=t.get("selector",!0),o=t.get("selectorPosition",!0);!s||o&&"auto"!==o||(o="horizontal"===n?"end":"start"),this.renderInner(r,t,e,a,s,n,o);var l=t.getBoxLayoutParams(),c={width:a.getWidth(),height:a.getHeight()},d=t.get("padding"),u=_t["d"](l,c,d),p=this.layoutInner(t,r,u,i,s,o),g=_t["d"](h["i"]({width:p.width,height:p.height},l),c,d);this.group.x=g.x-p.x,this.group.y=g.y-p.y,this.group.markRedraw(),this.group.add(this._backgroundEl=wt(p,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,e,a,i,r,n,s){var o=this.getContentGroup(),l=h["f"](),c=e.get("selectedMode"),d=[];a.eachRawSeries((function(t){!t.get("legendHoverLink")&&d.push(t.id)})),kt(e.getData(),(function(r,n){var s=r.get("name");if(!this.newlineDisabled&&(""===s||"\n"===s)){var u=new At;return u.newline=!0,void o.add(u)}var h=a.getSeriesByName(s)[0];if(!l.get(s)){if(h){var p=h.getData(),g=p.getVisual("legendLineStyle")||{},v=p.getVisual("legendIcon"),f=p.getVisual("style"),m=this._createItem(h,s,n,r,e,t,g,f,v,c);m.on("click",Ot(Rt,s,null,i,d)).on("mouseover",Ot(jt,h.name,null,i,d)).on("mouseout",Ot(zt,h.name,null,i,d)),l.set(s,!0)}else a.eachRawSeries((function(a){if(!l.get(s)&&a.legendVisualProvider){var o=a.legendVisualProvider;if(!o.containName(s))return;var u=o.indexOfName(s),h=o.getItemVisual(u,"style"),p=o.getItemVisual(u,"legendIcon"),g=Object(mt["c"])(h.fill);g&&0===g[3]&&(g[3]=.2,h.fill=Object(mt["d"])(g,"rgba"));var v=this._createItem(a,s,n,r,e,t,{},h,p,c);v.on("click",Ot(Rt,null,s,i,d)).on("mouseover",Ot(jt,null,s,i,d)).on("mouseout",Ot(zt,null,s,i,d)),l.set(s,!0)}}),this);0}}),this),r&&this._createSelector(r,e,i,n,s)},e.prototype._createSelector=function(t,e,a,i,r){var n=this.getSelectorGroup();kt(t,(function(t){var i=t.type,r=new yt["a"]({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){a.dispatchAction({type:"all"===i?"legendAllSelect":"legendInverseSelect"})}});n.add(r);var s=e.getModel("selectorLabel"),o=e.getModel(["emphasis","selectorLabel"]);Object(D["f"])(r,{normal:s,emphasis:o},{defaultText:t.title}),Object(P["m"])(r)}))},e.prototype._createItem=function(t,e,a,i,r,n,s,o,l,c){var d=t.visualDrawType,u=r.get("itemWidth"),h=r.get("itemHeight"),p=r.isSelected(e),g=i.get("symbolRotate"),v=i.get("icon");l=v||l||"roundRect";var f=r.getModel("lineStyle"),m=Dt(l,i,f,s,o,d,p),y=new At,_=i.getModel("textStyle");if("function"!==typeof t.getLegendIcon||v&&"inherit"!==v){var b="inherit"===v&&t.getData().getVisual("symbol")?"inherit"===g?t.getData().getVisual("symbolRotate"):g:0;y.add(Lt({itemWidth:u,itemHeight:h,icon:l,iconRotate:b,itemStyle:m.itemStyle,lineStyle:m.lineStyle}))}else y.add(t.getLegendIcon({itemWidth:u,itemHeight:h,icon:l,iconRotate:g,itemStyle:m.itemStyle,lineStyle:m.lineStyle}));var w="left"===n?u+5:-5,x=n,C=r.get("formatter"),S=e;"string"===typeof C&&C?S=C.replace("{name}",null!=e?e:""):"function"===typeof C&&(S=C(e));var k=i.get("inactiveColor");y.add(new yt["a"]({style:Object(D["b"])(_,{text:S,x:w,y:h/2,fill:p?_.getTextColor():k,align:x,verticalAlign:"middle"})}));var A=new O["a"]({shape:y.getBoundingRect(),invisible:!0}),L=i.getModel("tooltip");return L.get("show")&&I["setTooltipConfig"]({el:A,componentModel:r,itemName:e,itemTooltipOption:L.option}),y.add(A),y.eachChild((function(t){t.silent=!0})),A.silent=!c,this.getContentGroup().add(y),Object(P["m"])(y),y.__legendDataIndex=a,y},e.prototype.layoutInner=function(t,e,a,i,r,n){var s=this.getContentGroup(),o=this.getSelectorGroup();_t["a"](t.get("orient"),s,t.get("itemGap"),a.width,a.height);var l=s.getBoundingRect(),c=[-l.x,-l.y];if(o.markRedraw(),s.markRedraw(),r){_t["a"]("horizontal",o,t.get("selectorItemGap",!0));var d=o.getBoundingRect(),u=[-d.x,-d.y],h=t.get("selectorButtonGap",!0),p=t.getOrient().index,g=0===p?"width":"height",v=0===p?"height":"width",f=0===p?"y":"x";"end"===n?u[p]+=l[g]+h:c[p]+=d[g]+h,u[1-p]+=l[v]/2-d[v]/2,o.x=u[0],o.y=u[1],s.x=c[0],s.y=c[1];var m={x:0,y:0};return m[g]=l[g]+h+d[g],m[v]=Math.max(l[v],d[v]),m[f]=Math.min(0,d[f]+u[1-p]),m}return s.x=c[0],s.y=c[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(xt["a"]);function Dt(t,e,a,i,r,n,s){for(var o=e.getModel("itemStyle"),l=St["a"].concat([["decal"]]),c={},d=0;d<l.length;++d){var u=l[d][l[d].length-1],h=l[d][0],p=o.getShallow(u);if("inherit"===p)switch(h){case"fill":c.fill=r[n];break;case"stroke":c.stroke=r[0===t.lastIndexOf("empty",0)?"fill":"stroke"];break;case"opacity":c.opacity=("fill"===n?r:i).opacity;break;default:c[h]=r[h]}else"auto"===p&&"lineWidth"===h?c.lineWidth=r.lineWidth>0?2:0:c[h]=p}var g=e.getModel("lineStyle"),v=Ct["a"].concat([["inactiveColor"],["inactiveWidth"]]),f={};for(d=0;d<v.length;++d){u=v[d][1],h=v[d][0],p=g.getShallow(u);"inherit"===p?f[h]=i[h]:"auto"===p&&"lineWidth"===h?f.lineWidth=i.lineWidth>0?2:0:f[h]=p}if("auto"===c.fill&&(c.fill=r.fill),"auto"===c.stroke&&(c.stroke=r.fill),"auto"===f.stroke&&(f.stroke=r.fill),!s){var m=e.get("inactiveBorderWidth"),y=c[t.indexOf("empty")>-1?"fill":"stroke"];c.lineWidth="auto"===m?r.lineWidth>0&&y?2:0:c.lineWidth,c.fill=e.get("inactiveColor"),c.stroke=e.get("inactiveBorderColor"),f.stroke=a.get("inactiveColor"),f.lineWidth=a.get("inactiveWidth")}return{itemStyle:c,lineStyle:f}}function Lt(t){var e=t.icon||"roundRect",a=Object(It["a"])(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill);return a.setStyle(t.itemStyle),a.rotation=(t.iconRotate||0)*Math.PI/180,a.setOrigin([t.itemWidth/2,t.itemHeight/2]),e.indexOf("empty")>-1&&(a.style.stroke=a.style.fill,a.style.fill="#fff",a.style.lineWidth=2),a}function Rt(t,e,a,i){zt(t,e,a,i),a.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),jt(t,e,a,i)}function Mt(t){var e,a=t.getZr().storage.getDisplayList(),i=0,r=a.length;while(i<r&&!(e=a[i].states.emphasis))i++;return e&&e.hoverLayer}function jt(t,e,a,i){Mt(a)||a.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:i})}function zt(t,e,a,i){Mt(a)||a.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:i})}var Tt=Pt;function Gt(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries((function(t){for(var a=0;a<e.length;a++)if(!e[a].isSelected(t.name))return!1;return!0}))}function Et(t,e,a){var i,r={},n="toggleSelected"===t;return a.eachComponent("legend",(function(a){n&&null!=i?a[i?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?a[t]():(a[t](e.name),i=a.isSelected(e.name));var s=a.getData();Object(h["j"])(s,(function(t){var e=t.get("name");if("\n"!==e&&""!==e){var i=a.isSelected(e);r.hasOwnProperty(e)?r[e]=r[e]&&i:r[e]=i}}))})),"allSelect"===t||"inverseSelect"===t?{selected:r}:{name:e.name,selected:r}}function Bt(t){t.registerAction("legendToggleSelect","legendselectchanged",Object(h["h"])(Et,"toggleSelected")),t.registerAction("legendAllSelect","legendselectall",Object(h["h"])(Et,"allSelect")),t.registerAction("legendInverseSelect","legendinverseselect",Object(h["h"])(Et,"inverseSelect")),t.registerAction("legendSelect","legendselected",Object(h["h"])(Et,"select")),t.registerAction("legendUnSelect","legendunselected",Object(h["h"])(Et,"unSelect"))}function Nt(t){t.registerComponentModel(ft),t.registerComponentView(Tt),t.registerProcessor(t.PRIORITY.PROCESSOR.SERIES_FILTER,Gt),t.registerSubTypeDefaulter("legend",(function(){return"plain"})),Bt(t)}var Wt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(v["a"])(e,t),e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(e,a,i){var r=Object(_t["c"])(e);t.prototype.init.call(this,e,a,i),Ft(this,e,r)},e.prototype.mergeOption=function(e,a){t.prototype.mergeOption.call(this,e,a),Ft(this,this.option,e)},e.type="legend.scroll",e.defaultOption=Object(b["d"])(ft.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(ft);function Ft(t,e,a){var i=t.getOrient(),r=[1,1];r[i.index]=0,Object(_t["e"])(e,a,{type:"box",ignoreSize:!!r})}var Vt=Wt,Ht=S["a"],Ut=["width","height"],Yt=["x","y"],qt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.newlineDisabled=!0,a._currentIndex=0,a}return Object(v["a"])(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.group.add(this._containerGroup=new Ht),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Ht)},e.prototype.resetInner=function(){t.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(e,a,i,r,n,s,o){var l=this;t.prototype.renderInner.call(this,e,a,i,r,n,s,o);var c=this._controllerGroup,d=a.get("pageIconSize",!0),u=h["r"](d)?d:[d,d];g("pagePrev",0);var p=a.getModel("pageTextStyle");function g(t,e){var i=t+"DataIndex",n=I["createIcon"](a.get("pageIcons",!0)[a.getOrient().name][e],{onclick:h["c"](l._pageGo,l,i,a,r)},{x:-u[0]/2,y:-u[1]/2,width:u[0],height:u[1]});n.name=t,c.add(n)}c.add(new yt["a"]({name:"pageText",style:{text:"xx/xx",fill:p.getTextColor(),font:p.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),g("pageNext",1)},e.prototype.layoutInner=function(t,e,a,i,r,n){var s=this.getSelectorGroup(),o=t.getOrient().index,l=Ut[o],c=Yt[o],d=Ut[1-o],u=Yt[1-o];r&&_t["a"]("horizontal",s,t.get("selectorItemGap",!0));var p=t.get("selectorButtonGap",!0),g=s.getBoundingRect(),v=[-g.x,-g.y],f=h["d"](a);r&&(f[l]=a[l]-g[l]-p);var m=this._layoutContentAndController(t,i,f,o,l,d,u,c);if(r){if("end"===n)v[o]+=m[l]+p;else{var y=g[l]+p;v[o]-=y,m[c]-=y}m[l]+=g[l]+p,v[1-o]+=m[u]+m[d]/2-g[d]/2,m[d]=Math.max(m[d],g[d]),m[u]=Math.min(m[u],g[u]+v[1-o]),s.x=v[0],s.y=v[1],s.markRedraw()}return m},e.prototype._layoutContentAndController=function(t,e,a,i,r,n,s,o){var l=this.getContentGroup(),c=this._containerGroup,d=this._controllerGroup;_t["a"](t.get("orient"),l,t.get("itemGap"),i?a.width:null,i?null:a.height),_t["a"]("horizontal",d,t.get("pageButtonItemGap",!0));var u=l.getBoundingRect(),p=d.getBoundingRect(),g=this._showController=u[r]>a[r],v=[-u.x,-u.y];e||(v[i]=l[o]);var f=[0,0],m=[-p.x,-p.y],y=h["L"](t.get("pageButtonGap",!0),t.get("itemGap",!0));if(g){var _=t.get("pageButtonPosition",!0);"end"===_?m[i]+=a[r]-p[r]:f[i]+=p[r]+y}m[1-i]+=u[n]/2-p[n]/2,l.setPosition(v),c.setPosition(f),d.setPosition(m);var b={x:0,y:0};if(b[r]=g?a[r]:u[r],b[n]=Math.max(u[n],p[n]),b[s]=Math.min(0,p[s]+m[1-i]),c.__rectSize=a[r],g){var w={x:0,y:0};w[r]=Math.max(a[r]-p[r]-y,0),w[n]=b[n],c.setClipPath(new O["a"]({shape:w})),c.__rectSize=w[r]}else d.eachChild((function(t){t.attr({invisible:!0,silent:!0})}));var x=this._getPageInfo(t);return null!=x.pageIndex&&I["updateProps"](l,{x:x.contentPosition[0],y:x.contentPosition[1]},g?t:null),this._updatePageInfoView(t,x),b},e.prototype._pageGo=function(t,e,a){var i=this._getPageInfo(e)[t];null!=i&&a.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:e.id})},e.prototype._updatePageInfoView=function(t,e){var a=this._controllerGroup;h["j"](["pagePrev","pageNext"],(function(i){var r=i+"DataIndex",n=null!=e[r],s=a.childOfName(i);s&&(s.setStyle("fill",n?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),s.cursor=n?"pointer":"default")}));var i=a.childOfName("pageText"),r=t.get("pageFormatter"),n=e.pageIndex,s=null!=n?n+1:0,o=e.pageCount;i&&r&&i.setStyle("text",h["z"](r)?r.replace("{current}",null==s?"":s+"").replace("{total}",null==o?"":o+""):r({current:s,total:o}))},e.prototype._getPageInfo=function(t){var e=t.get("scrollDataIndex",!0),a=this.getContentGroup(),i=this._containerGroup.__rectSize,r=t.getOrient().index,n=Ut[r],s=Yt[r],o=this._findTargetItemIndex(e),l=a.children(),c=l[o],d=l.length,u=d?1:0,h={contentPosition:[a.x,a.y],pageCount:u,pageIndex:u-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return h;var p=y(c);h.contentPosition[r]=-p.s;for(var g=o+1,v=p,f=p,m=null;g<=d;++g)m=y(l[g]),(!m&&f.e>v.s+i||m&&!_(m,v.s))&&(v=f.i>v.i?f:m,v&&(null==h.pageNextDataIndex&&(h.pageNextDataIndex=v.i),++h.pageCount)),f=m;for(g=o-1,v=p,f=p,m=null;g>=-1;--g)m=y(l[g]),m&&_(f,m.s)||!(v.i<f.i)||(f=v,null==h.pagePrevDataIndex&&(h.pagePrevDataIndex=v.i),++h.pageCount,++h.pageIndex),v=m;return h;function y(t){if(t){var e=t.getBoundingRect(),a=e[s]+t[s];return{s:a,e:a+e[n],i:t.__legendDataIndex}}}function _(t,e){return t.e>=e&&t.s<=e+i}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var e,a,i=this.getContentGroup();return i.eachChild((function(i,r){var n=i.__legendDataIndex;null==a&&null!=n&&(a=r),n===t&&(e=r)})),null!=e?e:a},e.type="legend.scroll",e}(Tt),Xt=qt;function $t(t){t.registerAction("legendScroll","legendscroll",(function(t,e){var a=t.scrollDataIndex;null!=a&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},(function(t){t.setScrollDataIndex(a)}))}))}function Jt(t){Object(c["a"])(Nt),t.registerComponentModel(Vt),t.registerComponentView(Xt),$t(t)}function Zt(t){Object(c["a"])(Nt),Object(c["a"])(Jt)}var Kt=a("f95e");c["a"]([u["a"],lt,ct["a"],dt["a"],Zt,Kt["a"]]);var Qt={name:"Workplace",data(){return{loading:!0,trendLoading:!1,trendDays:30,defaultAvatar:a("cf05"),platform:{total_tenants:0,active_tenants:0,total_users:0,total_orders:0,total_nodes:0,online_nodes:0,active_bindings:0},tenant:{orders:0,positions:0,equity:null,totalReturn:null,dailyPnl:null,maxDrawdown:null,sharpeRatio:null,totalTrades:null,winRate:null},services:{data_api:!1,signal_monitor:!1,database:!1},recentSignals:[],chartInstances:{}}},computed:{loginUser(){return this.$store.state.user.user||{}},systemHealthy(){return this.services.data_api&&this.services.database&&this.services.signal_monitor},perfItems(){return[{label:"累计收益率",value:this.fmtPct(this.tenant.totalReturn),cls:this.tenant.totalReturn>=0?"text-success":"text-danger"},{label:"日收益",value:null!==this.tenant.dailyPnl&&void 0!==this.tenant.dailyPnl?this.tenant.dailyPnl.toFixed(2):"-",cls:this.tenant.dailyPnl>=0?"text-success":"text-danger"},{label:"最大回撤",value:this.fmtPct(this.tenant.maxDrawdown),cls:"text-danger"},{label:"夏普比率",value:null!==this.tenant.sharpeRatio&&void 0!==this.tenant.sharpeRatio?this.tenant.sharpeRatio.toFixed(2):"-"},{label:"总交易",value:this.tenant.totalTrades||"-"},{label:"胜率",value:this.fmtPct(this.tenant.winRate,1)}]}},mounted(){this.fetchData(),this.fetchTrends(),this.resizeHandler=()=>{Object.values(this.chartInstances).forEach(t=>t&&t.resize())},window.addEventListener("resize",this.resizeHandler)},beforeDestroy(){window.removeEventListener("resize",this.resizeHandler),Object.values(this.chartInstances).forEach(t=>t&&t.dispose())},methods:{formatMoney(t){return null===t||void 0===t?"0.00":parseFloat(t||0).toFixed(2)},fmtPct(t,e){return null===t||void 0===t?"-":(100*t).toFixed(e||2)+"%"},signalTagType(t){const e={CREATED:"",DISPATCHED:"warning",EXECUTED:"success",FAILED:"danger"};return e[(t||"").toUpperCase()]||"info"},signalDetail(t){try{const e="string"===typeof t.detail?JSON.parse(t.detail):t.detail||{},a=[];return e.strategy&&a.push(e.strategy),e.symbol&&a.push(e.symbol),e.side&&a.push(e.side),t.source&&a.push(t.source),a.join(" · ")||t.detail||"-"}catch(e){return t.detail||"-"}},async fetchData(){this.loading=!0;try{const[t,e,a,i,r,c]=await Promise.allSettled([Object(n["a"])(),Object(s["d"])({limit:1}),Object(s["e"])({limit:1}),Object(n["c"])().catch(()=>null),Object(o["b"])().catch(()=>null),Object(l["o"])({page_size:8}).catch(()=>null)]);if("fulfilled"===t.status&&t.value&&t.value.data){const e=t.value.data.data||t.value.data;Object.assign(this.platform,e)}if("fulfilled"===e.status&&e.value&&(this.tenant.orders=e.value.data.total||0),"fulfilled"===a.status&&a.value&&(this.tenant.positions=a.value.data.total||0),"fulfilled"===i.status&&i.value&&i.value.data){const t=i.value.data.data?i.value.data.data.summary:null;t&&(this.tenant.equity=t.current_equity,this.tenant.totalReturn=t.total_return,this.tenant.dailyPnl=t.daily_pnl,this.tenant.maxDrawdown=t.max_drawdown,this.tenant.sharpeRatio=t.sharpe_ratio,this.tenant.totalTrades=t.total_trades,this.tenant.winRate=t.win_rate)}if("fulfilled"===r.status&&r.value&&r.value.data){const t=r.value.data.data||r.value.data,e=t.services||[],a=t=>{const a=e.find(e=>e.name===t);return!!a&&!!a.healthy};this.services={data_api:a("data-api"),signal_monitor:a("signal-monitor"),database:!(!t.db||!t.db.mysql_ok)}}if("fulfilled"===c.status&&c.value&&c.value.data){const t=c.value.data;this.recentSignals=(t.data||t.events||[]).slice(0,8)}}catch(t){console.error(t)}finally{this.loading=!1}},async fetchTrends(){this.trendLoading=!0;try{const t=await Object(n["b"])(this.trendDays),e=t.data&&t.data.data||t.data||{};this.$nextTick(()=>{this.renderBarChart("chartOrders",e.dates||[],e.orders||[],"订单量","#409EFF"),this.renderLineChart("chartUsers",e.dates||[],e.new_users||[],"新增用户","#67C23A"),this.renderAreaChart("chartVolume",e.dates||[],e.trade_volume||[],"成交额","#E6A23C"),this.renderAreaChart("chartPool",e.dates||[],e.pool_amount||[],"入池金额","#F56C6C")})}catch(t){console.error("trends error",t)}finally{this.trendLoading=!1}},getChartInstance(t){if(this.chartInstances[t])return this.chartInstances[t];const e=this.$refs[t];if(!e)return null;const a=d["b"](e);return this.chartInstances[t]=a,a},buildBaseOption(t){return{tooltip:{trigger:"axis"},grid:{left:50,right:20,top:20,bottom:30},xAxis:{type:"category",data:t.map(t=>t.slice(5)),axisLabel:{fontSize:11,color:"#909399"},axisLine:{lineStyle:{color:"#E4E7ED"}}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#F2F6FC"}},axisLabel:{fontSize:11,color:"#909399"}}}},renderBarChart(t,e,a,i,r){const n=this.getChartInstance(t);if(!n)return;const s=this.buildBaseOption(e);s.series=[{name:i,type:"bar",data:a,itemStyle:{color:r,borderRadius:[3,3,0,0]},barMaxWidth:20}],n.setOption(s,!0)},renderLineChart(t,e,a,i,r){const n=this.getChartInstance(t);if(!n)return;const s=this.buildBaseOption(e);s.series=[{name:i,type:"line",data:a,smooth:!0,symbol:"circle",symbolSize:5,lineStyle:{color:r,width:2},itemStyle:{color:r}}],n.setOption(s,!0)},renderAreaChart(t,e,a,i,r){const n=this.getChartInstance(t);if(!n)return;const s=this.buildBaseOption(e);s.series=[{name:i,type:"line",data:a,smooth:!0,symbol:"none",lineStyle:{color:r,width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:r+"40"},{offset:1,color:r+"05"}]}}}],n.setOption(s,!0)}}},te=Qt,ee=(a("8b21"),a("2877")),ae=Object(ee["a"])(te,i,r,!1,null,"551da562",null);e["default"]=ae.exports},"8b21":function(t,e,a){"use strict";a("41cb")}}]);