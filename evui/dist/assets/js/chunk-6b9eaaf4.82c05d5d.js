(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b9eaaf4"],{"35ae":function(t,e,a){"use strict";a("50a6")},"50a6":function(t,e,a){},a1f5:function(t,e,a){"use strict";a.r(e);var i={};a.r(i),a.d(i,"extendShape",(function(){return c["extendShape"]})),a.d(i,"extendPath",(function(){return c["extendPath"]})),a.d(i,"makePath",(function(){return c["makePath"]})),a.d(i,"makeImage",(function(){return c["makeImage"]})),a.d(i,"mergePath",(function(){return c["mergePath"]})),a.d(i,"resizePath",(function(){return c["resizePath"]})),a.d(i,"createIcon",(function(){return c["createIcon"]})),a.d(i,"updateProps",(function(){return c["updateProps"]})),a.d(i,"initProps",(function(){return c["initProps"]})),a.d(i,"getTransform",(function(){return c["getTransform"]})),a.d(i,"clipPointsByRect",(function(){return c["clipPointsByRect"]})),a.d(i,"clipRectByRect",(function(){return c["clipRectByRect"]})),a.d(i,"registerShape",(function(){return c["registerShape"]})),a.d(i,"getShapeClass",(function(){return c["getShapeClass"]})),a.d(i,"Group",(function(){return d["a"]})),a.d(i,"Image",(function(){return u["a"]})),a.d(i,"Text",(function(){return h["a"]})),a.d(i,"Circle",(function(){return p["a"]})),a.d(i,"Ellipse",(function(){return f["a"]})),a.d(i,"Sector",(function(){return g["a"]})),a.d(i,"Ring",(function(){return m["a"]})),a.d(i,"Polygon",(function(){return v["a"]})),a.d(i,"Polyline",(function(){return y["a"]})),a.d(i,"Rect",(function(){return _["a"]})),a.d(i,"Line",(function(){return b["a"]})),a.d(i,"BezierCurve",(function(){return x["a"]})),a.d(i,"Arc",(function(){return w["a"]})),a.d(i,"IncrementalDisplayable",(function(){return M["a"]})),a.d(i,"CompoundPath",(function(){return O["a"]})),a.d(i,"LinearGradient",(function(){return S["a"]})),a.d(i,"RadialGradient",(function(){return j["a"]})),a.d(i,"BoundingRect",(function(){return C["a"]}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-card",{staticStyle:{"margin-bottom":"15px"},attrs:{shadow:"never"}},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",{attrs:{label:"选择账户"}},[a("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择交易账户",loading:t.accountsLoading},on:{change:t.handleAccountChange},model:{value:t.accountId,callback:function(e){t.accountId=e},expression:"accountId"}},t._l(t.accounts,(function(t){return a("el-option",{key:t.id,attrs:{label:"#"+t.id+" "+(t.user_email?t.user_email+" - ":"")+t.exchange+" ("+t.account_type+")",value:t.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",disabled:!t.accountId},on:{click:t.fetchAll}},[t._v("刷新数据")])],1)],1)],1),t.accountId||t.accountsLoading?t._e():a("div",[a("el-empty",{attrs:{description:"请先选择一个交易账户以查看分析数据"}})],1),t.accountId?a("div",[a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"当前权益",value:t.performanceData.current_equity||0,icon:"el-icon-wallet",color:"primary",format:"money",precision:2,"help-text":"账户当前总权益",loading:t.loading}})],1),a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"累计收益率",value:100*(t.performanceData.total_return||0),icon:"el-icon-trophy",color:"success",format:"percent",precision:2,"help-text":"累计总收益率",loading:t.loading}},[a("template",{slot:"value"},[a("span",{style:{color:(t.performanceData.total_return||0)>=0?"#67C23A":"#F56C6C"}},[t._v(" "+t._s(t.formatPercent(t.performanceData.total_return))+" ")])])],2)],1),a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"日盈亏",value:t.performanceData.daily_pnl||0,icon:"el-icon-coin",color:"warning",format:"money",precision:2,"help-text":"当日盈亏金额",loading:t.loading}},[a("template",{slot:"value"},[a("span",{style:{color:(t.performanceData.daily_pnl||0)>=0?"#67C23A":"#F56C6C"}},[t._v(" "+t._s(t.formatMoney(t.performanceData.daily_pnl))+" ")])])],2)],1),a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"夏普比率",value:t.performanceData.sharpe_ratio||0,icon:"el-icon-data-line",color:"info",format:"number",precision:2,"help-text":"风险调整后收益指标",loading:t.loading}})],1),a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"最大回撤",value:100*(t.riskData.max_drawdown||0),icon:"el-icon-bottom",color:"danger",format:"percent",precision:2,"help-text":"历史最大回撤幅度",loading:t.riskLoading}})],1),a("el-col",{attrs:{lg:4,md:8,sm:12,xs:24}},[a("stat-card",{attrs:{title:"胜率",value:100*(t.performanceData.win_rate||0),icon:"el-icon-success",color:"success",format:"percent",precision:1,"help-text":"盈利交易占比",loading:t.loading}})],1)],1),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.curveLoading,expression:"curveLoading"}],staticStyle:{"margin-top":"16px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("权益曲线")]),a("el-date-picker",{staticStyle:{"margin-left":"16px",width:"260px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束","value-format":"yyyy-MM-dd",size:"mini"},on:{change:t.fetchEquityCurve},model:{value:t.curveDateRange,callback:function(e){t.curveDateRange=e},expression:"curveDateRange"}})],1),a("div",{ref:"equityChart",staticStyle:{width:"100%",height:"320px"}}),t.curveLoading||0!==t.equityCurve.length?t._e():a("el-empty",{attrs:{description:"暂无净值数据，请确认日期范围"}})],1),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-top":"16px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("绩效汇总")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("盈利因子")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatNumber(t.performanceData.profit_factor)))])])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("平均交易盈亏")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatMoney(t.performanceData.avg_trade_pnl)))])])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("总交易次数")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.performanceData.total_trades||0))])])])],1)],1),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"16px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("风险指标")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("最大回撤")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatPercent(t.riskData.max_drawdown)))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("VaR (95%)")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatMoney(t.riskData.var_95)))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("波动率")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatPercent(t.riskData.volatility)))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("风险等级")]),a("div",{staticClass:"metric-value"},[a("el-tag",{attrs:{type:t.getRiskTagType(t.riskData.risk_level),size:"small"}},[t._v(t._s(t.riskData.risk_level||"-"))])],1)])]),a("el-col",{staticStyle:{"margin-top":"16px"},attrs:{span:6}},[a("div",{staticClass:"metric-item"},[a("div",{staticClass:"metric-label"},[t._v("当前回撤")]),a("div",{staticClass:"metric-value"},[t._v(t._s(t.formatPercent(t.riskData.current_drawdown)))])])])],1)],1),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.statsLoading,expression:"statsLoading"}],staticStyle:{"margin-top":"16px"},attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("交易统计")]),a("el-table",{attrs:{data:t.statsList,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"date",label:"日期",width:"120"}}),a("el-table-column",{attrs:{prop:"symbol",label:"交易对",width:"150"}}),a("el-table-column",{attrs:{prop:"trades",label:"交易次数",width:"100",align:"right"}}),a("el-table-column",{attrs:{prop:"pnl",label:"盈亏",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",{style:{color:(i.pnl||0)>=0?"#67C23A":"#F56C6C"}},[t._v(t._s(t.formatMoney(i.pnl)))])]}}],null,!1,49422115)}),a("el-table-column",{attrs:{prop:"win_rate",label:"胜率",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatPercent(a.win_rate)))]}}],null,!1,1673384875)}),a("el-table-column",{attrs:{prop:"volume",label:"成交量",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatMoney(a.volume)))]}}],null,!1,2333790821)}),a("el-table-column",{attrs:{prop:"fees",label:"手续费",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatMoney(a.fees)))]}}],null,!1,360546712)})],1),t.statsLoading||0!==t.statsList.length?t._e():a("el-empty",{attrs:{description:"暂无统计数据"}})],1)],1):t._e()],1)},o=[],r=(a("0643"),a("2382"),a("a573"),a("1be7")),s=a("6cb7"),l=a("b12f"),c=(a("4f85"),a("e887"),a("2306")),d=a("2dc5"),u=a("0da8"),h=a("76a5"),p=a("d9fc"),f=a("ae69"),g=a("4aa2"),m=a("4573"),v=a("87b1"),y=a("d498"),_=a("c7a2"),b=a("cb11"),x=a("ac0f"),w=a("8d32"),M=a("392f"),O=a("d4c6"),S=a("48a9"),j=a("dded"),C=a("9850");var A=a("22b4"),D=a("f95e"),I=a("9ab4"),R=a("07fd"),P=a("f72b"),z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return Object(I["a"])(e,t),e.prototype.init=function(e,a,i){t.prototype.init.call(this,e,a,i),this._sourceManager=new P["a"](this),Object(P["b"])(this)},e.prototype.mergeOption=function(e,a){t.prototype.mergeOption.call(this,e,a),Object(P["b"])(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:R["a"]},e}(s["a"]),L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return Object(I["a"])(e,t),e.type="dataset",e}(l["a"]);function T(t){t.registerComponentModel(z),t.registerComponentView(L)}Object(A["a"])([D["a"],T]);var k=a("3620");Object(A["a"])(k["a"]);var Z=a("2da7");Object(A["a"])(Z["a"]);var V=a("4b2a");Object(A["a"])(V["a"]);var B=a("6d8b"),E=["x","y","radius","angle","single"],W=["cartesian2d","polar","singleAxis"];function H(t){var e=t.get("coordinateSystem");return Object(B["p"])(W,e)>=0}function N(t){return t+"Axis"}function F(t,e){var a,i=Object(B["f"])(),n=[],o=Object(B["f"])();t.eachComponent({mainType:"dataZoom",query:e},(function(t){o.get(t.uid)||s(t)}));do{a=!1,t.eachComponent("dataZoom",r)}while(a);function r(t){!o.get(t.uid)&&l(t)&&(s(t),a=!0)}function s(t){o.set(t.uid,!0),n.push(t),c(t)}function l(t){var e=!1;return t.eachTargetAxis((function(t,a){var n=i.get(t);n&&n[a]&&(e=!0)})),e}function c(t){t.eachTargetAxis((function(t,e){(i.get(t)||i.set(t,[]))[e]=!0}))}return n}function Y(t){var e=t.ecModel,a={infoList:[],infoMap:Object(B["f"])()};return t.eachTargetAxis((function(t,i){var n=e.getComponent(N(t),i);if(n){var o=n.getCoordSysModel();if(o){var r=o.uid,s=a.infoMap.get(r);s||(s={model:o,axisModels:[]},a.infoList.push(s),a.infoMap.set(r,s)),s.axisModels.push(n)}}})),a}var X=a("e0d3"),q=function(){function t(){this.indexList=[],this.indexMap=[]}return t.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},t}(),G=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a._autoThrottle=!0,a._noTarget=!0,a._rangePropMode=["percent","percent"],a}return Object(I["a"])(e,t),e.prototype.init=function(t,e,a){var i=$(t);this.settledOption=i,this.mergeDefaultAndTheme(t,a),this._doInit(i)},e.prototype.mergeOption=function(t){var e=$(t);Object(B["F"])(this.option,t,!0),Object(B["F"])(this.settledOption,e,!0),this._doInit(e)},e.prototype._doInit=function(t){var e=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var a=this.settledOption;Object(B["j"])([["start","startValue"],["end","endValue"]],(function(t,i){"value"===this._rangePropMode[i]&&(e[t[0]]=a[t[0]]=null)}),this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),e=this._targetAxisInfoMap=Object(B["f"])(),a=this._fillSpecifiedTargetAxis(e);a?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(e,this._orient)),this._noTarget=!0,e.each((function(t){t.indexList.length&&(this._noTarget=!1)}),this)},e.prototype._fillSpecifiedTargetAxis=function(t){var e=!1;return Object(B["j"])(E,(function(a){var i=this.getReferringComponents(N(a),X["a"]);if(i.specified){e=!0;var n=new q;Object(B["j"])(i.models,(function(t){n.add(t.componentIndex)})),t.set(a,n)}}),this),e},e.prototype._fillAutoTargetAxisByOrient=function(t,e){var a=this.ecModel,i=!0;if(i){var n="vertical"===e?"y":"x",o=a.findComponents({mainType:n+"Axis"});r(o,n)}if(i){o=a.findComponents({mainType:"singleAxis",filter:function(t){return t.get("orient",!0)===e}});r(o,"single")}function r(e,a){var n=e[0];if(n){var o=new q;if(o.add(n.componentIndex),t.set(a,o),i=!1,"x"===a||"y"===a){var r=n.getReferringComponents("grid",X["b"]).models[0];r&&Object(B["j"])(e,(function(t){n.componentIndex!==t.componentIndex&&r===t.getReferringComponents("grid",X["b"]).models[0]&&o.add(t.componentIndex)}))}}}i&&Object(B["j"])(E,(function(e){if(i){var n=a.findComponents({mainType:N(e),filter:function(t){return"category"===t.get("type",!0)}});if(n[0]){var o=new q;o.add(n[0].componentIndex),t.set(e,o),i=!1}}}),this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis((function(e){!t&&(t=e)}),this),"y"===t?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&e.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var e=this._rangePropMode,a=this.get("rangeMode");Object(B["j"])([["start","startValue"],["end","endValue"]],(function(i,n){var o=null!=t[i[0]],r=null!=t[i[1]];o&&!r?e[n]="percent":!o&&r?e[n]="value":a?e[n]=a[n]:o&&(e[n]="percent")}))},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis((function(e,a){null==t&&(t=this.ecModel.getComponent(N(e),a))}),this),t},e.prototype.eachTargetAxis=function(t,e){this._targetAxisInfoMap.each((function(a,i){Object(B["j"])(a.indexList,(function(a){t.call(e,i,a)}))}))},e.prototype.getAxisProxy=function(t,e){var a=this.getAxisModel(t,e);if(a)return a.__dzAxisProxy},e.prototype.getAxisModel=function(t,e){var a=this._targetAxisInfoMap.get(t);if(a&&a.indexMap[e])return this.ecModel.getComponent(N(t),e)},e.prototype.setRawRange=function(t){var e=this.option,a=this.settledOption;Object(B["j"])([["start","startValue"],["end","endValue"]],(function(i){null==t[i[0]]&&null==t[i[1]]||(e[i[0]]=a[i[0]]=t[i[0]],e[i[1]]=a[i[1]]=t[i[1]])}),this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var e=this.option;Object(B["j"])(["start","startValue","end","endValue"],(function(a){e[a]=t[a]}))},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var a=this.findRepresentativeAxisProxy();return a?a.getDataValueWindow():void 0},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var e,a=this._targetAxisInfoMap.keys(),i=0;i<a.length;i++)for(var n=a[i],o=this._targetAxisInfoMap.get(n),r=0;r<o.indexList.length;r++){var s=this.getAxisProxy(n,o.indexList[r]);if(s.hostedBy(this))return s;e||(e=s)}return e},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={zlevel:0,z:4,filterMode:"filter",start:0,end:100},e}(s["a"]);function $(t){var e={};return Object(B["j"])(["start","end","startValue","endValue","throttle"],(function(a){t.hasOwnProperty(a)&&(e[a]=t[a])})),e}var U=G,K=a("8918"),J=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(I["a"])(e,t),e.type="dataZoom.inside",e.defaultOption=Object(K["d"])(U.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),e}(U),Q=J,tt=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(I["a"])(e,t),e.prototype.render=function(t,e,a,i){this.dataZoomModel=t,this.ecModel=e,this.api=a},e.type="dataZoom",e}(l["a"]),et=tt;function at(t,e,a,i,n,o){t=t||0;var r=a[1]-a[0];if(null!=n&&(n=nt(n,[0,r])),null!=o&&(o=Math.max(o,null!=n?n:0)),"all"===i){var s=Math.abs(e[1]-e[0]);s=nt(s,[0,r]),n=o=nt(s,[n,o]),i=0}e[0]=nt(e[0],a),e[1]=nt(e[1],a);var l=it(e,i);e[i]+=t;var c,d=n||0,u=a.slice();return l.sign<0?u[0]+=d:u[1]-=d,e[i]=nt(e[i],u),c=it(e,i),null!=n&&(c.sign!==l.sign||c.span<n)&&(e[1-i]=e[i]+l.sign*n),c=it(e,i),null!=o&&c.span>o&&(e[1-i]=e[i]+c.sign*o),e}function it(t,e){var a=t[e]-t[1-e];return{span:Math.abs(a),sign:a>0?-1:a<0?1:e?-1:1}}function nt(t,e){return Math.min(null!=e[1]?e[1]:1/0,Math.max(null!=e[0]?e[0]:-1/0,t))}var ot=a("6fd3"),rt=a("607d"),st="\0_ec_interaction_mutex";function lt(t,e){return!!ct(t)[e]}function ct(t){return t[st]||(t[st]={})}r["c"]({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},(function(){}));var dt=function(t){function e(e){var a=t.call(this)||this;a._zr=e;var i=Object(B["c"])(a._mousedownHandler,a),n=Object(B["c"])(a._mousemoveHandler,a),o=Object(B["c"])(a._mouseupHandler,a),r=Object(B["c"])(a._mousewheelHandler,a),s=Object(B["c"])(a._pinchHandler,a);return a.enable=function(t,a){this.disable(),this._opt=Object(B["i"])(Object(B["d"])(a)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(e.on("mousedown",i),e.on("mousemove",n),e.on("mouseup",o)),!0!==t&&"scale"!==t&&"zoom"!==t||(e.on("mousewheel",r),e.on("pinch",s))},a.disable=function(){e.off("mousedown",i),e.off("mousemove",n),e.off("mouseup",o),e.off("mousewheel",r),e.off("pinch",s)},a}return Object(I["a"])(e,t),e.prototype.isDragging=function(){return this._dragging},e.prototype.isPinching=function(){return this._pinching},e.prototype.setPointerChecker=function(t){this.pointerChecker=t},e.prototype.dispose=function(){this.disable()},e.prototype._mousedownHandler=function(t){if(!(rt["d"](t)||t.target&&t.target.draggable)){var e=t.offsetX,a=t.offsetY;this.pointerChecker&&this.pointerChecker(t,e,a)&&(this._x=e,this._y=a,this._dragging=!0)}},e.prototype._mousemoveHandler=function(t){if(this._dragging&&pt("moveOnMouseMove",t,this._opt)&&"pinch"!==t.gestureEvent&&!lt(this._zr,"globalPan")){var e=t.offsetX,a=t.offsetY,i=this._x,n=this._y,o=e-i,r=a-n;this._x=e,this._y=a,this._opt.preventDefaultMouseMove&&rt["g"](t.event),ht(this,"pan","moveOnMouseMove",t,{dx:o,dy:r,oldX:i,oldY:n,newX:e,newY:a,isAvailableBehavior:null})}},e.prototype._mouseupHandler=function(t){rt["d"](t)||(this._dragging=!1)},e.prototype._mousewheelHandler=function(t){var e=pt("zoomOnMouseWheel",t,this._opt),a=pt("moveOnMouseWheel",t,this._opt),i=t.wheelDelta,n=Math.abs(i),o=t.offsetX,r=t.offsetY;if(0!==i&&(e||a)){if(e){var s=n>3?1.4:n>1?1.2:1.1,l=i>0?s:1/s;ut(this,"zoom","zoomOnMouseWheel",t,{scale:l,originX:o,originY:r,isAvailableBehavior:null})}if(a){var c=Math.abs(i),d=(i>0?1:-1)*(c>3?.4:c>1?.15:.05);ut(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:d,originX:o,originY:r,isAvailableBehavior:null})}}},e.prototype._pinchHandler=function(t){if(!lt(this._zr,"globalPan")){var e=t.pinchScale>1?1.1:1/1.1;ut(this,"zoom",null,t,{scale:e,originX:t.pinchX,originY:t.pinchY,isAvailableBehavior:null})}},e}(ot["a"]);function ut(t,e,a,i,n){t.pointerChecker&&t.pointerChecker(i,n.originX,n.originY)&&(rt["g"](i.event),ht(t,e,a,i,n))}function ht(t,e,a,i,n){n.isAvailableBehavior=Object(B["c"])(pt,null,a,i),t.trigger(e,n)}function pt(t,e,a){var i=a[t];return!t||i&&(!Object(B["z"])(i)||e.event[i+"Key"])}var ft=dt,gt=a("88b3"),mt=Object(X["m"])();function vt(t,e,a){mt(t).coordSysRecordMap.each((function(t){var i=t.dataZoomInfoMap.get(e.uid);i&&(i.getRange=a)}))}function yt(t,e){for(var a=mt(t).coordSysRecordMap,i=a.keys(),n=0;n<i.length;n++){var o=i[n],r=a.get(o),s=r.dataZoomInfoMap;if(s){var l=e.uid,c=s.get(l);c&&(s.removeKey(l),s.keys().length||_t(a,r))}}}function _t(t,e){if(e){t.removeKey(e.model.uid);var a=e.controller;a&&a.dispose()}}function bt(t,e){var a={model:e,containsPoint:Object(B["h"])(wt,e),dispatchAction:Object(B["h"])(xt,t),dataZoomInfoMap:null,controller:null},i=a.controller=new ft(t.getZr());return Object(B["j"])(["pan","zoom","scrollMove"],(function(t){i.on(t,(function(e){var i=[];a.dataZoomInfoMap.each((function(n){if(e.isAvailableBehavior(n.model.option)){var o=(n.getRange||{})[t],r=o&&o(n.dzReferCoordSysInfo,a.model.mainType,a.controller,e);!n.model.get("disabled",!0)&&r&&i.push({dataZoomId:n.model.id,start:r[0],end:r[1]})}})),i.length&&a.dispatchAction(i)}))})),a}function xt(t,e){t.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:e})}function wt(t,e,a,i){return t.coordinateSystem.containPoint([a,i])}function Mt(t){var e,a="type_",i={type_true:2,type_move:1,type_false:0,type_undefined:-1},n=!0;return t.each((function(t){var o=t.model,r=!o.get("disabled",!0)&&(!o.get("zoomLock",!0)||"move");i[a+r]>i[a+e]&&(e=r),n=n&&o.get("preventDefaultMouseMove",!0)})),{controlType:e,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!n}}}function Ot(t){t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,(function(t,e){var a=mt(e),i=a.coordSysRecordMap||(a.coordSysRecordMap=Object(B["f"])());i.each((function(t){t.dataZoomInfoMap=null})),t.eachComponent({mainType:"dataZoom",subType:"inside"},(function(t){var a=Y(t);Object(B["j"])(a.infoList,(function(a){var n=a.model.uid,o=i.get(n)||i.set(n,bt(e,a.model)),r=o.dataZoomInfoMap||(o.dataZoomInfoMap=Object(B["f"])());r.set(t.uid,{dzReferCoordSysInfo:a,model:t,getRange:null})}))})),i.each((function(t){var e,a=t.controller,n=t.dataZoomInfoMap;if(n){var o=n.keys()[0];null!=o&&(e=n.get(o))}if(e){var r=Mt(n);a.enable(r.controlType,r.opt),a.setPointerChecker(t.containsPoint),gt["b"](t,"dispatchAction",e.model.get("throttle",!0),"fixRate")}else _t(i,t)}))}))}var St=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataZoom.inside",e}return Object(I["a"])(e,t),e.prototype.render=function(e,a,i){t.prototype.render.apply(this,arguments),e.noTarget()?this._clear():(this.range=e.getPercentRange(),vt(i,e,{pan:Object(B["c"])(jt.pan,this),zoom:Object(B["c"])(jt.zoom,this),scrollMove:Object(B["c"])(jt.scrollMove,this)}))},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){yt(this.api,this.dataZoomModel),this.range=null},e.type="dataZoom.inside",e}(et),jt={zoom:function(t,e,a,i){var n=this.range,o=n.slice(),r=t.axisModels[0];if(r){var s=At[e](null,[i.originX,i.originY],r,a,t),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(o[1]-o[0])+o[0],c=Math.max(1/i.scale,0);o[0]=(o[0]-l)*c+l,o[1]=(o[1]-l)*c+l;var d=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return at(0,o,[0,100],0,d.minSpan,d.maxSpan),this.range=o,n[0]!==o[0]||n[1]!==o[1]?o:void 0}},pan:Ct((function(t,e,a,i,n,o){var r=At[i]([o.oldX,o.oldY],[o.newX,o.newY],e,n,a);return r.signal*(t[1]-t[0])*r.pixel/r.pixelLength})),scrollMove:Ct((function(t,e,a,i,n,o){var r=At[i]([0,0],[o.scrollDelta,o.scrollDelta],e,n,a);return r.signal*(t[1]-t[0])*o.scrollDelta}))};function Ct(t){return function(e,a,i,n){var o=this.range,r=o.slice(),s=e.axisModels[0];if(s){var l=t(r,s,e,a,i,n);return at(l,r,[0,100],"all"),this.range=r,o[0]!==r[0]||o[1]!==r[1]?r:void 0}}}var At={grid:function(t,e,a,i,n){var o=a.axis,r={},s=n.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(r.pixel=e[0]-t[0],r.pixelLength=s.width,r.pixelStart=s.x,r.signal=o.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=s.height,r.pixelStart=s.y,r.signal=o.inverse?-1:1),r},polar:function(t,e,a,i,n){var o=a.axis,r={},s=n.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),c=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===a.mainType?(r.pixel=e[0]-t[0],r.pixelLength=l[1]-l[0],r.pixelStart=l[0],r.signal=o.inverse?1:-1):(r.pixel=e[1]-t[1],r.pixelLength=c[1]-c[0],r.pixelStart=c[0],r.signal=o.inverse?-1:1),r},singleAxis:function(t,e,a,i,n){var o=a.axis,r=n.model.coordinateSystem.getRect(),s={};return t=t||[0,0],"horizontal"===o.orient?(s.pixel=e[0]-t[0],s.pixelLength=r.width,s.pixelStart=r.x,s.signal=o.inverse?1:-1):(s.pixel=e[1]-t[1],s.pixelLength=r.height,s.pixelStart=r.y,s.signal=o.inverse?-1:1),s}},Dt=St,It=a("3842"),Rt=a("697e"),Pt=a("538f"),zt=B["j"],Lt=It["b"],Tt=function(){function t(t,e,a,i){this._dimName=t,this._axisIndex=e,this.ecModel=i,this._dataZoomModel=a}return t.prototype.hostedBy=function(t){return this._dataZoomModel===t},t.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},t.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},t.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries((function(e){if(H(e)){var a=N(this._dimName),i=e.getReferringComponents(a,X["b"]).models[0];i&&this._axisIndex===i.componentIndex&&t.push(e)}}),this),t},t.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},t.prototype.getMinMaxSpan=function(){return B["d"](this._minMaxSpan)},t.prototype.calculateDataWindow=function(t){var e,a=this._dataExtent,i=this.getAxisModel(),n=i.axis.scale,o=this._dataZoomModel.getRangePropMode(),r=[0,100],s=[],l=[];zt(["start","end"],(function(i,c){var d=t[i],u=t[i+"Value"];"percent"===o[c]?(null==d&&(d=r[c]),u=n.parse(It["i"](d,r,a))):(e=!0,u=null==u?a[c]:n.parse(u),d=It["i"](u,a,r)),l[c]=u,s[c]=d})),Lt(l),Lt(s);var c=this._minMaxSpan;function d(t,e,a,i,o){var r=o?"Span":"ValueSpan";at(0,t,a,"all",c["min"+r],c["max"+r]);for(var s=0;s<2;s++)e[s]=It["i"](t[s],a,i,!0),o&&(e[s]=n.parse(e[s]))}return e?d(l,s,a,r,!1):d(s,l,r,a,!0),{valueWindow:l,percentWindow:s}},t.prototype.reset=function(t){if(t===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=kt(this,this._dimName,e),this._updateMinMaxSpan();var a=this.calculateDataWindow(t.settledOption);this._valueWindow=a.valueWindow,this._percentWindow=a.percentWindow,this._setAxisModel()}},t.prototype.filterData=function(t,e){if(t===this._dataZoomModel){var a=this._dimName,i=this.getTargetSeriesModels(),n=t.get("filterMode"),o=this._valueWindow;"none"!==n&&zt(i,(function(t){var e=t.getData(),i=e.mapDimensionsAll(a);i.length&&("weakFilter"===n?e.filterSelf((function(t){for(var a,n,r,s=0;s<i.length;s++){var l=e.get(i[s],t),c=!isNaN(l),d=l<o[0],u=l>o[1];if(c&&!d&&!u)return!0;c&&(r=!0),d&&(a=!0),u&&(n=!0)}return r&&a&&n})):zt(i,(function(a){if("empty"===n)t.setData(e=e.map(a,(function(t){return r(t)?t:NaN})));else{var i={};i[a]=o,e.selectRange(i)}})),zt(i,(function(t){e.setApproximateExtent(o,t)})))}))}function r(t){return t>=o[0]&&t<=o[1]}},t.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},e=this._dataZoomModel,a=this._dataExtent;zt(["min","max"],(function(i){var n=e.get(i+"Span"),o=e.get(i+"ValueSpan");null!=o&&(o=this.getAxisModel().axis.scale.parse(o)),null!=o?n=It["i"](a[0]+o,a,[0,100],!0):null!=n&&(o=It["i"](n,[0,100],a,!0)-a[0]),t[i+"Span"]=n,t[i+"ValueSpan"]=o}),this)},t.prototype._setAxisModel=function(){var t=this.getAxisModel(),e=this._percentWindow,a=this._valueWindow;if(e){var i=It["d"](a,[0,500]);i=Math.min(i,20);var n=t.axis.scale.rawExtentInfo;0!==e[0]&&n.setDeterminedMinMax("min",+a[0].toFixed(i)),100!==e[1]&&n.setDeterminedMinMax("max",+a[1].toFixed(i)),n.freeze()}},t}();function kt(t,e,a){var i=[1/0,-1/0];zt(a,(function(t){Object(Rt["j"])(i,t.getData(),e)}));var n=t.getAxisModel(),o=Object(Pt["a"])(n.axis.scale,n,i).calculate();return[o.min,o.max]}var Zt=Tt,Vt={getTargetSeries:function(t){function e(e){t.eachComponent("dataZoom",(function(a){a.eachTargetAxis((function(i,n){var o=t.getComponent(N(i),n);e(i,n,o,a)}))}))}e((function(t,e,a,i){a.__dzAxisProxy=null}));var a=[];e((function(e,i,n,o){n.__dzAxisProxy||(n.__dzAxisProxy=new Zt(e,i,o,t),a.push(n.__dzAxisProxy))}));var i=Object(B["f"])();return Object(B["j"])(a,(function(t){Object(B["j"])(t.getTargetSeriesModels(),(function(t){i.set(t.uid,t)}))})),i},overallReset:function(t,e){t.eachComponent("dataZoom",(function(t){t.eachTargetAxis((function(e,a){t.getAxisProxy(e,a).reset(t)})),t.eachTargetAxis((function(a,i){t.getAxisProxy(a,i).filterData(t,e)}))})),t.eachComponent("dataZoom",(function(t){var e=t.findRepresentativeAxisProxy();if(e){var a=e.getDataPercentWindow(),i=e.getDataValueWindow();t.setCalculatedRange({start:a[0],end:a[1],startValue:i[0],endValue:i[1]})}}))}},Bt=Vt;function Et(t){t.registerAction("dataZoom",(function(t,e){var a=F(e,t);Object(B["j"])(a,(function(e){e.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})}))}))}var Wt=!1;function Ht(t){Wt||(Wt=!0,t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,Bt),Et(t),t.registerSubTypeDefaulter("dataZoom",(function(){return"slider"})))}function Nt(t){Ht(t),t.registerComponentModel(Q),t.registerComponentView(Dt),Ot(t)}var Ft=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(I["a"])(e,t),e.type="dataZoom.slider",e.layoutMode="box",e.defaultOption=Object(K["d"])(U.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),e}(U),Yt=Ft,Xt=a("dce8"),qt=a("f934"),Gt=a("7d6c"),$t=a("a15a"),Ut=a("7837"),Kt=_["a"],Jt=7,Qt=1,te=30,ee=7,ae="horizontal",ie="vertical",ne=5,oe=["line","bar","candlestick","scatter"],re={easing:"cubicOut",duration:100},se=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a._displayables={},a}return Object(I["a"])(e,t),e.prototype.init=function(t,e){this.api=e,this._onBrush=Object(B["c"])(this._onBrush,this),this._onBrushEnd=Object(B["c"])(this._onBrushEnd,this)},e.prototype.render=function(e,a,i,n){if(t.prototype.render.apply(this,arguments),gt["b"](this,"_dispatchZoomAction",e.get("throttle"),"fixRate"),this._orient=e.getOrient(),!1!==e.get("show")){if(e.noTarget())return this._clear(),void this.group.removeAll();n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){gt["a"](this,"_dispatchZoomAction");var t=this.api.getZr();t.off("mousemove",this._onBrush),t.off("mouseup",this._onBrushEnd)},e.prototype._buildView=function(){var t=this.group;t.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var e=this._displayables.sliderGroup=new d["a"];this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup()},e.prototype._resetLocation=function(){var t=this.dataZoomModel,e=this.api,a=t.get("brushSelect"),i=a?ee:0,n=this._findCoordRect(),o={width:e.getWidth(),height:e.getHeight()},r=this._orient===ae?{right:o.width-n.x-n.width,top:o.height-te-Jt-i,width:n.width,height:te}:{right:Jt,top:n.y,width:te,height:n.height},s=qt["c"](t.option);Object(B["j"])(["right","top","width","height"],(function(t){"ph"===s[t]&&(s[t]=r[t])}));var l=qt["d"](s,o);this._location={x:l.x,y:l.y},this._size=[l.width,l.height],this._orient===ie&&this._size.reverse()},e.prototype._positionGroup=function(){var t=this.group,e=this._location,a=this._orient,i=this.dataZoomModel.getFirstTargetAxisModel(),n=i&&i.get("inverse"),o=this._displayables.sliderGroup,r=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(a!==ae||n?a===ae&&n?{scaleY:r?1:-1,scaleX:-1}:a!==ie||n?{scaleY:r?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:r?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:r?1:-1,scaleX:1});var s=t.getBoundingRect([o]);t.x=e.x-s.x,t.y=e.y-s.y,t.markRedraw()},e.prototype._getViewExtent=function(){return[0,this._size[0]]},e.prototype._renderBackground=function(){var t=this.dataZoomModel,e=this._size,a=this._displayables.sliderGroup,i=t.get("brushSelect");a.add(new Kt({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40}));var n=new Kt({shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:"transparent"},z2:0,onclick:Object(B["c"])(this._onClickPanel,this)}),o=this.api.getZr();i?(n.on("mousedown",this._onBrushStart,this),n.cursor="crosshair",o.on("mousemove",this._onBrush),o.on("mouseup",this._onBrushEnd)):(o.off("mousemove",this._onBrush),o.off("mouseup",this._onBrushEnd)),a.add(n)},e.prototype._renderDataShadow=function(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],t){var e=this._size,a=t.series,i=a.getRawData(),n=a.getShadowDim?a.getShadowDim():t.otherDim;if(null!=n){var o=i.getDataExtent(n),r=.3*(o[1]-o[0]);o=[o[0]-r,o[1]+r];var s,l=[0,e[1]],c=[0,e[0]],u=[[e[0],0],[0,0]],h=[],p=c[1]/(i.count()-1),f=0,g=Math.round(i.count()/e[0]);i.each([n],(function(t,e){if(g>0&&e%g)f+=p;else{var a=null==t||isNaN(t)||""===t,i=a?0:Object(It["i"])(t,o,l,!0);a&&!s&&e?(u.push([u[u.length-1][0],0]),h.push([h[h.length-1][0],0])):!a&&s&&(u.push([f,0]),h.push([f,0])),u.push([f,i]),h.push([f,i]),f+=p,s=a}}));for(var m=this.dataZoomModel,_=0;_<3;_++){var b=x(1===_);this._displayables.sliderGroup.add(b),this._displayables.dataShadowSegs.push(b)}}}function x(t){var e=m.getModel(t?"selectedDataBackground":"dataBackground"),a=new d["a"],i=new v["a"]({shape:{points:u},segmentIgnoreThreshold:1,style:e.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),n=new y["a"]({shape:{points:h},segmentIgnoreThreshold:1,style:e.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return a.add(i),a.add(n),a}},e.prototype._prepareDataShadowInfo=function(){var t=this.dataZoomModel,e=t.get("showDataShadow");if(!1!==e){var a,i=this.ecModel;return t.eachTargetAxis((function(n,o){var r=t.getAxisProxy(n,o).getTargetSeriesModels();Object(B["j"])(r,(function(t){if(!a&&!(!0!==e&&Object(B["p"])(oe,t.get("type"))<0)){var r,s=i.getComponent(N(n),o).axis,l=le(n),c=t.coordinateSystem;null!=l&&c.getOtherAxis&&(r=c.getOtherAxis(s).inverse),l=t.getData().mapDimension(l),a={thisAxis:s,series:t,thisDim:n,otherDim:l,otherAxisInverse:r}}}),this)}),this),a}},e.prototype._renderHandle=function(){var t=this.group,e=this._displayables,a=e.handles=[null,null],i=e.handleLabels=[null,null],n=this._displayables.sliderGroup,o=this._size,r=this.dataZoomModel,s=this.api,l=r.get("borderRadius")||0,c=r.get("brushSelect"),d=e.filler=new Kt({silent:c,style:{fill:r.get("fillerColor")},textConfig:{position:"inside"}});n.add(d),n.add(new Kt({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:o[0],height:o[1],r:l},style:{stroke:r.get("dataBackgroundColor")||r.get("borderColor"),lineWidth:Qt,fill:"rgba(0,0,0,0)"}})),Object(B["j"])([0,1],(function(e){var o=r.get("handleIcon");!$t["b"][o]&&o.indexOf("path://")<0&&o.indexOf("image://")<0&&(o="path://"+o);var s=Object($t["a"])(o,-1,0,2,2,null,!0);s.attr({cursor:ce(this._orient),draggable:!0,drift:Object(B["c"])(this._onDragMove,this,e),ondragend:Object(B["c"])(this._onDragEnd,this),onmouseover:Object(B["c"])(this._showDataInfo,this,!0),onmouseout:Object(B["c"])(this._showDataInfo,this,!1),z2:5});var l=s.getBoundingRect(),c=r.get("handleSize");this._handleHeight=Object(It["m"])(c,this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,s.setStyle(r.getModel("handleStyle").getItemStyle()),s.style.strokeNoScale=!0,s.rectHover=!0,s.ensureState("emphasis").style=r.getModel(["emphasis","handleStyle"]).getItemStyle(),Object(Gt["m"])(s);var d=r.get("handleColor");null!=d&&(s.style.fill=d),n.add(a[e]=s);var u=r.getModel("textStyle");t.add(i[e]=new h["a"]({silent:!0,invisible:!0,style:Object(Ut["b"])(u,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:u.getTextColor(),font:u.getFont()}),z2:10}))}),this);var u=d;if(c){var p=Object(It["m"])(r.get("moveHandleSize"),o[1]),f=e.moveHandle=new _["a"]({style:r.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:o[1]-.5,height:p}}),g=.8*p,m=e.moveHandleIcon=Object($t["a"])(r.get("moveHandleIcon"),-g/2,-g/2,g,g,"#fff",!0);m.silent=!0,m.y=o[1]+p/2-.5,f.ensureState("emphasis").style=r.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var v=Math.min(o[1]/2,Math.max(p,10));u=e.moveZone=new _["a"]({invisible:!0,shape:{y:o[1]-v,height:p+v}}),u.on("mouseover",(function(){s.enterEmphasis(f)})).on("mouseout",(function(){s.leaveEmphasis(f)})),n.add(f),n.add(m),n.add(u)}u.attr({draggable:!0,cursor:ce(this._orient),drift:Object(B["c"])(this._onDragMove,this,"all"),ondragstart:Object(B["c"])(this._showDataInfo,this,!0),ondragend:Object(B["c"])(this._onDragEnd,this),onmouseover:Object(B["c"])(this._showDataInfo,this,!0),onmouseout:Object(B["c"])(this._showDataInfo,this,!1)})},e.prototype._resetInterval=function(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[Object(It["i"])(t[0],[0,100],e,!0),Object(It["i"])(t[1],[0,100],e,!0)]},e.prototype._updateInterval=function(t,e){var a=this.dataZoomModel,i=this._handleEnds,n=this._getViewExtent(),o=a.findRepresentativeAxisProxy().getMinMaxSpan(),r=[0,100];at(e,i,n,a.get("zoomLock")?"all":t,null!=o.minSpan?Object(It["i"])(o.minSpan,r,n,!0):null,null!=o.maxSpan?Object(It["i"])(o.maxSpan,r,n,!0):null);var s=this._range,l=this._range=Object(It["b"])([Object(It["i"])(i[0],n,r,!0),Object(It["i"])(i[1],n,r,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},e.prototype._updateView=function(t){var e=this._displayables,a=this._handleEnds,i=Object(It["b"])(a.slice()),n=this._size;Object(B["j"])([0,1],(function(t){var i=e.handles[t],o=this._handleHeight;i.attr({scaleX:o/2,scaleY:o/2,x:a[t]+(t?-1:1),y:n[1]/2-o/2})}),this),e.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:n[1]});var o={x:i[0],width:i[1]-i[0]};e.moveHandle&&(e.moveHandle.setShape(o),e.moveZone.setShape(o),e.moveZone.getBoundingRect(),e.moveHandleIcon&&e.moveHandleIcon.attr("x",o.x+o.width/2));for(var r=e.dataShadowSegs,s=[0,i[0],i[1],n[0]],l=0;l<r.length;l++){var c=r[l],d=c.getClipPath();d||(d=new _["a"],c.setClipPath(d)),d.setShape({x:s[l],y:0,width:s[l+1]-s[l],height:n[1]})}this._updateDataInfo(t)},e.prototype._updateDataInfo=function(t){var e=this.dataZoomModel,a=this._displayables,i=a.handleLabels,n=this._orient,o=["",""];if(e.get("showDetail")){var r=e.findRepresentativeAxisProxy();if(r){var s=r.getAxisModel().axis,l=this._range,d=t?r.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:r.getDataValueWindow();o=[this._formatLabel(d[0],s),this._formatLabel(d[1],s)]}}var u=Object(It["b"])(this._handleEnds.slice());function h(t){var e=c["getTransform"](a.handles[t].parent,this.group),r=c["transformDirection"](0===t?"right":"left",e),s=this._handleWidth/2+ne,l=c["applyTransform"]([u[t]+(0===t?-s:s),this._size[1]/2],e);i[t].setStyle({x:l[0],y:l[1],verticalAlign:n===ae?"middle":r,align:n===ae?r:"center",text:o[t]})}h.call(this,0),h.call(this,1)},e.prototype._formatLabel=function(t,e){var a=this.dataZoomModel,i=a.get("labelFormatter"),n=a.get("labelPrecision");null!=n&&"auto"!==n||(n=e.getPixelPrecision());var o=null==t||isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel({value:Math.round(t)}):t.toFixed(Math.min(n,20));return Object(B["u"])(i)?i(t,o):Object(B["z"])(i)?i.replace("{value}",o):o},e.prototype._showDataInfo=function(t){t=this._dragging||t;var e=this._displayables,a=e.handleLabels;a[0].attr("invisible",!t),a[1].attr("invisible",!t),e.moveHandle&&this.api[t?"enterEmphasis":"leaveEmphasis"](e.moveHandle,1)},e.prototype._onDragMove=function(t,e,a,i){this._dragging=!0,rt["g"](i.event);var n=this._displayables.sliderGroup.getLocalTransform(),o=c["applyTransform"]([e,a],n,!0),r=this._updateInterval(t,o[0]),s=this.dataZoomModel.get("realtime");this._updateView(!s),r&&s&&this._dispatchZoomAction(!0)},e.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var t=this.dataZoomModel.get("realtime");!t&&this._dispatchZoomAction(!1)},e.prototype._onClickPanel=function(t){var e=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(t.offsetX,t.offsetY);if(!(a[0]<0||a[0]>e[0]||a[1]<0||a[1]>e[1])){var i=this._handleEnds,n=(i[0]+i[1])/2,o=this._updateInterval("all",a[0]-n);this._updateView(),o&&this._dispatchZoomAction(!1)}},e.prototype._onBrushStart=function(t){var e=t.offsetX,a=t.offsetY;this._brushStart=new Xt["a"](e,a),this._brushing=!0,this._brushStartTime=+new Date},e.prototype._onBrushEnd=function(t){if(this._brushing){var e=this._displayables.brushRect;if(this._brushing=!1,e){e.attr("ignore",!0);var a=e.shape,i=+new Date;if(!(i-this._brushStartTime<200&&Math.abs(a.width)<5)){var n=this._getViewExtent(),o=[0,100];this._range=Object(It["b"])([Object(It["i"])(a.x,n,o,!0),Object(It["i"])(a.x+a.width,n,o,!0)]),this._handleEnds=[a.x,a.x+a.width],this._updateView(),this._dispatchZoomAction(!1)}}}},e.prototype._onBrush=function(t){this._brushing&&(rt["g"](t.event),this._updateBrushRect(t.offsetX,t.offsetY))},e.prototype._updateBrushRect=function(t,e){var a=this._displayables,i=this.dataZoomModel,n=a.brushRect;n||(n=a.brushRect=new Kt({silent:!0,style:i.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(n)),n.attr("ignore",!1);var o=this._brushStart,r=this._displayables.sliderGroup,s=r.transformCoordToLocal(t,e),l=r.transformCoordToLocal(o.x,o.y),c=this._size;s[0]=Math.max(Math.min(c[0],s[0]),0),n.setShape({x:l[0],y:0,width:s[0]-l[0],height:c[1]})},e.prototype._dispatchZoomAction=function(t){var e=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:t?re:null,start:e[0],end:e[1]})},e.prototype._findCoordRect=function(){var t,e=Y(this.dataZoomModel).infoList;if(!t&&e.length){var a=e[0].model.coordinateSystem;t=a.getRect&&a.getRect()}if(!t){var i=this.api.getWidth(),n=this.api.getHeight();t={x:.2*i,y:.2*n,width:.6*i,height:.6*n}}return t},e.type="dataZoom.slider",e}(et);function le(t){var e={x:"y",y:"x",radius:"angle",angle:"radius"};return e[t]}function ce(t){return"vertical"===t?"ns-resize":"ew-resize"}var de=se;function ue(t){t.registerComponentModel(Yt),t.registerComponentView(de),Ht(t)}function he(t){Object(A["a"])(Nt),Object(A["a"])(ue)}Object(A["a"])(he);var pe=a("de2b"),fe=a("50fc"),ge={name:"Analytics",data(){return{accountsLoading:!1,accounts:[],accountId:null,loading:!1,riskLoading:!1,statsLoading:!1,curveLoading:!1,performanceData:{},riskData:{},statsList:[],equityCurve:[],curveDateRange:null,chartInstance:null}},beforeDestroy(){window.removeEventListener("resize",this._handleResize),this.chartInstance&&(this.chartInstance.dispose(),this.chartInstance=null)},mounted(){this._handleResize=()=>{this.chartInstance&&this.chartInstance.resize()},window.addEventListener("resize",this._handleResize),this.fetchAccounts()},methods:{formatMoney(t){return null===t||void 0===t?"-":Number(t).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})},formatPercent(t){return null===t||void 0===t?"-":(100*Number(t)).toFixed(2)+"%"},formatNumber(t,e=2){return null===t||void 0===t?"-":Number(t).toFixed(e)},getRiskTagType(t){if(!t)return"info";const e=t.toString().toLowerCase();return e.includes("低")||e.includes("low")?"success":e.includes("中")||e.includes("medium")?"warning":e.includes("高")||e.includes("high")?"danger":"info"},async fetchAccounts(){this.accountsLoading=!0;try{const t=await Object(fe["n"])({page_size:100}),e=t.data.data||t.data||[];this.accounts=Array.isArray(e)?e:[],this.accounts.length>0&&!this.accountId&&(this.accountId=this.accounts[0].id,this.fetchAll())}catch(t){console.error("获取账户列表失败:",t)}finally{this.accountsLoading=!1}},handleAccountChange(){this.accountId&&this.fetchAll()},fetchAll(){this.fetchPerformance(),this.fetchRisk(),this.fetchStatistics(),this.fetchEquityCurve()},async fetchPerformance(){if(this.accountId){this.loading=!0;try{const t=await Object(pe["c"])({account_id:this.accountId});t.data.success&&t.data.data&&(this.performanceData=t.data.data.summary||{})}catch(t){this.$message.error("获取绩效数据失败"),console.error("获取绩效数据失败:",t)}finally{this.loading=!1}}},async fetchRisk(){if(this.accountId){this.riskLoading=!0;try{const t=await Object(pe["d"])({account_id:this.accountId});t.data.success&&t.data.data&&(this.riskData=t.data.data||{})}catch(t){this.$message.error("获取风险数据失败"),console.error("获取风险数据失败:",t)}finally{this.riskLoading=!1}}},async fetchStatistics(){if(this.accountId){this.statsLoading=!0;try{const t=await Object(pe["e"])({account_id:this.accountId});t.data.success&&t.data.data&&(this.statsList=t.data.data||[])}catch(t){this.$message.error("获取统计数据失败"),console.error("获取统计数据失败:",t)}finally{this.statsLoading=!1}}},async fetchEquityCurve(){if(this.accountId){this.curveLoading=!0;try{const t={account_id:this.accountId};if(this.curveDateRange&&2===this.curveDateRange.length)t.start_date=this.curveDateRange[0],t.end_date=this.curveDateRange[1];else{const e=new Date,a=new Date(e.getTime()-2592e6),i=t=>t.toISOString().slice(0,10);t.start_date=i(a),t.end_date=i(e)}const e=await Object(pe["c"])(t);if(e.data.success&&e.data.data&&e.data.data.equity_curve){const t=e.data.data.equity_curve,a=Array.isArray(t)?t:[];this.equityCurve=a.filter(t=>{var e,a,i;const n=t.date||t.snapshot_date||"",o=Number(null!==(e=null!==(a=null!==(i=t.equity)&&void 0!==i?i:t.nav)&&void 0!==a?a:t.value)&&void 0!==e?e:0);return n&&!Number.isNaN(o)&&o>=0})}else this.equityCurve=[];this.$nextTick(()=>this.renderChart())}catch(t){this.equityCurve=[]}finally{this.curveLoading=!1}}},renderChart(){if(!this.$refs.equityChart)return;if(0===this.equityCurve.length)return void(this.chartInstance&&this.chartInstance.clear());this.chartInstance||(this.chartInstance=r["b"](this.$refs.equityChart));const t=this.equityCurve.map(t=>t.date||t.snapshot_date||""),e=this.equityCurve.map(t=>{var e,a,i;const n=Number(null!==(e=null!==(a=null!==(i=t.equity)&&void 0!==i?i:t.nav)&&void 0!==a?a:t.value)&&void 0!==e?e:0);return Number.isNaN(n)?0:n});this.chartInstance.setOption({tooltip:{trigger:"axis",formatter:t=>{const e=t[0];return`${e.axisValue}<br/>权益: <b>${Number(e.value).toFixed(2)}</b> USDT`}},grid:{left:60,right:20,top:20,bottom:60},xAxis:{type:"category",data:t,axisLabel:{fontSize:11}},yAxis:{type:"value",axisLabel:{formatter:t=>t.toFixed(0)}},dataZoom:[{type:"inside",start:0,end:100},{type:"slider",start:0,end:100,height:20,bottom:5}],series:[{type:"line",data:e,smooth:!0,symbol:"none",lineStyle:{width:2,color:"#409EFF"},areaStyle:{color:new i.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(64,158,255,0.3)"},{offset:1,color:"rgba(64,158,255,0.02)"}])}}]})}}},me=ge,ve=(a("35ae"),a("2877")),ye=Object(ve["a"])(me,n,o,!1,null,"a913af4e",null);e["default"]=ye.exports}}]);