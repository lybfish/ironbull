(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e2f79c0"],{"396e":function(t,e,a){},7663:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"总挂单",value:t.stats.total,icon:"el-icon-tickets",color:"primary",loading:t.statsLoading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"等待中",value:t.stats.pending,icon:"el-icon-time",color:"warning",loading:t.statsLoading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已成交",value:t.stats.filled,icon:"el-icon-circle-check",color:"success",loading:t.statsLoading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已撤/过期",value:t.stats.cancelled+t.stats.expired,icon:"el-icon-remove-outline",color:"info",loading:t.statsLoading}})],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"toolbar"},[a("span",{staticClass:"toolbar-title"},[t._v("限价挂单记录")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("div",{staticClass:"search-bar"},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",{attrs:{label:"交易对"}},[a("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:"如 ETHUSDT",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.symbol,callback:function(e){t.$set(t.where,"symbol",e)},expression:"where.symbol"}})],1),a("el-form-item",{attrs:{label:"策略"}},[a("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"策略编码",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.strategy_code,callback:function(e){t.$set(t.where,"strategy_code",e)},expression:"where.strategy_code"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.status,callback:function(e){t.$set(t.where,"status",e)},expression:"where.status"}},[a("el-option",{attrs:{label:"等待中",value:"PENDING"}}),a("el-option",{attrs:{label:"已成交",value:"FILLED"}}),a("el-option",{attrs:{label:"确认中",value:"CONFIRMING"}}),a("el-option",{attrs:{label:"已过期",value:"EXPIRED"}}),a("el-option",{attrs:{label:"已撤单",value:"CANCELLED"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),a("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"symbol",label:"交易对",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("span",{staticStyle:{"font-weight":"600"}},[t._v(t._s(s.symbol))])]}}])}),a("el-table-column",{attrs:{prop:"side",label:"方向",width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-tag",{attrs:{type:"BUY"===s.side?"success":"danger",size:"mini",effect:"dark"}},[t._v(t._s("BUY"===s.side?"买入":"卖出"))])]}}])}),a("el-table-column",{attrs:{prop:"entry_price",label:"挂单价",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatPrice(a.entry_price)))]}}])}),a("el-table-column",{attrs:{label:"止损/止盈",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[s.stop_loss?a("div",{staticStyle:{color:"#F56C6C","font-size":"12px"}},[t._v("SL "+t._s(t.formatPrice(s.stop_loss)))]):t._e(),s.take_profit?a("div",{staticStyle:{color:"#67C23A","font-size":"12px"}},[t._v("TP "+t._s(t.formatPrice(s.take_profit)))]):t._e(),s.stop_loss||s.take_profit?t._e():a("span",{staticStyle:{color:"#C0C4CC"}},[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"成交信息",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[s.filled_price?a("div",[a("div",{staticStyle:{"font-size":"12px"}},[t._v("价 "+t._s(t.formatPrice(s.filled_price)))]),a("div",{staticStyle:{"font-size":"11px",color:"#909399"}},[t._v("量 "+t._s(s.filled_qty))])]):a("span",{staticStyle:{color:"#C0C4CC"}},[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"strategy_code",label:"策略",width:"140","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"金额/杠杆",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[s.amount_usdt?a("div",{staticStyle:{"font-size":"12px"}},[t._v(t._s(s.amount_usdt)+"U")]):t._e(),s.leverage?a("div",{staticStyle:{"font-size":"11px",color:"#909399"}},[t._v(t._s(s.leverage)+"x")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-tag",{attrs:{type:t.statusType(s.status),size:"mini"}},[t._v(t._s(t.statusLabel(s.status)))])]}}])}),a("el-table-column",{attrs:{prop:"placed_at",label:"挂单时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatTime(a.placed_at)))]}}])}),a("el-table-column",{attrs:{prop:"closed_at",label:"结束时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatTime(a.closed_at)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"80",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return["PENDING"===s.status||"CONFIRMING"===s.status?a("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleCancel(s)}}},[t._v(" 撤单 ")]):a("span",{staticStyle:{color:"#C0C4CC"}},[t._v("-")])]}}])})],1),t.loading||0!==t.list.length?t._e():a("el-empty",{attrs:{description:"暂无限价挂单记录"}}),t.total>0?a("div",{staticClass:"pagination-wrap"},[a("span",{staticClass:"total-tip"},[t._v("共 "+t._s(t.total)+" 条")]),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes",total:t.total,"page-sizes":[10,20,50,100],"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"size-change":t.fetchData,"current-change":t.fetchData}})],1):t._e()],1)],1)},n=[],i=a("8012"),r={name:"PendingOrders",data(){return{loading:!1,statsLoading:!1,list:[],total:0,currentPage:1,pageSize:20,where:{symbol:"",strategy_code:"",status:""},stats:{total:0,pending:0,filled:0,confirming:0,expired:0,cancelled:0}}},mounted(){this.fetchData(),this.fetchStats()},methods:{formatTime(t){return t?String(t).replace("T"," ").substring(0,19):"-"},formatPrice(t){if(null==t||""===t||0===t)return"-";const e=Number(t);return isNaN(e)?t:e>=1e3?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e>=1?e.toLocaleString("en-US",{minimumFractionDigits:4,maximumFractionDigits:4}):e.toLocaleString("en-US",{minimumFractionDigits:6,maximumFractionDigits:8})},statusType(t){const e={PENDING:"warning",FILLED:"success",CONFIRMING:"",EXPIRED:"info",CANCELLED:"info"};return e[t]||"info"},statusLabel(t){const e={PENDING:"等待中",FILLED:"已成交",CONFIRMING:"确认中",EXPIRED:"已过期",CANCELLED:"已撤单"};return e[t]||t},onSearch(){this.currentPage=1,this.fetchData()},resetSearch(){this.where={symbol:"",strategy_code:"",status:""},this.currentPage=1,this.fetchData(),this.fetchStats()},async handleCancel(t){const e="CONFIRMING"===t.status?"撤销确认并市价平仓":"撤销挂单";try{await this.$confirm(`确定要${e}（${t.symbol} ${t.side}）吗？`,"撤单确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})}catch{return}try{await Object(i["a"])(t.id),this.$message.success(e+"成功"),this.fetchData(),this.fetchStats()}catch(s){var a;this.$message.error((null===(a=s.response)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.detail)||e+"失败")}},async fetchStats(){this.statsLoading=!0;try{const t=await Object(i["f"])();this.stats=t.data.stats||this.stats}catch(t){}finally{this.statsLoading=!1}},async fetchData(){this.loading=!0;try{const t={page:this.currentPage,page_size:this.pageSize};this.where.symbol&&(t.symbol=this.where.symbol),this.where.strategy_code&&(t.strategy_code=this.where.strategy_code),this.where.status&&(t.status=this.where.status);const e=await Object(i["g"])(t),a=e.data;this.list=a.data||[],this.total=null!=a.total?a.total:this.list.length}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"获取挂单列表失败"),this.list=[],this.total=0}finally{this.loading=!1}}}},l=r,o=(a("8bbf"),a("2877")),c=Object(o["a"])(l,s,n,!1,null,"55c8d92a",null);e["default"]=c.exports},8012:function(t,e,a){"use strict";a.d(e,"e",(function(){return l})),a.d(e,"d",(function(){return o})),a.d(e,"h",(function(){return c})),a.d(e,"c",(function(){return u})),a.d(e,"i",(function(){return d})),a.d(e,"j",(function(){return p})),a.d(e,"b",(function(){return f})),a.d(e,"g",(function(){return g})),a.d(e,"f",(function(){return h})),a.d(e,"a",(function(){return m}));var s=a("bc3a"),n=a.n(s);let i={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function r(t){return{...i,...t}}function l(t={}){return n.a.get("/orders",{params:r({limit:50,...t})})}function o(t={}){return n.a.get("/fills",{params:r({limit:50,...t})})}function c(t={}){return n.a.get("/positions",{params:r({limit:100,...t})})}function u(t={}){return n.a.get("/accounts",{params:r({limit:50,...t})})}function d(t={}){return n.a.get("/transactions",{params:r({limit:50,...t})})}function p(t){return n.a.post("/manual-order",t)}function f(t){return n.a.post("/close-position",t)}function g(t={}){return n.a.get("/pending-limit-orders",{params:r(t)})}function h(t={}){return n.a.get("/pending-limit-orders/stats",{params:r(t)})}function m(t){return n.a.post(`/pending-limit-orders/${t}/cancel`)}},"8bbf":function(t,e,a){"use strict";a("396e")}}]);