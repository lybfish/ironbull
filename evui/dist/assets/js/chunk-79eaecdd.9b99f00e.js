(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79eaecdd"],{"3add":function(t,e,n){"use strict";n("5284")},"50fc":function(t,e,n){"use strict";n.d(e,"p",(function(){return s})),n.d(e,"f",(function(){return i})),n.d(e,"D",(function(){return o})),n.d(e,"z",(function(){return u})),n.d(e,"t",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"o",(function(){return d})),n.d(e,"g",(function(){return f})),n.d(e,"E",(function(){return p})),n.d(e,"d",(function(){return g})),n.d(e,"h",(function(){return m})),n.d(e,"s",(function(){return h})),n.d(e,"q",(function(){return b})),n.d(e,"u",(function(){return w})),n.d(e,"r",(function(){return v})),n.d(e,"w",(function(){return y})),n.d(e,"i",(function(){return $})),n.d(e,"e",(function(){return _})),n.d(e,"A",(function(){return k})),n.d(e,"x",(function(){return x})),n.d(e,"v",(function(){return z})),n.d(e,"m",(function(){return S})),n.d(e,"n",(function(){return D})),n.d(e,"C",(function(){return I})),n.d(e,"y",(function(){return j})),n.d(e,"j",(function(){return T})),n.d(e,"B",(function(){return V})),n.d(e,"k",(function(){return O})),n.d(e,"a",(function(){return F})),n.d(e,"c",(function(){return q})),n.d(e,"l",(function(){return A}));var a=n("bc3a"),r=n.n(a);function s(t={}){return r.a.get("/tenants",{params:t})}function i(t){return r.a.post("/tenants",t)}function o(t,e){return r.a.put("/tenants/"+t,e)}function u(t){return r.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return r.a.post(`/tenants/${t}/recharge`,e)}function l(t,e){return r.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function d(t,e={}){return r.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function f(t,e){return r.a.post(`/tenants/${t}/tenant-strategies`,e)}function p(t,e,n){return r.a.put(`/tenants/${t}/tenant-strategies/${e}`,n)}function g(t,e){return r.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function m(t,e){return r.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function h(t={}){return r.a.get("/users",{params:t})}function b(t){return r.a.get("/users/"+t)}function w(t,e){return r.a.post(`/users/${t}/recharge`,e)}function v(t,e={}){return r.a.get(`/users/${t}/team`,{params:e})}function y(t,e){return r.a.post(`/users/${t}/set-market-node`,e)}function $(t={}){return r.a.get("/admins",{params:t})}function _(t){return r.a.post("/admins",t)}function k(t,e){return r.a.put("/admins/"+t,e)}function x(t){return r.a.patch(`/admins/${t}/toggle`)}function z(t,e){return r.a.post(`/admins/${t}/reset-password`,e)}function S(t={}){return r.a.get("/strategies",{params:t})}function D(t){return r.a.get("/strategies/"+t)}function I(t,e){return r.a.post("/strategies/"+t,e)}function j(t){return r.a.patch(`/strategies/${t}/toggle`)}function T(t={}){return r.a.get("/strategy-bindings-admin",{params:t})}function V(t,e){return r.a.put("/strategy-bindings-admin/"+t,e)}function O(t={}){return r.a.get("/exchange-accounts",{params:t})}function F(t,e){return r.a.put(`/exchange-accounts/${t}/assign-node`,e)}function q(t){return r.a.post("/exchange-accounts/batch-assign-node",t)}function A(t={}){return r.a.get("/signal-events",{params:t})}},5284:function(t,e,n){},c007:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ele-body"},[n("el-card",{attrs:{shadow:"never"}},[n("div",{staticClass:"toolbar"},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.showDialog()}}},[t._v("新建管理员")]),n("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),n("el-table-column",{attrs:{prop:"username",label:"用户名",width:"140"}}),n("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"140"}}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:1===a.status?"success":"info",size:"mini"}},[t._v(t._s(1===a.status?"启用":"禁用"))])]}}])}),n("el-table-column",{attrs:{prop:"last_login_at",label:"最后登录",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatTime(n.last_login_at)))]}}])}),n("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatTime(n.created_at)))]}}])}),n("el-table-column",{attrs:{label:"操作",width:"260",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.showDialog(a)}}},[t._v("编辑")]),n("el-button",{attrs:{size:"mini",type:1===a.status?"warning":"success"},on:{click:function(e){return t.handleToggle(a)}}},[t._v(" "+t._s(1===a.status?"禁用":"启用")+" ")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleReset(a)}}},[t._v("重置密码")])]}}])})],1),t.loading||0!==t.list.length?t._e():n("el-empty",{attrs:{description:"暂无管理员"}}),t.total>0?n("div",{staticStyle:{"margin-top":"12px",display:"flex","justify-content":"space-between","align-items":"center"}},[n("span",{staticStyle:{color:"#909399","font-size":"12px"}},[t._v("共 "+t._s(t.total)+" 条")]),n("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.pageSize,total:t.total,layout:"prev, pager, next"},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.fetchData}})],1):t._e()],1),n("el-dialog",{attrs:{title:t.editId?"编辑管理员":"新建管理员",visible:t.dialogVisible,width:"440px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"adminForm",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[n("el-form-item",{attrs:{label:"用户名",prop:"username"}},[n("el-input",{attrs:{disabled:!!t.editId,placeholder:"请输入用户名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t.editId?t._e():n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password","show-password":"",placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("el-form-item",{attrs:{label:"昵称"}},[n("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),n("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSave}},[t._v("确定")])],1)],1)],1)},r=[],s=n("50fc"),i={name:"AdminManage",data(){return{loading:!1,saving:!1,list:[],total:0,page:1,pageSize:20,dialogVisible:!1,editId:null,form:{username:"",password:"",nickname:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}]}}},mounted(){this.fetchData()},methods:{formatTime(t){return t?t.replace("T"," ").substring(0,19):"-"},showDialog(t){t?(this.editId=t.id,this.form={username:t.username,password:"",nickname:t.nickname||""}):(this.editId=null,this.form={username:"",password:"",nickname:""}),this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.adminForm&&this.$refs.adminForm.clearValidate()})},async fetchData(){this.loading=!0;try{const t=await Object(s["i"])({page:this.page,page_size:this.pageSize});this.list=t.data.data||[],this.total=t.data.total||this.list.length}catch(t){this.$message.error("获取管理员列表失败")}finally{this.loading=!1}},async handleSave(){try{await this.$refs.adminForm.validate()}catch(t){return}this.saving=!0;try{this.editId?await Object(s["A"])(this.editId,{nickname:this.form.nickname}):await Object(s["e"])(this.form),this.$message.success("保存成功"),this.dialogVisible=!1,this.fetchData()}catch(t){this.$message.error(t.response?t.response.data.detail:"保存失败")}finally{this.saving=!1}},async handleToggle(t){try{await Object(s["x"])(t.id),this.$message.success("操作成功"),this.fetchData()}catch(e){this.$message.error(e.response?e.response.data.detail:"操作失败")}},handleReset(t){this.$prompt("请输入新密码","重置密码 - "+t.username,{inputType:"password",inputPattern:/.{6,}/,inputErrorMessage:"密码至少6位"}).then(({value:e})=>{Object(s["v"])(t.id,{new_password:e}).then(()=>{this.$message.success("密码已重置")}).catch(()=>{this.$message.error("重置失败")})}).catch(()=>{})}}},o=i,u=(n("3add"),n("2877")),c=Object(u["a"])(o,a,r,!1,null,"74f1d858",null);e["default"]=c.exports}}]);