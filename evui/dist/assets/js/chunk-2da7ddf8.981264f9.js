(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2da7ddf8"],{"22d3":function(t,e,a){},3107:function(t,e,a){"use strict";a("22d3")},"50fc":function(t,e,a){"use strict";a.d(e,"p",(function(){return s})),a.d(e,"f",(function(){return i})),a.d(e,"D",(function(){return l})),a.d(e,"z",(function(){return o})),a.d(e,"t",(function(){return c})),a.d(e,"b",(function(){return u})),a.d(e,"o",(function(){return d})),a.d(e,"g",(function(){return p})),a.d(e,"E",(function(){return g})),a.d(e,"d",(function(){return f})),a.d(e,"h",(function(){return h})),a.d(e,"s",(function(){return v})),a.d(e,"q",(function(){return _})),a.d(e,"u",(function(){return m})),a.d(e,"r",(function(){return b})),a.d(e,"w",(function(){return w})),a.d(e,"i",(function(){return y})),a.d(e,"e",(function(){return S})),a.d(e,"A",(function(){return x})),a.d(e,"x",(function(){return E})),a.d(e,"v",(function(){return D})),a.d(e,"m",(function(){return k})),a.d(e,"n",(function(){return C})),a.d(e,"C",(function(){return $})),a.d(e,"y",(function(){return T})),a.d(e,"j",(function(){return R})),a.d(e,"B",(function(){return z})),a.d(e,"k",(function(){return I})),a.d(e,"a",(function(){return P})),a.d(e,"c",(function(){return A})),a.d(e,"l",(function(){return j}));var n=a("bc3a"),r=a.n(n);function s(t={}){return r.a.get("/tenants",{params:t})}function i(t){return r.a.post("/tenants",t)}function l(t,e){return r.a.put("/tenants/"+t,e)}function o(t){return r.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return r.a.post(`/tenants/${t}/recharge`,e)}function u(t,e){return r.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function d(t,e={}){return r.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function p(t,e){return r.a.post(`/tenants/${t}/tenant-strategies`,e)}function g(t,e,a){return r.a.put(`/tenants/${t}/tenant-strategies/${e}`,a)}function f(t,e){return r.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function h(t,e){return r.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function v(t={}){return r.a.get("/users",{params:t})}function _(t){return r.a.get("/users/"+t)}function m(t,e){return r.a.post(`/users/${t}/recharge`,e)}function b(t,e={}){return r.a.get(`/users/${t}/team`,{params:e})}function w(t,e){return r.a.post(`/users/${t}/set-market-node`,e)}function y(t={}){return r.a.get("/admins",{params:t})}function S(t){return r.a.post("/admins",t)}function x(t,e){return r.a.put("/admins/"+t,e)}function E(t){return r.a.patch(`/admins/${t}/toggle`)}function D(t,e){return r.a.post(`/admins/${t}/reset-password`,e)}function k(t={}){return r.a.get("/strategies",{params:t})}function C(t){return r.a.get("/strategies/"+t)}function $(t,e){return r.a.post("/strategies/"+t,e)}function T(t){return r.a.patch(`/strategies/${t}/toggle`)}function R(t={}){return r.a.get("/strategy-bindings-admin",{params:t})}function z(t,e){return r.a.put("/strategy-bindings-admin/"+t,e)}function I(t={}){return r.a.get("/exchange-accounts",{params:t})}function P(t,e){return r.a.put(`/exchange-accounts/${t}/assign-node`,e)}function A(t){return r.a.post("/exchange-accounts/batch-assign-node",t)}function j(t={}){return r.a.get("/signal-events",{params:t})}},f1b3:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"信号总数",value:t.total,icon:"el-icon-s-opportunity",color:"primary",loading:t.loading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已执行",value:t.stats.executed,icon:"el-icon-circle-check",color:"success",loading:t.loading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已拒绝",value:t.stats.rejected,icon:"el-icon-circle-close",color:"danger",loading:t.loading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"待处理/其他",value:t.stats.pending,icon:"el-icon-time",color:"warning",loading:t.loading}})],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"toolbar"},[a("span",{staticClass:"toolbar-title"},[t._v("信号事件历史")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("div",{staticClass:"search-bar"},[a("el-form",{attrs:{inline:!0,size:"small"}},[a("el-form-item",{attrs:{label:"信号ID"}},[a("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"信号ID",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.signal_id,callback:function(e){t.$set(t.where,"signal_id",e)},expression:"where.signal_id"}})],1),a("el-form-item",{attrs:{label:"事件类型"}},[a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.event_type,callback:function(e){t.$set(t.where,"event_type",e)},expression:"where.event_type"}},[a("el-option",{attrs:{label:"创建",value:"CREATED"}}),a("el-option",{attrs:{label:"风控通过",value:"RISK_PASSED"}}),a("el-option",{attrs:{label:"风控拒绝",value:"RISK_REJECTED"}}),a("el-option",{attrs:{label:"已分发",value:"DISPATCHED"}}),a("el-option",{attrs:{label:"已执行",value:"EXECUTED"}}),a("el-option",{attrs:{label:"失败",value:"FAILED"}})],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"110px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.status,callback:function(e){t.$set(t.where,"status",e)},expression:"where.status"}},[a("el-option",{attrs:{label:"待处理",value:"pending"}}),a("el-option",{attrs:{label:"通过",value:"passed"}}),a("el-option",{attrs:{label:"拒绝",value:"rejected"}}),a("el-option",{attrs:{label:"执行中",value:"executing"}}),a("el-option",{attrs:{label:"已执行",value:"executed"}}),a("el-option",{attrs:{label:"失败",value:"failed"}})],1)],1),a("el-form-item",{attrs:{label:"来源服务"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.source_service,callback:function(e){t.$set(t.where,"source_service",e)},expression:"where.source_service"}},[a("el-option",{attrs:{label:"signal-hub",value:"signal-hub"}}),a("el-option",{attrs:{label:"signal-monitor",value:"signal-monitor"}}),a("el-option",{attrs:{label:"position-monitor",value:"position-monitor"}}),a("el-option",{attrs:{label:"risk-control",value:"risk-control"}}),a("el-option",{attrs:{label:"execution-dispatcher",value:"execution-dispatcher"}})],1)],1),a("el-form-item",{attrs:{label:"日期范围"}},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束","value-format":"yyyy-MM-dd"},model:{value:t.where.dateRange,callback:function(e){t.$set(t.where,"dateRange",e)},expression:"where.dateRange"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),a("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"signal_id",label:"信号ID",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticClass:"id-text"},[t._v(t._s(n.signal_id))])]}}])}),a("el-table-column",{attrs:{prop:"event_type",label:"事件类型",width:"130",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.eventTypeTag(n.event_type),size:"mini"}},[t._v(t._s(t.eventTypeLabel(n.event_type)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.statusTag(n.status),size:"mini",effect:"dark"}},[t._v(t._s(t.statusLabel(n.status)))])]}}])}),a("el-table-column",{attrs:{prop:"source_service",label:"来源服务",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticClass:"text-muted"},[t._v(t._s(n.source_service))])]}}])}),a("el-table-column",{attrs:{label:"账户",width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.account_id?a("span",[t._v("#"+t._s(n.account_id))]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"详情","min-width":"200","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.detail&&"object"===typeof n.detail?a("div",[n.detail.symbol?a("span",{staticStyle:{"font-weight":"600","margin-right":"6px"}},[t._v(t._s(n.detail.symbol))]):t._e(),n.detail.action?a("span",[a("el-tag",{attrs:{type:"BUY"===n.detail.action?"success":"danger",size:"mini"}},[t._v(t._s(n.detail.action))])],1):t._e(),n.detail.price?a("span",{staticStyle:{"margin-left":"6px"}},[t._v("@ "+t._s(n.detail.price))]):t._e(),n.detail.strategy_code?a("span",{staticStyle:{"margin-left":"6px",color:"#909399"}},[t._v("["+t._s(n.detail.strategy_code)+"]")]):t._e()]):n.detail?a("span",{staticClass:"text-muted"},[t._v(t._s("string"===typeof n.detail?n.detail:JSON.stringify(n.detail)))]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"错误信息",width:"150","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.error_message?a("span",{staticStyle:{color:"#F56C6C"}},[t._v(t._s(n.error_message))]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatTime(a.created_at)))]}}])})],1),t.loading||0!==t.list.length?t._e():a("el-empty",{attrs:{description:"暂无信号事件记录"}}),t.total>0?a("div",{staticClass:"pagination-wrap"},[a("span",{staticClass:"total-tip"},[t._v("共 "+t._s(t.total)+" 条")]),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes",total:t.total,"page-sizes":[20,50,100],"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"size-change":t.fetchData,"current-change":t.fetchData}})],1):t._e()],1)],1)},r=[],s=(a("0643"),a("4e3e"),a("50fc")),i={name:"SignalHistory",data(){return{loading:!1,list:[],total:0,currentPage:1,pageSize:20,where:{signal_id:"",event_type:"",status:"",source_service:"",dateRange:null}}},computed:{stats(){const t={executed:0,rejected:0,pending:0};return this.list.forEach(e=>{const a=(e.status||"").toLowerCase();"executed"===a?t.executed++:"rejected"===a||"failed"===a?t.rejected++:t.pending++}),t}},mounted(){this.fetchData()},methods:{eventTypeLabel(t){const e={CREATED:"创建",RISK_CHECK:"风控检查",RISK_PASSED:"风控通过",RISK_REJECTED:"风控拒绝",DISPATCHED:"已分发",EXECUTED:"已执行",FAILED:"失败"};return e[t]||t},eventTypeTag(t){const e={CREATED:"",RISK_CHECK:"info",RISK_PASSED:"success",RISK_REJECTED:"danger",DISPATCHED:"warning",EXECUTED:"success",FAILED:"danger"};return e[t]||"info"},statusLabel(t){const e={pending:"待处理",passed:"通过",rejected:"拒绝",executing:"执行中",executed:"已执行",failed:"失败"};return e[t]||t},statusTag(t){const e={pending:"warning",passed:"success",rejected:"danger",executing:"warning",executed:"success",failed:"danger"};return e[t]||"info"},formatTime(t){if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return String(t).replace("T"," ").substring(0,19);const a=t=>String(t).padStart(2,"0");return`${e.getFullYear()}-${a(e.getMonth()+1)}-${a(e.getDate())} ${a(e.getHours())}:${a(e.getMinutes())}:${a(e.getSeconds())}`},onSearch(){this.currentPage=1,this.fetchData()},reset(){this.where={signal_id:"",event_type:"",status:"",source_service:"",dateRange:null},this.currentPage=1,this.fetchData()},async fetchData(){this.loading=!0;try{const t={page:this.currentPage,page_size:this.pageSize};this.where.signal_id&&(t.signal_id=this.where.signal_id),this.where.event_type&&(t.event_type=this.where.event_type),this.where.status&&(t.status=this.where.status),this.where.source_service&&(t.source_service=this.where.source_service),this.where.dateRange&&2===this.where.dateRange.length&&(t.start_date=this.where.dateRange[0],t.end_date=this.where.dateRange[1]);const e=await Object(s["l"])(t),a=e.data;this.list=a.data||[],this.total=null!=a.total?a.total:this.list.length}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"获取信号事件失败"),this.list=[],this.total=0}finally{this.loading=!1}}}},l=i,o=(a("3107"),a("2877")),c=Object(o["a"])(l,n,r,!1,null,"194b3f6c",null);e["default"]=c.exports}}]);