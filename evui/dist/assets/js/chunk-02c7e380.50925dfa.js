(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02c7e380"],{"0af5":function(e,r,t){},8012:function(e,r,t){"use strict";t.d(r,"e",(function(){return n})),t.d(r,"d",(function(){return l})),t.d(r,"h",(function(){return c})),t.d(r,"c",(function(){return m})),t.d(r,"i",(function(){return d})),t.d(r,"j",(function(){return u})),t.d(r,"b",(function(){return p})),t.d(r,"g",(function(){return g})),t.d(r,"f",(function(){return h})),t.d(r,"a",(function(){return b}));var s=t("bc3a"),o=t.n(s);let a={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function i(e){return{...a,...e}}function n(e={}){return o.a.get("/orders",{params:i({limit:50,...e})})}function l(e={}){return o.a.get("/fills",{params:i({limit:50,...e})})}function c(e={}){return o.a.get("/positions",{params:i({limit:100,...e})})}function m(e={}){return o.a.get("/accounts",{params:i({limit:50,...e})})}function d(e={}){return o.a.get("/transactions",{params:i({limit:50,...e})})}function u(e){return o.a.post("/manual-order",e)}function p(e){return o.a.post("/close-position",e)}function g(e={}){return o.a.get("/pending-limit-orders",{params:i(e)})}function h(e={}){return o.a.get("/pending-limit-orders/stats",{params:i(e)})}function b(e){return o.a.post(`/pending-limit-orders/${e}/cancel`)}},b9b7:function(e,r,t){"use strict";t("0af5")},da2d:function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"ele-body"},[t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"toolbar"},[t("span",{staticClass:"toolbar-title"},[e._v("交易控制台")])]),t("p",{staticClass:"intro"},[e._v("手动向交易所提交市价/限价单，请谨慎操作。策略运行时请避免冲突。")]),t("el-alert",{staticStyle:{"margin-bottom":"16px"},attrs:{title:"手动操作警告",type:"warning",closable:!1,"show-icon":""}},[t("div",{attrs:{slot:"description"},slot:"description"},[e._v(" 此控制台用于手动向交易所发送订单，请谨慎操作。手动订单可能影响策略运行，请确保您了解相关风险。 ")])]),t("div",{staticClass:"platform-target"},[t("span",{staticClass:"platform-label"},[e._v("当前下单目标：")]),t("el-tag",{attrs:{type:"primary",effect:"dark",size:"medium"}},[e._v(" "+e._s(e.exchangeLabel)+" · "+e._s(e.marketTypeLabel)+" ")])],1),t("el-form",{ref:"orderForm",attrs:{model:e.orderForm,rules:e.rules,"label-width":"100px",size:"medium"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"交易所",prop:"exchange"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择交易所"},model:{value:e.orderForm.exchange,callback:function(r){e.$set(e.orderForm,"exchange",r)},expression:"orderForm.exchange"}},[t("el-option",{attrs:{label:"Binance",value:"binance"}}),t("el-option",{attrs:{label:"OKX",value:"okx"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"市场类型",prop:"market_type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择市场"},model:{value:e.orderForm.market_type,callback:function(r){e.$set(e.orderForm,"market_type",r)},expression:"orderForm.market_type"}},[t("el-option",{attrs:{label:"合约 (USDT-M)",value:"future"}}),t("el-option",{attrs:{label:"现货",value:"spot"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"交易对",prop:"symbol"}},[t("el-input",{attrs:{placeholder:"如 BTC/USDT:USDT",clearable:""},model:{value:e.orderForm.symbol,callback:function(r){e.$set(e.orderForm,"symbol",r)},expression:"orderForm.symbol"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"方向",prop:"side"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择方向"},model:{value:e.orderForm.side,callback:function(r){e.$set(e.orderForm,"side",r)},expression:"orderForm.side"}},[t("el-option",{attrs:{label:"买入 (BUY)",value:"buy"}}),t("el-option",{attrs:{label:"卖出 (SELL)",value:"sell"}})],1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"订单类型",prop:"order_type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.orderForm.order_type,callback:function(r){e.$set(e.orderForm,"order_type",r)},expression:"orderForm.order_type"}},[t("el-option",{attrs:{label:"市价单",value:"market"}}),t("el-option",{attrs:{label:"限价单",value:"limit"}})],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数量",prop:"amount"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:.001,max:1e6,precision:3,placeholder:"请输入数量"},model:{value:e.orderForm.amount,callback:function(r){e.$set(e.orderForm,"amount",r)},expression:"orderForm.amount"}})],1)],1),"limit"===e.orderForm.order_type?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"价格",prop:"price"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,placeholder:"请输入价格"},model:{value:e.orderForm.price,callback:function(r){e.$set(e.orderForm,"price",r)},expression:"orderForm.price"}})],1)],1):e._e(),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.submitting,icon:"el-icon-check"},on:{click:e.submitOrder}},[e._v(" 提交订单 ")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v(" 重置 ")])],1)],1)],1)],1)],1),t("el-card",{staticStyle:{"margin-top":"16px"},attrs:{shadow:"never"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("操作日志")]),t("el-button",{staticStyle:{float:"right"},attrs:{type:"text",size:"small",disabled:0===e.logs.length},on:{click:e.clearLogs}},[e._v(" 清空日志 ")])],1),0===e.logs.length?t("div",{staticClass:"empty-log"},[t("i",{staticClass:"el-icon-info"}),t("span",[e._v("暂无操作记录")])]):t("div",{staticClass:"log-container"},e._l(e.logs,(function(r,s){return t("div",{key:s,staticClass:"log-item"},[t("span",{staticClass:"log-time"},[e._v(e._s(r.time))]),t("el-tag",{attrs:{type:r.success?"success":"danger",size:"mini",effect:"plain"}},[e._v(" "+e._s(r.success?"成功":"失败")+" ")]),t("span",{staticClass:"log-message"},[e._v(e._s(r.message))])],1)})),0)])],1)},o=[],a=t("8012"),i={name:"TradeControl",data(){return{submitting:!1,orderForm:{exchange:"binance",market_type:"future",symbol:"",side:"buy",order_type:"market",amount:null,price:null},rules:{exchange:[{required:!0,message:"请选择交易所",trigger:"change"}],market_type:[{required:!0,message:"请选择市场类型",trigger:"change"}],symbol:[{required:!0,message:"请输入交易对",trigger:"blur"},{pattern:/^[A-Za-z0-9/]+$/,message:"交易对仅允许字母、数字和斜杠，如 BTC/USDT 或 BTCUSDT",trigger:"blur"},{min:2,max:32,message:"长度 2～32 字符",trigger:"blur"}],side:[{required:!0,message:"请选择方向",trigger:"change"}],order_type:[{required:!0,message:"请选择订单类型",trigger:"change"}],amount:[{required:!0,message:"请输入数量",trigger:"blur"},{type:"number",min:.001,message:"数量必须大于0.001",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"},{type:"number",min:0,message:"价格必须大于0",trigger:"blur"}]},logs:[]}},computed:{exchangeLabel(){const e={binance:"Binance",okx:"OKX"};return e[this.orderForm.exchange]||this.orderForm.exchange||"—"},marketTypeLabel(){const e={future:"合约 (USDT-M)",spot:"现货"};return e[this.orderForm.market_type]||this.orderForm.market_type||"—"}},watch:{"orderForm.order_type"(e){"market"===e&&(this.orderForm.price=null,this.$refs.orderForm&&this.$refs.orderForm.clearValidate("price"))}},methods:{async submitOrder(){this.$refs.orderForm.validate(async e=>{if(!e)return!1;if("limit"===this.orderForm.order_type&&!this.orderForm.price)return this.$message.warning("限价单必须填写价格"),!1;const r="buy"===this.orderForm.side?"买入(做多)":"卖出(做空)",t="market"===this.orderForm.order_type?"市价":"限价",s="limit"===this.orderForm.order_type?" @ "+this.orderForm.price:"",o=`即将向 ${this.exchangeLabel} 提交真实订单：\n\n方向：${r}\n类型：${t}\n标的：${this.orderForm.symbol}\n数量：${this.orderForm.amount}${s}\n\n此操作将直接在交易所执行，请确认无误！`;try{await this.$confirm(o,"订单确认",{confirmButtonText:"确认下单",cancelButtonText:"取消",type:"warning"})}catch(c){return}this.submitting=!0;const i=(new Date).toLocaleString("zh-CN"),n={exchange:this.orderForm.exchange,market_type:this.orderForm.market_type,symbol:this.orderForm.symbol,side:this.orderForm.side,order_type:this.orderForm.order_type,amount:this.orderForm.amount};"limit"===this.orderForm.order_type&&(n.price=this.orderForm.price);try{const e=await Object(a["j"])(n),r=e.data||{};if(!1===r.success)throw new Error(r.error||r.message||"下单失败");const t=`${this.exchangeLabel} ${this.marketTypeLabel}`,s=`[${t}] ${this.orderForm.side.toUpperCase()} ${this.orderForm.symbol} ${this.orderForm.amount} ${"limit"===this.orderForm.order_type?"@ "+this.orderForm.price:""}`;this.logs.unshift({time:i,success:!0,message:s}),this.$message.success("订单提交成功"),this.resetForm()}catch(m){var l;const e=null===(l=m.response)||void 0===l?void 0:l.data,r=e&&(e.detail||e.message||e.error)||m.message||"未知错误";this.logs.unshift({time:i,success:!1,message:"订单提交失败: "+r}),this.$message.error("订单提交失败: "+r)}finally{this.submitting=!1}})},resetForm(){this.$refs.orderForm.resetFields(),this.orderForm={exchange:"binance",market_type:"future",symbol:"",side:"buy",order_type:"market",amount:null,price:null}},clearLogs(){this.$confirm("确定要清空所有操作日志吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.logs=[],this.$message.success("日志已清空")}).catch(()=>{})}}},n=i,l=(t("b9b7"),t("2877")),c=Object(l["a"])(n,s,o,!1,null,"78a0c066",null);r["default"]=c.exports}}]);