(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19257b4c"],{"2a6c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ele-body"},[n("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[n("el-col",{attrs:{span:6}},[n("stat-card",{attrs:{title:"订单总数",value:t.total,icon:"el-icon-s-order",color:"primary",loading:t.loading,"help-text":"当前筛选结果"}})],1),n("el-col",{attrs:{span:6}},[n("stat-card",{attrs:{title:"已成交",value:t.stats.filled,icon:"el-icon-circle-check",color:"success",loading:t.loading}})],1),n("el-col",{attrs:{span:6}},[n("stat-card",{attrs:{title:"已取消/拒绝",value:t.stats.cancelled,icon:"el-icon-remove-outline",color:"info",loading:t.loading}})],1),n("el-col",{attrs:{span:6}},[n("stat-card",{attrs:{title:"待处理/部分",value:t.stats.pending,icon:"el-icon-time",color:"warning",loading:t.loading}})],1)],1),n("el-card",{attrs:{shadow:"never"}},[n("div",{staticClass:"toolbar"},[n("span",{staticClass:"toolbar-title"},[t._v("订单列表")]),n("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),n("div",{staticClass:"search-bar"},[n("el-form",{attrs:{inline:!0,model:t.where,size:"small"}},[n("el-form-item",{attrs:{label:"标的"}},[n("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"如 BTC/USDT",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.symbol,callback:function(e){t.$set(t.where,"symbol",e)},expression:"where.symbol"}})],1),n("el-form-item",{attrs:{label:"交易所"}},[n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.exchange,callback:function(e){t.$set(t.where,"exchange",e)},expression:"where.exchange"}},t._l(t.exchangeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t.toUpperCase(),value:t}})})),1)],1),n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.status,callback:function(e){t.$set(t.where,"status",e)},expression:"where.status"}},[n("el-option",{attrs:{label:"待处理",value:"PENDING"}}),n("el-option",{attrs:{label:"已成交",value:"FILLED"}}),n("el-option",{attrs:{label:"已取消",value:"CANCELLED"}}),n("el-option",{attrs:{label:"已拒绝",value:"REJECTED"}}),n("el-option",{attrs:{label:"部分成交",value:"PARTIAL"}})],1)],1),n("el-form-item",{attrs:{label:"方向"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.side,callback:function(e){t.$set(t.where,"side",e)},expression:"where.side"}},[n("el-option",{attrs:{label:"买入",value:"BUY"}}),n("el-option",{attrs:{label:"卖出",value:"SELL"}})],1)],1),n("el-form-item",{attrs:{label:"开/平仓"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.trade_type,callback:function(e){t.$set(t.where,"trade_type",e)},expression:"where.trade_type"}},[n("el-option",{attrs:{label:"开仓",value:"OPEN"}}),n("el-option",{attrs:{label:"平仓",value:"CLOSE"}}),n("el-option",{attrs:{label:"加仓",value:"ADD"}}),n("el-option",{attrs:{label:"减仓",value:"REDUCE"}})],1)],1),n("el-form-item",{attrs:{label:"账户"}},[n("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.account_id,callback:function(e){t.$set(t.where,"account_id",e)},expression:"where.account_id"}},t._l(t.accountOptions,(function(t){return n("el-option",{key:t.id,attrs:{label:"["+(t.exchange||"").toUpperCase()+"] #"+t.id,value:t.id}})})),1)],1),n("el-form-item",{attrs:{label:"日期范围"}},[n("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束","value-format":"yyyy-MM-dd"},model:{value:t.where.dateRange,callback:function(e){t.$set(t.where,"dateRange",e)},expression:"where.dateRange"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.filteredList,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[n("el-table-column",{attrs:{prop:"order_id",label:"订单ID",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tooltip",{attrs:{content:"点击查看关联成交",placement:"top"}},[n("span",{staticClass:"id-text copyable",on:{click:function(e){return t.goToFills(a.order_id)}}},[t._v(t._s(t.truncateId(a.order_id)))])])]}}])}),n("el-table-column",{attrs:{prop:"symbol",label:"标的",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",{staticStyle:{"font-weight":"600"}},[t._v(t._s(a.symbol))])]}}])}),n("el-table-column",{attrs:{prop:"exchange",label:"交易所",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{size:"mini",effect:"plain"}},[t._v(t._s((a.exchange||"").toUpperCase()))])]}}])}),n("el-table-column",{attrs:{label:"账户",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tooltip",{attrs:{content:"点击筛选此账户",placement:"top"}},[n("el-button",{staticClass:"account-link",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.filterByAccount(a.account_id)}}},[t._v(" #"+t._s(a.account_id)+" ")])],1)]}}])}),n("el-table-column",{attrs:{prop:"side",label:"方向",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:t.isBuy(a)?"success":"danger",size:"mini",effect:"dark"}},[t._v(" "+t._s(t.isBuy(a)?"买入":"卖出")+" ")]),a.position_side?n("div",{staticStyle:{"font-size":"11px",color:"#909399","margin-top":"2px"}},[t._v(t._s(a.position_side))]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"order_type",label:"类型",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(a.order_type))])]}}])}),n("el-table-column",{attrs:{label:"开/平仓",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:t.tradeTypeTag(a.trade_type),size:"mini",effect:"dark"}},[t._v(" "+t._s(t.tradeTypeLabel(a.trade_type))+" ")]),a.close_reason?n("div",{staticStyle:{"font-size":"11px","margin-top":"2px"}},[n("el-tag",{attrs:{type:"TP"===a.close_reason?"success":"danger",size:"mini",effect:"plain"}},[t._v(" "+t._s(t.closeReasonLabel(a.close_reason))+" ")])],1):t._e()]}}])}),n("el-table-column",{attrs:{label:"杠杆",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[a.leverage?n("span",[t._v(t._s(a.leverage)+"x")]):n("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),n("el-table-column",{attrs:{label:"成交进度",width:"130",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("div",{staticClass:"progress-cell"},[n("el-progress",{staticStyle:{width:"100%"},attrs:{percentage:t.fillPercent(a),"stroke-width":14,"text-inside":!0,color:t.fillPercent(a)>=100?"#67c23a":"#409eff"}}),n("span",{staticClass:"progress-text"},[t._v(t._s(t.formatNum(a.filled_quantity))+" / "+t._s(t.formatNum(a.quantity)))])],1)]}}])}),n("el-table-column",{attrs:{prop:"price",label:"委托价",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatPrice(n.price)))]}}])}),n("el-table-column",{attrs:{prop:"avg_price",label:"成交均价",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatPrice(n.avg_price)))]}}])}),n("el-table-column",{attrs:{label:"止损/止盈",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[a.stop_loss||a.take_profit?n("div",{staticStyle:{"line-height":"1.4"}},[a.stop_loss?n("div",{staticStyle:{color:"#F56C6C","font-size":"12px"}},[t._v("SL "+t._s(t.formatPrice(a.stop_loss)))]):t._e(),a.take_profit?n("div",{staticStyle:{color:"#67C23A","font-size":"12px"}},[t._v("TP "+t._s(t.formatPrice(a.take_profit)))]):t._e()]):n("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),n("el-table-column",{attrs:{label:"手续费",width:"80",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[a.total_fee?n("span",[t._v(t._s(t.formatNum(a.total_fee)))]):n("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:t.statusType(a.status),size:"mini"}},[t._v(t._s(t.statusLabel(a.status)))]),a.error_message?n("el-tooltip",{attrs:{content:a.error_message,placement:"top"}},[n("i",{staticClass:"el-icon-warning",staticStyle:{color:"#F56C6C","margin-left":"4px",cursor:"pointer"}})]):t._e()]}}])}),n("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatTime(n.created_at)))]}}])})],1),t.loading||0!==t.filteredList.length?t._e():n("el-empty",{attrs:{description:"暂无订单"}}),t.total>0?n("div",{staticClass:"pagination-wrap"},[n("span",{staticClass:"total-tip"},[t._v("共 "+t._s(t.total)+" 条")]),n("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes",total:t.total,"page-sizes":[10,20,50,100],"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"size-change":t.fetchData,"current-change":t.fetchData}})],1):t._e()],1)],1)},r=[],i=(n("0643"),n("4e3e"),n("8012")),s=n("50fc"),o={name:"OrderList",data(){return{loading:!1,list:[],total:0,currentPage:1,pageSize:20,where:{symbol:"",status:"",side:"",exchange:"",trade_type:"",account_id:"",dateRange:null},accountOptions:[]}},computed:{exchangeOptions(){const t=new Set;return this.list.forEach(e=>{e.exchange&&t.add(e.exchange)}),this.accountOptions.forEach(e=>{e.exchange&&t.add(e.exchange)}),Array.from(t).sort()},filteredList(){return this.list},stats(){const t={filled:0,cancelled:0,pending:0};return this.filteredList.forEach(e=>{const n=(e.status||"").toUpperCase();"FILLED"===n?t.filled++:"CANCELLED"===n||"REJECTED"===n?t.cancelled++:t.pending++}),t}},mounted(){this.$route.query.account_id&&(this.where.account_id=Number(this.$route.query.account_id)||this.$route.query.account_id),this.fetchData(),this.fetchAccounts()},methods:{isBuy(t){return"BUY"===(t.side||"").toUpperCase()},formatTime(t){if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return String(t).replace("T"," ").substring(0,19);const n=t=>String(t).padStart(2,"0");return`${e.getFullYear()}-${n(e.getMonth()+1)}-${n(e.getDate())} ${n(e.getHours())}:${n(e.getMinutes())}:${n(e.getSeconds())}`},formatPrice(t){if(null==t||""===t||0===t)return"-";const e=Number(t);return isNaN(e)?t:e>=1e3?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e>=1?e.toLocaleString("en-US",{minimumFractionDigits:4,maximumFractionDigits:4}):e.toLocaleString("en-US",{minimumFractionDigits:6,maximumFractionDigits:8})},formatNum(t){if(null==t||""===t)return"0";const e=parseFloat(t);return isNaN(e)?"0":e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:6})},truncateId(t){if(!t)return"-";const e=String(t);return e.length<=12?e:e.slice(0,8)+"..."+e.slice(-4)},copyId(t){t&&navigator.clipboard&&navigator.clipboard.writeText(t).then(()=>{this.$message.success("已复制: "+t)})},fillPercent(t){const e=parseFloat(t.quantity)||0,n=parseFloat(t.filled_quantity)||0;return e<=0?0:Math.min(100,Math.round(n/e*100))},statusType(t){const e={PENDING:"warning",FILLED:"success",CANCELLED:"info",REJECTED:"danger",PARTIAL:"warning"};return e[(t||"").toUpperCase()]||"info"},statusLabel(t){const e={PENDING:"待处理",FILLED:"已成交",CANCELLED:"已取消",REJECTED:"已拒绝",PARTIAL:"部分成交"};return e[(t||"").toUpperCase()]||t},tradeTypeLabel(t){const e={OPEN:"开仓",CLOSE:"平仓",ADD:"加仓",REDUCE:"减仓"};return e[(t||"").toUpperCase()]||"开仓"},tradeTypeTag(t){const e={OPEN:"",CLOSE:"warning",ADD:"info",REDUCE:"info"};return e[(t||"").toUpperCase()]||""},closeReasonLabel(t){const e={SL:"止损",TP:"止盈",SIGNAL:"信号平仓",MANUAL:"手动平仓",LIQUIDATION:"强平"};return e[(t||"").toUpperCase()]||t},goToFills(t){this.$router.push({path:"/trading/fills",query:{order_id:t}})},filterByAccount(t){this.where.account_id=t,this.onSearch()},onSearch(){this.currentPage=1,this.fetchData()},reset(){this.where={symbol:"",status:"",side:"",exchange:"",trade_type:"",account_id:"",dateRange:null},this.currentPage=1,this.fetchData()},async fetchAccounts(){try{const t=await Object(s["n"])({status:1});this.accountOptions=t.data.data||t.data||[]}catch(t){}},async fetchData(){this.loading=!0;try{const t={limit:this.pageSize,offset:(this.currentPage-1)*this.pageSize};this.where.symbol&&(t.symbol=this.where.symbol),this.where.status&&(t.status=this.where.status),this.where.side&&(t.side=this.where.side),this.where.trade_type&&(t.trade_type=this.where.trade_type),this.where.exchange&&(t.exchange=this.where.exchange),this.where.account_id&&(t.account_id=this.where.account_id),this.where.dateRange&&2===this.where.dateRange.length&&(t.start_time=this.where.dateRange[0]+"T00:00:00",t.end_time=this.where.dateRange[1]+"T23:59:59");const e=await Object(i["e"])(t),n=e.data;this.list=n.data||[],this.total=null!=n.total?n.total:this.list.length}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"获取订单失败"),this.list=[],this.total=0}finally{this.loading=!1}}}},l=o,c=(n("8147"),n("2877")),u=Object(c["a"])(l,a,r,!1,null,"08c00809",null);e["default"]=u.exports},"50fc":function(t,e,n){"use strict";n.d(e,"s",(function(){return i})),n.d(e,"g",(function(){return s})),n.d(e,"H",(function(){return o})),n.d(e,"C",(function(){return l})),n.d(e,"w",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"r",(function(){return d})),n.d(e,"h",(function(){return p})),n.d(e,"I",(function(){return f})),n.d(e,"d",(function(){return g})),n.d(e,"k",(function(){return h})),n.d(e,"v",(function(){return m})),n.d(e,"t",(function(){return _})),n.d(e,"x",(function(){return b})),n.d(e,"u",(function(){return y})),n.d(e,"z",(function(){return w})),n.d(e,"D",(function(){return v})),n.d(e,"l",(function(){return S})),n.d(e,"e",(function(){return x})),n.d(e,"E",(function(){return k})),n.d(e,"A",(function(){return C})),n.d(e,"y",(function(){return E})),n.d(e,"p",(function(){return D})),n.d(e,"q",(function(){return L})),n.d(e,"f",(function(){return $})),n.d(e,"G",(function(){return T})),n.d(e,"j",(function(){return N})),n.d(e,"B",(function(){return P})),n.d(e,"m",(function(){return z})),n.d(e,"F",(function(){return A})),n.d(e,"i",(function(){return U})),n.d(e,"n",(function(){return F})),n.d(e,"a",(function(){return I})),n.d(e,"c",(function(){return R})),n.d(e,"o",(function(){return O}));var a=n("bc3a"),r=n.n(a);function i(t={}){return r.a.get("/tenants",{params:t})}function s(t){return r.a.post("/tenants",t)}function o(t,e){return r.a.put("/tenants/"+t,e)}function l(t){return r.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return r.a.post(`/tenants/${t}/recharge`,e)}function u(t,e){return r.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function d(t,e={}){return r.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function p(t,e){return r.a.post(`/tenants/${t}/tenant-strategies`,e)}function f(t,e,n){return r.a.put(`/tenants/${t}/tenant-strategies/${e}`,n)}function g(t,e){return r.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function h(t,e){return r.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function m(t={}){return r.a.get("/users",{params:t})}function _(t){return r.a.get("/users/"+t)}function b(t,e){return r.a.post(`/users/${t}/recharge`,e)}function y(t,e={}){return r.a.get(`/users/${t}/team`,{params:e})}function w(t,e){return r.a.post(`/users/${t}/set-market-node`,e)}function v(t,e){return r.a.post(`/users/${t}/toggle-status`,{status:e})}function S(t={}){return r.a.get("/admins",{params:t})}function x(t){return r.a.post("/admins",t)}function k(t,e){return r.a.put("/admins/"+t,e)}function C(t){return r.a.patch(`/admins/${t}/toggle`)}function E(t,e){return r.a.post(`/admins/${t}/reset-password`,e)}function D(t={}){return r.a.get("/strategies",{params:t})}function L(t){return r.a.get("/strategies/"+t)}function $(t){return r.a.post("/strategies",t)}function T(t,e){return r.a.post("/strategies/"+t,e)}function N(t){return r.a.delete("/strategies/"+t)}function P(t){return r.a.patch(`/strategies/${t}/toggle`)}function z(t={}){return r.a.get("/strategy-bindings-admin",{params:t})}function A(t,e){return r.a.put("/strategy-bindings-admin/"+t,e)}function U(t){return r.a.delete("/strategy-bindings-admin/"+t)}function F(t={}){return r.a.get("/exchange-accounts",{params:t})}function I(t,e){return r.a.put(`/exchange-accounts/${t}/assign-node`,e)}function R(t){return r.a.post("/exchange-accounts/batch-assign-node",t)}function O(t={}){return r.a.get("/signal-events",{params:t})}},8012:function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return l})),n.d(e,"h",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return p})),n.d(e,"b",(function(){return f})),n.d(e,"g",(function(){return g})),n.d(e,"f",(function(){return h})),n.d(e,"a",(function(){return m}));var a=n("bc3a"),r=n.n(a);let i={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function s(t){return{...i,...t}}function o(t={}){return r.a.get("/orders",{params:s({limit:50,...t})})}function l(t={}){return r.a.get("/fills",{params:s({limit:50,...t})})}function c(t={}){return r.a.get("/positions",{params:s({limit:100,...t})})}function u(t={}){return r.a.get("/accounts",{params:s({limit:50,...t})})}function d(t={}){return r.a.get("/transactions",{params:s({limit:50,...t})})}function p(t){return r.a.post("/manual-order",t)}function f(t){return r.a.post("/close-position",t)}function g(t={}){return r.a.get("/pending-limit-orders",{params:s(t)})}function h(t={}){return r.a.get("/pending-limit-orders/stats",{params:s(t)})}function m(t){return r.a.post(`/pending-limit-orders/${t}/cancel`)}},8147:function(t,e,n){"use strict";n("8994")},8994:function(t,e,n){}}]);