(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1199442b"],{"042f":function(t,e,a){},"2a6c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"订单总数",value:t.total,icon:"el-icon-s-order",color:"primary",loading:t.loading,"help-text":"当前筛选结果"}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已成交",value:t.stats.filled,icon:"el-icon-circle-check",color:"success",loading:t.loading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"已取消/拒绝",value:t.stats.cancelled,icon:"el-icon-remove-outline",color:"info",loading:t.loading}})],1),a("el-col",{attrs:{span:6}},[a("stat-card",{attrs:{title:"待处理/部分",value:t.stats.pending,icon:"el-icon-time",color:"warning",loading:t.loading}})],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"toolbar"},[a("span",{staticClass:"toolbar-title"},[t._v("订单列表")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("div",{staticClass:"search-bar"},[a("el-form",{attrs:{inline:!0,model:t.where,size:"small"}},[a("el-form-item",{attrs:{label:"标的"}},[a("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"如 BTC/USDT",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.symbol,callback:function(e){t.$set(t.where,"symbol",e)},expression:"where.symbol"}})],1),a("el-form-item",{attrs:{label:"交易所"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.exchange,callback:function(e){t.$set(t.where,"exchange",e)},expression:"where.exchange"}},t._l(t.exchangeOptions,(function(t){return a("el-option",{key:t,attrs:{label:t.toUpperCase(),value:t}})})),1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.status,callback:function(e){t.$set(t.where,"status",e)},expression:"where.status"}},[a("el-option",{attrs:{label:"待处理",value:"PENDING"}}),a("el-option",{attrs:{label:"已成交",value:"FILLED"}}),a("el-option",{attrs:{label:"已取消",value:"CANCELLED"}}),a("el-option",{attrs:{label:"已拒绝",value:"REJECTED"}}),a("el-option",{attrs:{label:"部分成交",value:"PARTIAL"}})],1)],1),a("el-form-item",{attrs:{label:"方向"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.side,callback:function(e){t.$set(t.where,"side",e)},expression:"where.side"}},[a("el-option",{attrs:{label:"买入",value:"BUY"}}),a("el-option",{attrs:{label:"卖出",value:"SELL"}})],1)],1),a("el-form-item",{attrs:{label:"开/平仓"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.trade_type,callback:function(e){t.$set(t.where,"trade_type",e)},expression:"where.trade_type"}},[a("el-option",{attrs:{label:"开仓",value:"OPEN"}}),a("el-option",{attrs:{label:"平仓",value:"CLOSE"}}),a("el-option",{attrs:{label:"加仓",value:"ADD"}}),a("el-option",{attrs:{label:"减仓",value:"REDUCE"}})],1)],1),a("el-form-item",{attrs:{label:"日期范围"}},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束","value-format":"yyyy-MM-dd"},model:{value:t.where.dateRange,callback:function(e){t.$set(t.where,"dateRange",e)},expression:"where.dateRange"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),a("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.filteredList,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"order_id",label:"订单ID",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tooltip",{attrs:{content:n.order_id,placement:"top"}},[a("span",{staticClass:"id-text copyable",on:{click:function(e){return t.copyId(n.order_id)}}},[t._v(t._s(t.truncateId(n.order_id)))])])]}}])}),a("el-table-column",{attrs:{prop:"symbol",label:"标的",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticStyle:{"font-weight":"600"}},[t._v(t._s(n.symbol))])]}}])}),a("el-table-column",{attrs:{prop:"exchange",label:"交易所",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{size:"mini",effect:"plain"}},[t._v(t._s((n.exchange||"").toUpperCase()))])]}}])}),a("el-table-column",{attrs:{label:"账户",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticClass:"text-muted"},[t._v("#"+t._s(n.account_id))])]}}])}),a("el-table-column",{attrs:{prop:"side",label:"方向",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.isBuy(n)?"success":"danger",size:"mini",effect:"dark"}},[t._v(" "+t._s(t.isBuy(n)?"买入":"卖出")+" ")]),n.position_side?a("div",{staticStyle:{"font-size":"11px",color:"#909399","margin-top":"2px"}},[t._v(t._s(n.position_side))]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"order_type",label:"类型",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.order_type))])]}}])}),a("el-table-column",{attrs:{label:"开/平仓",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.tradeTypeTag(n.trade_type),size:"mini",effect:"dark"}},[t._v(" "+t._s(t.tradeTypeLabel(n.trade_type))+" ")]),n.close_reason?a("div",{staticStyle:{"font-size":"11px","margin-top":"2px"}},[a("el-tag",{attrs:{type:"TP"===n.close_reason?"success":"danger",size:"mini",effect:"plain"}},[t._v(" "+t._s(t.closeReasonLabel(n.close_reason))+" ")])],1):t._e()]}}])}),a("el-table-column",{attrs:{label:"杠杆",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.leverage?a("span",[t._v(t._s(n.leverage)+"x")]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"成交进度",width:"130",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("div",{staticClass:"progress-cell"},[a("el-progress",{staticStyle:{width:"100%"},attrs:{percentage:t.fillPercent(n),"stroke-width":14,"text-inside":!0,color:t.fillPercent(n)>=100?"#67c23a":"#409eff"}}),a("span",{staticClass:"progress-text"},[t._v(t._s(t.formatNum(n.filled_quantity))+" / "+t._s(t.formatNum(n.quantity)))])],1)]}}])}),a("el-table-column",{attrs:{prop:"price",label:"委托价",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatPrice(a.price)))]}}])}),a("el-table-column",{attrs:{prop:"avg_price",label:"成交均价",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatPrice(a.avg_price)))]}}])}),a("el-table-column",{attrs:{label:"止损/止盈",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.stop_loss||n.take_profit?a("div",{staticStyle:{"line-height":"1.4"}},[n.stop_loss?a("div",{staticStyle:{color:"#F56C6C","font-size":"12px"}},[t._v("SL "+t._s(t.formatPrice(n.stop_loss)))]):t._e(),n.take_profit?a("div",{staticStyle:{color:"#67C23A","font-size":"12px"}},[t._v("TP "+t._s(t.formatPrice(n.take_profit)))]):t._e()]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"手续费",width:"80",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.total_fee?a("span",[t._v(t._s(t.formatNum(n.total_fee)))]):a("span",{staticClass:"text-muted"},[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.statusType(n.status),size:"mini"}},[t._v(t._s(t.statusLabel(n.status)))]),n.error_message?a("el-tooltip",{attrs:{content:n.error_message,placement:"top"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{color:"#F56C6C","margin-left":"4px",cursor:"pointer"}})]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatTime(a.created_at)))]}}])})],1),t.loading||0!==t.filteredList.length?t._e():a("el-empty",{attrs:{description:"暂无订单"}}),t.total>0?a("div",{staticClass:"pagination-wrap"},[a("span",{staticClass:"total-tip"},[t._v("共 "+t._s(t.total)+" 条")]),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes",total:t.total,"page-sizes":[10,20,50,100],"page-size":t.pageSize,"current-page":t.currentPage},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"size-change":t.fetchData,"current-change":t.fetchData}})],1):t._e()],1)],1)},r=[],s=(a("0643"),a("2382"),a("4e3e"),a("8012")),i=a("50fc"),o={name:"OrderList",data(){return{loading:!1,list:[],total:0,currentPage:1,pageSize:20,where:{symbol:"",status:"",side:"",exchange:"",trade_type:"",dateRange:null},accountOptions:[]}},computed:{exchangeOptions(){const t=new Set;return this.list.forEach(e=>{e.exchange&&t.add(e.exchange)}),this.accountOptions.forEach(e=>{e.exchange&&t.add(e.exchange)}),Array.from(t).sort()},filteredList(){return this.list.filter(t=>!this.where.exchange||(t.exchange||"").toLowerCase()===this.where.exchange.toLowerCase())},stats(){const t={filled:0,cancelled:0,pending:0};return this.filteredList.forEach(e=>{const a=(e.status||"").toUpperCase();"FILLED"===a?t.filled++:"CANCELLED"===a||"REJECTED"===a?t.cancelled++:t.pending++}),t}},mounted(){this.fetchData(),this.fetchAccounts()},methods:{isBuy(t){return"BUY"===(t.side||"").toUpperCase()},formatTime(t){if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return String(t).replace("T"," ").substring(0,19);const a=t=>String(t).padStart(2,"0");return`${e.getFullYear()}-${a(e.getMonth()+1)}-${a(e.getDate())} ${a(e.getHours())}:${a(e.getMinutes())}:${a(e.getSeconds())}`},formatPrice(t){if(null==t||""===t||0===t)return"-";const e=Number(t);return isNaN(e)?t:e>=1e3?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e>=1?e.toLocaleString("en-US",{minimumFractionDigits:4,maximumFractionDigits:4}):e.toLocaleString("en-US",{minimumFractionDigits:6,maximumFractionDigits:8})},formatNum(t){if(null==t||""===t)return"0";const e=parseFloat(t);return isNaN(e)?"0":e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:6})},truncateId(t){if(!t)return"-";const e=String(t);return e.length<=12?e:e.slice(0,8)+"..."+e.slice(-4)},copyId(t){t&&navigator.clipboard&&navigator.clipboard.writeText(t).then(()=>{this.$message.success("已复制: "+t)})},fillPercent(t){const e=parseFloat(t.quantity)||0,a=parseFloat(t.filled_quantity)||0;return e<=0?0:Math.min(100,Math.round(a/e*100))},statusType(t){const e={PENDING:"warning",FILLED:"success",CANCELLED:"info",REJECTED:"danger",PARTIAL:"warning"};return e[(t||"").toUpperCase()]||"info"},statusLabel(t){const e={PENDING:"待处理",FILLED:"已成交",CANCELLED:"已取消",REJECTED:"已拒绝",PARTIAL:"部分成交"};return e[(t||"").toUpperCase()]||t},tradeTypeLabel(t){const e={OPEN:"开仓",CLOSE:"平仓",ADD:"加仓",REDUCE:"减仓"};return e[(t||"").toUpperCase()]||"开仓"},tradeTypeTag(t){const e={OPEN:"",CLOSE:"warning",ADD:"info",REDUCE:"info"};return e[(t||"").toUpperCase()]||""},closeReasonLabel(t){const e={SL:"止损",TP:"止盈",SIGNAL:"信号平仓",MANUAL:"手动平仓",LIQUIDATION:"强平"};return e[(t||"").toUpperCase()]||t},onSearch(){this.currentPage=1,this.fetchData()},reset(){this.where={symbol:"",status:"",side:"",exchange:"",trade_type:"",dateRange:null},this.currentPage=1,this.fetchData()},async fetchAccounts(){try{const t=await Object(i["k"])({status:1});this.accountOptions=t.data.data||t.data||[]}catch(t){}},async fetchData(){this.loading=!0;try{const t={limit:this.pageSize,offset:(this.currentPage-1)*this.pageSize};this.where.symbol&&(t.symbol=this.where.symbol),this.where.status&&(t.status=this.where.status),this.where.side&&(t.side=this.where.side),this.where.trade_type&&(t.trade_type=this.where.trade_type),this.where.dateRange&&2===this.where.dateRange.length&&(t.start_time=this.where.dateRange[0]+"T00:00:00",t.end_time=this.where.dateRange[1]+"T23:59:59");const e=await Object(s["c"])(t),a=e.data;this.list=a.data||[],this.total=null!=a.total?a.total:this.list.length}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"获取订单失败"),this.list=[],this.total=0}finally{this.loading=!1}}}},l=o,c=(a("a9ef"),a("2877")),u=Object(c["a"])(l,n,r,!1,null,"16892e02",null);e["default"]=u.exports},"50fc":function(t,e,a){"use strict";a.d(e,"p",(function(){return s})),a.d(e,"f",(function(){return i})),a.d(e,"D",(function(){return o})),a.d(e,"z",(function(){return l})),a.d(e,"t",(function(){return c})),a.d(e,"b",(function(){return u})),a.d(e,"o",(function(){return d})),a.d(e,"g",(function(){return p})),a.d(e,"E",(function(){return f})),a.d(e,"d",(function(){return g})),a.d(e,"h",(function(){return h})),a.d(e,"s",(function(){return m})),a.d(e,"q",(function(){return _})),a.d(e,"u",(function(){return b})),a.d(e,"r",(function(){return y})),a.d(e,"w",(function(){return w})),a.d(e,"i",(function(){return v})),a.d(e,"e",(function(){return S})),a.d(e,"A",(function(){return x})),a.d(e,"x",(function(){return C})),a.d(e,"v",(function(){return k})),a.d(e,"m",(function(){return E})),a.d(e,"n",(function(){return L})),a.d(e,"C",(function(){return D})),a.d(e,"y",(function(){return $})),a.d(e,"j",(function(){return N})),a.d(e,"B",(function(){return P})),a.d(e,"k",(function(){return T})),a.d(e,"a",(function(){return z})),a.d(e,"c",(function(){return A})),a.d(e,"l",(function(){return R}));var n=a("bc3a"),r=a.n(n);function s(t={}){return r.a.get("/tenants",{params:t})}function i(t){return r.a.post("/tenants",t)}function o(t,e){return r.a.put("/tenants/"+t,e)}function l(t){return r.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return r.a.post(`/tenants/${t}/recharge`,e)}function u(t,e){return r.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function d(t,e={}){return r.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function p(t,e){return r.a.post(`/tenants/${t}/tenant-strategies`,e)}function f(t,e,a){return r.a.put(`/tenants/${t}/tenant-strategies/${e}`,a)}function g(t,e){return r.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function h(t,e){return r.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function m(t={}){return r.a.get("/users",{params:t})}function _(t){return r.a.get("/users/"+t)}function b(t,e){return r.a.post(`/users/${t}/recharge`,e)}function y(t,e={}){return r.a.get(`/users/${t}/team`,{params:e})}function w(t,e){return r.a.post(`/users/${t}/set-market-node`,e)}function v(t={}){return r.a.get("/admins",{params:t})}function S(t){return r.a.post("/admins",t)}function x(t,e){return r.a.put("/admins/"+t,e)}function C(t){return r.a.patch(`/admins/${t}/toggle`)}function k(t,e){return r.a.post(`/admins/${t}/reset-password`,e)}function E(t={}){return r.a.get("/strategies",{params:t})}function L(t){return r.a.get("/strategies/"+t)}function D(t,e){return r.a.post("/strategies/"+t,e)}function $(t){return r.a.patch(`/strategies/${t}/toggle`)}function N(t={}){return r.a.get("/strategy-bindings-admin",{params:t})}function P(t,e){return r.a.put("/strategy-bindings-admin/"+t,e)}function T(t={}){return r.a.get("/exchange-accounts",{params:t})}function z(t,e){return r.a.put(`/exchange-accounts/${t}/assign-node`,e)}function A(t){return r.a.post("/exchange-accounts/batch-assign-node",t)}function R(t={}){return r.a.get("/signal-events",{params:t})}},8012:function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"d",(function(){return c})),a.d(e,"a",(function(){return u})),a.d(e,"e",(function(){return d}));var n=a("bc3a"),r=a.n(n);let s={tenant_id:1};function i(t){return{...s,...t}}function o(t={}){return r.a.get("/orders",{params:i({limit:50,...t})})}function l(t={}){return r.a.get("/fills",{params:i({limit:50,...t})})}function c(t={}){return r.a.get("/positions",{params:i({limit:100,...t})})}function u(t={}){return r.a.get("/accounts",{params:i({limit:50,...t})})}function d(t={}){return r.a.get("/transactions",{params:i({limit:50,...t})})}},a9ef:function(t,e,a){"use strict";a("042f")}}]);