(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-360fc028"],{8525:function(t,e,a){},"8c5b":function(t,e,a){"use strict";a("8525")},cd05:function(t,e,a){"use strict";a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"j",(function(){return n})),a.d(e,"i",(function(){return o})),a.d(e,"g",(function(){return c})),a.d(e,"a",(function(){return m})),a.d(e,"h",(function(){return u})),a.d(e,"b",(function(){return d})),a.d(e,"d",(function(){return p})),a.d(e,"f",(function(){return f}));var l=a("bc3a"),i=a.n(l);function r(t={}){return i.a.get("/quota-plans",{params:t})}function s(t){return i.a.post("/quota-plans",t)}function n(t,e){return i.a.put("/quota-plans/"+t,e)}function o(t){return i.a.patch(`/quota-plans/${t}/toggle`)}function c(t={}){return i.a.get("/withdrawals",{params:t})}function m(t){return i.a.post(`/withdrawals/${t}/approve`)}function u(t,e=""){return i.a.post(`/withdrawals/${t}/reject`,{reason:e})}function d(t,e=""){return i.a.post(`/withdrawals/${t}/complete`,{tx_hash:e})}function p(t={}){return i.a.get("/pointcard-logs",{params:t})}function f(t={}){return i.a.get("/rewards",{params:t})}},f8bd:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.showDialog()}}},[t._v("新建套餐")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"套餐名称",width:"150"}}),a("el-table-column",{attrs:{prop:"code",label:"编码",width:"120"}}),a("el-table-column",{attrs:{prop:"max_strategies",label:"最大策略数",width:"100",align:"right"}}),a("el-table-column",{attrs:{prop:"api_calls_daily",label:"日API调用",width:"100",align:"right"}}),a("el-table-column",{attrs:{prop:"api_calls_monthly",label:"月API调用",width:"100",align:"right"}}),a("el-table-column",{attrs:{prop:"max_users",label:"最大用户",width:"90",align:"right"}}),a("el-table-column",{attrs:{prop:"max_exchange_accounts",label:"最大账户",width:"90",align:"right"}}),a("el-table-column",{attrs:{prop:"price_monthly",label:"月费",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatPrice(a.price_monthly)))]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[a("el-tag",{attrs:{type:1===l.status?"success":"info",size:"mini"}},[t._v(t._s(1===l.status?"启用":"禁用"))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.showDialog(l)}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini",type:1===l.status?"warning":"success"},on:{click:function(e){return t.handleToggle(l)}}},[t._v(" "+t._s(1===l.status?"禁用":"启用")+" ")])]}}])})],1),t.loading||0!==t.list.length?t._e():a("el-empty",{attrs:{description:"暂无套餐"}})],1),a("el-dialog",{attrs:{title:t.editId?"编辑套餐":"新建套餐",visible:t.dialogVisible,width:"520px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"套餐名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入套餐名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t.editId?t._e():a("el-form-item",{attrs:{label:"编码",prop:"code"}},[a("el-input",{attrs:{placeholder:"唯一编码（如 basic / pro / enterprise）"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),a("el-form-item",{attrs:{label:"最大策略数",prop:"max_strategies"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.form.max_strategies,callback:function(e){t.$set(t.form,"max_strategies",e)},expression:"form.max_strategies"}})],1),a("el-form-item",{attrs:{label:"日API调用",prop:"api_calls_daily"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.form.api_calls_daily,callback:function(e){t.$set(t.form,"api_calls_daily",e)},expression:"form.api_calls_daily"}})],1),a("el-form-item",{attrs:{label:"月API调用",prop:"api_calls_monthly"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.form.api_calls_monthly,callback:function(e){t.$set(t.form,"api_calls_monthly",e)},expression:"form.api_calls_monthly"}})],1),a("el-form-item",{attrs:{label:"最大用户数",prop:"max_users"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.form.max_users,callback:function(e){t.$set(t.form,"max_users",e)},expression:"form.max_users"}})],1),a("el-form-item",{attrs:{label:"最大账户数",prop:"max_exchange_accounts"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.form.max_exchange_accounts,callback:function(e){t.$set(t.form,"max_exchange_accounts",e)},expression:"form.max_exchange_accounts"}})],1),a("el-form-item",{attrs:{label:"月费",prop:"price_monthly"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2},model:{value:t.form.price_monthly,callback:function(e){t.$set(t.form,"price_monthly",e)},expression:"form.price_monthly"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"套餐描述"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSave}},[t._v("确定")])],1)],1)],1)},i=[],r=a("cd05"),s={name:"QuotaPlanManage",data(){return{loading:!1,saving:!1,list:[],dialogVisible:!1,editId:null,form:{name:"",code:"",max_strategies:5,api_calls_daily:1e3,api_calls_monthly:3e4,max_users:100,max_exchange_accounts:10,price_monthly:0,description:""},rules:{name:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],code:[{required:!0,message:"请输入编码",trigger:"blur"}]}}},mounted(){this.fetchData()},methods:{formatPrice(t){return null!=t?Number(t).toFixed(2):"0.00"},showDialog(t){t?(this.editId=t.id,this.form={name:t.name,code:t.code||"",max_strategies:t.max_strategies||0,api_calls_daily:t.api_calls_daily||0,api_calls_monthly:t.api_calls_monthly||0,max_users:t.max_users||0,max_exchange_accounts:t.max_exchange_accounts||0,price_monthly:t.price_monthly||0,description:t.description||""}):(this.editId=null,this.form={name:"",code:"",max_strategies:5,api_calls_daily:1e3,api_calls_monthly:3e4,max_users:100,max_exchange_accounts:10,price_monthly:0,description:""}),this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.form&&this.$refs.form.clearValidate()})},async fetchData(){this.loading=!0;try{const t=await Object(r["e"])();this.list=t.data.data||[]}catch(t){this.$message.error("获取套餐失败")}finally{this.loading=!1}},async handleSave(){try{await this.$refs.form.validate()}catch(e){return}this.saving=!0;try{if(this.editId){const{code:t,...e}=this.form;await Object(r["j"])(this.editId,e)}else await Object(r["c"])(this.form);this.$message.success("保存成功"),this.dialogVisible=!1,this.fetchData()}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"保存失败")}finally{this.saving=!1}},async handleToggle(t){try{await Object(r["i"])(t.id),this.$message.success("操作成功"),this.fetchData()}catch(e){this.$message.error("操作失败")}}}},n=s,o=(a("8c5b"),a("2877")),c=Object(o["a"])(n,l,i,!1,null,"05c275ab",null);e["default"]=c.exports}}]);