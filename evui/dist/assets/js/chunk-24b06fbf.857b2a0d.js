(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24b06fbf"],{"3e47":function(t,e,a){"use strict";a("48e4")},"48e4":function(t,e,a){},"50fc":function(t,e,a){"use strict";a.d(e,"p",(function(){return n})),a.d(e,"f",(function(){return r})),a.d(e,"E",(function(){return s})),a.d(e,"z",(function(){return o})),a.d(e,"t",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"o",(function(){return u})),a.d(e,"g",(function(){return m})),a.d(e,"F",(function(){return p})),a.d(e,"d",(function(){return f})),a.d(e,"h",(function(){return b})),a.d(e,"s",(function(){return _})),a.d(e,"q",(function(){return g})),a.d(e,"u",(function(){return v})),a.d(e,"r",(function(){return h})),a.d(e,"w",(function(){return y})),a.d(e,"A",(function(){return w})),a.d(e,"i",(function(){return k})),a.d(e,"e",(function(){return D})),a.d(e,"B",(function(){return F})),a.d(e,"x",(function(){return S})),a.d(e,"v",(function(){return x})),a.d(e,"m",(function(){return T})),a.d(e,"n",(function(){return $})),a.d(e,"D",(function(){return U})),a.d(e,"y",(function(){return z})),a.d(e,"j",(function(){return N})),a.d(e,"C",(function(){return A})),a.d(e,"k",(function(){return O})),a.d(e,"a",(function(){return C})),a.d(e,"c",(function(){return B})),a.d(e,"l",(function(){return E}));var i=a("bc3a"),l=a.n(i);function n(t={}){return l.a.get("/tenants",{params:t})}function r(t){return l.a.post("/tenants",t)}function s(t,e){return l.a.put("/tenants/"+t,e)}function o(t){return l.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return l.a.post(`/tenants/${t}/recharge`,e)}function d(t,e){return l.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function u(t,e={}){return l.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function m(t,e){return l.a.post(`/tenants/${t}/tenant-strategies`,e)}function p(t,e,a){return l.a.put(`/tenants/${t}/tenant-strategies/${e}`,a)}function f(t,e){return l.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function b(t,e){return l.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function _(t={}){return l.a.get("/users",{params:t})}function g(t){return l.a.get("/users/"+t)}function v(t,e){return l.a.post(`/users/${t}/recharge`,e)}function h(t,e={}){return l.a.get(`/users/${t}/team`,{params:e})}function y(t,e){return l.a.post(`/users/${t}/set-market-node`,e)}function w(t,e){return l.a.post(`/users/${t}/toggle-status`,{status:e})}function k(t={}){return l.a.get("/admins",{params:t})}function D(t){return l.a.post("/admins",t)}function F(t,e){return l.a.put("/admins/"+t,e)}function S(t){return l.a.patch(`/admins/${t}/toggle`)}function x(t,e){return l.a.post(`/admins/${t}/reset-password`,e)}function T(t={}){return l.a.get("/strategies",{params:t})}function $(t){return l.a.get("/strategies/"+t)}function U(t,e){return l.a.post("/strategies/"+t,e)}function z(t){return l.a.patch(`/strategies/${t}/toggle`)}function N(t={}){return l.a.get("/strategy-bindings-admin",{params:t})}function A(t,e){return l.a.put("/strategy-bindings-admin/"+t,e)}function O(t={}){return l.a.get("/exchange-accounts",{params:t})}function C(t,e){return l.a.put(`/exchange-accounts/${t}/assign-node`,e)}function B(t){return l.a.post("/exchange-accounts/batch-assign-node",t)}function E(t={}){return l.a.get("/signal-events",{params:t})}},c6e5:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body"},[a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:6,md:8,sm:12}},[a("stat-card",{attrs:{title:"策略总数",value:t.list.length,icon:"el-icon-s-opportunity",color:"primary",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:8,sm:12}},[a("stat-card",{attrs:{title:"已启用",value:t.activeCount,icon:"el-icon-circle-check",color:"success",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:8,sm:12}},[a("stat-card",{attrs:{title:"已禁用",value:t.list.length-t.activeCount,icon:"el-icon-remove-outline",color:"info",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:8,sm:12}},[a("stat-card",{attrs:{title:"交易所覆盖",value:t.exchangeCount,icon:"el-icon-connection",color:"warning",loading:t.loading}})],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{prop:"code",label:"编码",width:"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"name",label:"策略名称",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.showDetail(i)}}},[t._v(t._s(i.name))])]}}])}),a("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"160","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"symbol",label:"交易对",width:"100"}}),a("el-table-column",{attrs:{prop:"timeframe",label:"周期",width:"70",align:"center"}}),a("el-table-column",{attrs:{prop:"exchange",label:"交易所",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[i.exchange?a("el-tag",{attrs:{size:"mini"}},[t._v(t._s(i.exchange))]):a("span",[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"market_type",label:"市场",width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s("future"===i.market_type?"合约":"spot"===i.market_type?"现货":i.market_type||"-"))])]}}])}),a("el-table-column",{attrs:{prop:"min_capital",label:"最小资金",width:"90",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(null!=a.min_capital?a.min_capital:"-"))]}}])}),a("el-table-column",{attrs:{prop:"risk_level",label:"风险等级",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"本金(U)",width:"90",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.capital>0?a.capital:"-"))]}}])}),a("el-table-column",{attrs:{prop:"leverage",label:"杠杆",width:"65",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[i.leverage?a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v(t._s(i.leverage)+"x")]):a("span",[t._v("-")])]}}])}),a("el-table-column",{attrs:{label:"风险档位",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{size:"mini",type:3===i.risk_mode?"danger":2===i.risk_mode?"warning":"success"}},[t._v(" "+t._s({1:"稳健",2:"均衡",3:"激进"}[i.risk_mode]||"稳健")+" ")])]}}])}),a("el-table-column",{attrs:{label:"下单金额(U)",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.amount_usdt>0?a.amount_usdt:"-"))]}}])}),a("el-table-column",{attrs:{prop:"min_confidence",label:"置信度",width:"75",align:"center"}}),a("el-table-column",{attrs:{prop:"cooldown_minutes",label:"冷却(分)",width:"85",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"75",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-tag",{attrs:{type:1===i.status?"success":"info",size:"mini"}},[t._v(t._s(1===i.status?"启用":"禁用"))])]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"165"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.formatTime(a.created_at)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(e){return t.showDetail(i)}}},[t._v("详情")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.openEdit(i)}}},[t._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"text",icon:1===i.status?"el-icon-turn-off":"el-icon-open"},on:{click:function(e){return t.toggleStrategy(i)}}},[t._v(" "+t._s(1===i.status?"禁用":"启用")+" ")])]}}])})],1),t.loading||0!==t.list.length?t._e():a("el-empty",{attrs:{description:"暂无策略"}},[a("template",{slot:"description"},[a("p",[t._v("暂无策略")]),a("p",{staticClass:"empty-hint"},[t._v("若需初始化策略目录，请执行 "),a("code",[t._v("scripts/seed_dim_strategy.sql")]),t._v(" 或联系管理员导入 dim_strategy 数据。")])])],2)],1),a("el-dialog",{attrs:{title:"策略详情 - "+(t.detailData?t.detailData.name:""),visible:t.detailVisible,width:"720px",top:"5vh"},on:{"update:visible":function(e){t.detailVisible=e}}},[t.detailData?a("div",[a("el-descriptions",{attrs:{column:2,border:"",size:"small"}},[a("el-descriptions-item",{attrs:{label:"ID"}},[t._v(t._s(t.detailData.id))]),a("el-descriptions-item",{attrs:{label:"编码"}},[t._v(t._s(t.detailData.code||"-"))]),a("el-descriptions-item",{attrs:{label:"名称"}},[t._v(t._s(t.detailData.name))]),a("el-descriptions-item",{attrs:{label:"交易对"}},[t._v(t._s(t.detailData.symbol||"-"))]),a("el-descriptions-item",{attrs:{label:"交易对列表"}},[t._v(t._s(Array.isArray(t.detailData.symbols)?t.detailData.symbols.join(", "):"-"))]),a("el-descriptions-item",{attrs:{label:"周期"}},[t._v(t._s(t.detailData.timeframe||"-"))]),a("el-descriptions-item",{attrs:{label:"交易所"}},[t._v(t._s(t.detailData.exchange||"-"))]),a("el-descriptions-item",{attrs:{label:"市场类型"}},[t._v(t._s("future"===t.detailData.market_type?"合约":t.detailData.market_type||"-"))]),a("el-descriptions-item",{attrs:{label:"最小资金"}},[t._v(t._s(null!=t.detailData.min_capital?t.detailData.min_capital:"-")+" USDT")]),a("el-descriptions-item",{attrs:{label:"风险等级"}},[t._v(t._s(null!=t.detailData.risk_level?t.detailData.risk_level:"-"))]),a("el-descriptions-item",{attrs:{label:"本金"}},[t._v(t._s(t.detailData.capital>0?t.detailData.capital+" USDT":"-"))]),a("el-descriptions-item",{attrs:{label:"杠杆"}},[t._v(t._s(t.detailData.leverage?t.detailData.leverage+"x":"-"))]),a("el-descriptions-item",{attrs:{label:"风险档位"}},[a("el-tag",{attrs:{size:"small",type:3===t.detailData.risk_mode?"danger":2===t.detailData.risk_mode?"warning":"success"}},[t._v(" "+t._s({1:"稳健(1%)",2:"均衡(1.5%)",3:"激进(2%)"}[t.detailData.risk_mode]||"稳健(1%)")+" ")])],1),a("el-descriptions-item",{attrs:{label:"下单金额"}},[t._v(t._s(t.detailData.amount_usdt>0?t.detailData.amount_usdt+" USDT":"-")+" "),t.detailData.capital>0?a("span",{staticStyle:{color:"#909399","font-size":"12px"}},[t._v(" (自动计算)")]):t._e()]),a("el-descriptions-item",{attrs:{label:"最低置信度"}},[t._v(t._s(null!=t.detailData.min_confidence?t.detailData.min_confidence:"-"))]),a("el-descriptions-item",{attrs:{label:"冷却(分钟)"}},[t._v(t._s(null!=t.detailData.cooldown_minutes?t.detailData.cooldown_minutes:"-"))]),a("el-descriptions-item",{attrs:{label:"状态"}},[a("el-tag",{attrs:{type:1===t.detailData.status?"success":"info",size:"small"}},[t._v(t._s(1===t.detailData.status?"启用":"禁用"))])],1),a("el-descriptions-item",{attrs:{label:"创建时间"}},[t._v(t._s(t.formatTime(t.detailData.created_at)))]),a("el-descriptions-item",{attrs:{label:"描述",span:2}},[t._v(t._s(t.detailData.description||"-"))])],1),t.detailData.config&&Object.keys(t.detailData.config).length?a("div",{staticStyle:{"margin-top":"15px"}},[a("div",{staticStyle:{"font-weight":"600","margin-bottom":"8px"}},[t._v("策略配置:")]),a("pre",{staticClass:"config-json"},[t._v(t._s(JSON.stringify(t.detailData.config,null,2)))])]):t._e()],1):t._e()]),a("el-dialog",{attrs:{title:"编辑策略",visible:t.editVisible,width:"640px",top:"5vh"},on:{"update:visible":function(e){t.editVisible=e},close:function(e){t.editForm={}}}},[a("el-form",{ref:"editFormRef",attrs:{model:t.editForm,"label-width":"110px",size:"small"}},[a("el-form-item",{attrs:{label:"编码"}},[a("el-input",{attrs:{disabled:"",placeholder:"编码不可修改"},model:{value:t.editForm.code,callback:function(e){t.$set(t.editForm,"code",e)},expression:"editForm.code"}})],1),a("el-form-item",{attrs:{label:"策略名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"策略名称"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"描述"},model:{value:t.editForm.description,callback:function(e){t.$set(t.editForm,"description",e)},expression:"editForm.description"}})],1),a("el-form-item",{attrs:{label:"主交易对",prop:"symbol"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择主交易对",clearable:"",filterable:"","allow-create":""},model:{value:t.editForm.symbol,callback:function(e){t.$set(t.editForm,"symbol",e)},expression:"editForm.symbol"}},t._l(t.symbolOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1),a("div",{staticClass:"form-tip"},[t._v("统一规范格式，Binance/OKX/Gate.io/Bybit 均会自动识别（如 BTCUSDT、BTC-USDT、BTC_USDT 等）")])],1),a("el-form-item",{attrs:{label:"交易对列表",prop:"symbols"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"可多选，为空则用主交易对",clearable:""},model:{value:t.editForm.symbols,callback:function(e){t.$set(t.editForm,"symbols",e)},expression:"editForm.symbols"}},t._l(t.symbolOptions,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"周期",prop:"timeframe"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择K线周期",clearable:""},model:{value:t.editForm.timeframe,callback:function(e){t.$set(t.editForm,"timeframe",e)},expression:"editForm.timeframe"}},[a("el-option",{attrs:{label:"1 分钟",value:"1m"}}),a("el-option",{attrs:{label:"5 分钟",value:"5m"}}),a("el-option",{attrs:{label:"15 分钟",value:"15m"}}),a("el-option",{attrs:{label:"30 分钟",value:"30m"}}),a("el-option",{attrs:{label:"1 小时",value:"1h"}}),a("el-option",{attrs:{label:"2 小时",value:"2h"}}),a("el-option",{attrs:{label:"4 小时",value:"4h"}}),a("el-option",{attrs:{label:"8 小时",value:"8h"}}),a("el-option",{attrs:{label:"1 天",value:"1d"}})],1)],1),a("el-form-item",{attrs:{label:"交易所",prop:"exchange"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选填，空则跟随账户",clearable:""},model:{value:t.editForm.exchange,callback:function(e){t.$set(t.editForm,"exchange",e)},expression:"editForm.exchange"}},[a("el-option",{attrs:{label:"Binance",value:"binance"}}),a("el-option",{attrs:{label:"OKX",value:"okx"}}),a("el-option",{attrs:{label:"Gate.io",value:"gateio"}}),a("el-option",{attrs:{label:"Bybit",value:"bybit"}})],1)],1),a("el-form-item",{attrs:{label:"市场类型",prop:"market_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"市场类型"},model:{value:t.editForm.market_type,callback:function(e){t.$set(t.editForm,"market_type",e)},expression:"editForm.market_type"}},[a("el-option",{attrs:{label:"合约",value:"future"}}),a("el-option",{attrs:{label:"现货",value:"spot"}})],1)],1),a("el-row",{attrs:{gutter:16}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"最小资金",prop:"min_capital"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2},model:{value:t.editForm.min_capital,callback:function(e){t.$set(t.editForm,"min_capital",e)},expression:"editForm.min_capital"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"风险等级",prop:"risk_level"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:5},model:{value:t.editForm.risk_level,callback:function(e){t.$set(t.editForm,"risk_level",e)},expression:"editForm.risk_level"}})],1)],1)],1),a("el-row",{attrs:{gutter:16}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"本金(USDT)",prop:"capital"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2},model:{value:t.editForm.capital,callback:function(e){t.$set(t.editForm,"capital",e)},expression:"editForm.capital"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"杠杆",prop:"leverage"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"杠杆倍数"},model:{value:t.editForm.leverage,callback:function(e){t.$set(t.editForm,"leverage",e)},expression:"editForm.leverage"}},[a("el-option",{attrs:{label:"5x",value:5}}),a("el-option",{attrs:{label:"10x",value:10}}),a("el-option",{attrs:{label:"20x",value:20}}),a("el-option",{attrs:{label:"50x",value:50}}),a("el-option",{attrs:{label:"75x",value:75}}),a("el-option",{attrs:{label:"100x",value:100}})],1)],1)],1)],1),a("el-row",{attrs:{gutter:16}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"风险档位",prop:"risk_mode"}},[a("el-radio-group",{model:{value:t.editForm.risk_mode,callback:function(e){t.$set(t.editForm,"risk_mode",e)},expression:"editForm.risk_mode"}},[a("el-radio-button",{attrs:{label:1}},[t._v("稳健(1%)")]),a("el-radio-button",{attrs:{label:2}},[t._v("均衡(1.5%)")]),a("el-radio-button",{attrs:{label:3}},[t._v("激进(2%)")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"下单金额(U)"}},[a("div",{staticStyle:{"line-height":"32px"}},[a("span",{staticStyle:{"font-size":"16px","font-weight":"600",color:"#409EFF"}},[t._v(t._s(t.calcAmountUsdt))]),a("span",{staticStyle:{color:"#909399","font-size":"12px","margin-left":"4px"}},[t._v("USDT (自动计算)")])]),a("div",{staticStyle:{color:"#909399","font-size":"12px"}},[t._v("= 本金 × "+t._s({1:"1%",2:"1.5%",3:"2%"}[t.editForm.risk_mode]||"1%")+" × "+t._s(t.editForm.leverage||0)+"x")])])],1)],1),a("el-row",{attrs:{gutter:16}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"最低置信度",prop:"min_confidence"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:100},model:{value:t.editForm.min_confidence,callback:function(e){t.$set(t.editForm,"min_confidence",e)},expression:"editForm.min_confidence"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"冷却(分钟)",prop:"cooldown_minutes"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.editForm.cooldown_minutes,callback:function(e){t.$set(t.editForm,"cooldown_minutes",e)},expression:"editForm.cooldown_minutes"}})],1)],1)],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.editForm.status,callback:function(e){t.$set(t.editForm,"status",e)},expression:"editForm.status"}},[a("el-radio",{attrs:{label:1}},[t._v("启用")]),a("el-radio",{attrs:{label:0}},[t._v("禁用")])],1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.editVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:t.editSaving},on:{click:t.saveEdit}},[t._v("保存")])],1)],1)],1)},l=[],n=(a("e9c4"),a("0643"),a("2382"),a("a573"),a("50fc")),r={name:"StrategyList",data(){return{loading:!1,list:[],detailVisible:!1,detailData:null,editVisible:!1,editForm:{},editSaving:!1,symbolOptions:["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","DOGEUSDT","ADAUSDT","AVAXUSDT","LINKUSDT","DOTUSDT","MATICUSDT","LTCUSDT","UNIUSDT","ATOMUSDT","ETCUSDT","XLMUSDT","NEARUSDT","APTUSDT","ARBUSDT","OPUSDT","INJUSDT","SUIUSDT"]}},computed:{activeCount(){return this.list.filter(t=>1===t.status).length},exchangeCount(){return new Set(this.list.map(t=>t.exchange).filter(Boolean)).size},calcAmountUsdt(){const t=Number(this.editForm.capital)||0,e=Number(this.editForm.leverage)||20,a=Number(this.editForm.risk_mode)||1,i={1:.01,2:.015,3:.02}[a]||.01;return t<=0?0:(t*i*e).toFixed(2)}},mounted(){this.fetchData()},methods:{formatTime(t){return t?t.replace("T"," ").substring(0,19):"-"},showDetail(t){this.detailData=t,this.detailVisible=!0},openEdit(t){const e=t.symbols,a=Array.isArray(e)?[...e]:t.symbol?[t.symbol]:[];this.editForm={id:t.id,code:t.code,name:t.name,description:t.description||"",symbol:t.symbol||"",symbols:a,timeframe:t.timeframe||"",exchange:t.exchange||"",market_type:t.market_type||"future",min_capital:null!=t.min_capital?Number(t.min_capital):200,risk_level:null!=t.risk_level?Number(t.risk_level):1,capital:null!=t.capital?Number(t.capital):0,leverage:null!=t.leverage?Number(t.leverage):20,risk_mode:null!=t.risk_mode?Number(t.risk_mode):1,min_confidence:null!=t.min_confidence?Number(t.min_confidence):50,cooldown_minutes:null!=t.cooldown_minutes?Number(t.cooldown_minutes):60,status:null!=t.status?Number(t.status):1},this.editVisible=!0},async saveEdit(){const t=this.editForm.id,e=this.editForm.symbols&&this.editForm.symbols.length?this.editForm.symbols:null,a={name:this.editForm.name,description:this.editForm.description||null,symbol:this.editForm.symbol||null,symbols:e,timeframe:this.editForm.timeframe||null,exchange:this.editForm.exchange||null,market_type:this.editForm.market_type||null,min_capital:this.editForm.min_capital,risk_level:this.editForm.risk_level,capital:this.editForm.capital||0,leverage:this.editForm.leverage||20,risk_mode:this.editForm.risk_mode||1,min_confidence:this.editForm.min_confidence,cooldown_minutes:this.editForm.cooldown_minutes,status:this.editForm.status};this.editSaving=!0;try{await Object(n["D"])(t,a),this.$message.success("保存成功"),this.editVisible=!1,this.fetchData()}catch(i){const t=i.response&&i.response.data&&(i.response.data.detail||i.response.data.message)||i.message||"保存失败";this.$message.error("string"===typeof t?t:JSON.stringify(t))}finally{this.editSaving=!1}},async toggleStrategy(t){const e=1===t.status?"禁用":"启用";try{await this.$confirm(`确定要${e}策略「${t.name}」吗？`,"提示",{type:"warning"})}catch{return}try{await Object(n["y"])(t.id),this.$message.success(e+"成功"),this.fetchData()}catch(a){const t=a.response&&a.response.data&&(a.response.data.detail||a.response.data.message)||a.message||e+"失败";this.$message.error("string"===typeof t?t:JSON.stringify(t))}},async fetchData(){this.loading=!0;try{const t=await Object(n["m"])(),e=t.data||{};let a=e.data;null==a&&Array.isArray(e)&&(a=e),this.list=Array.isArray(a)?a:[]}catch(t){const e=t.response&&t.response.data&&(t.response.data.detail||t.response.data.message)||t.message||"获取策略列表失败";this.$message.error("string"===typeof e?e:JSON.stringify(e))}finally{this.loading=!1}}}},s=r,o=(a("3e47"),a("2877")),c=Object(o["a"])(s,i,l,!1,null,"db0a59bc",null);e["default"]=c.exports}}]);