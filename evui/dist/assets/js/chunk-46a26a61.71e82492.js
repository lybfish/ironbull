(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46a26a61"],{"41cb":function(t,e,a){},"50fc":function(t,e,a){"use strict";a.d(e,"v",(function(){return r})),a.d(e,"h",(function(){return s})),a.d(e,"K",(function(){return o})),a.d(e,"F",(function(){return l})),a.d(e,"z",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"u",(function(){return u})),a.d(e,"i",(function(){return p})),a.d(e,"L",(function(){return g})),a.d(e,"d",(function(){return h})),a.d(e,"l",(function(){return v})),a.d(e,"y",(function(){return f})),a.d(e,"w",(function(){return m})),a.d(e,"A",(function(){return y})),a.d(e,"x",(function(){return _})),a.d(e,"C",(function(){return b})),a.d(e,"G",(function(){return w})),a.d(e,"m",(function(){return C})),a.d(e,"e",(function(){return x})),a.d(e,"H",(function(){return S})),a.d(e,"D",(function(){return k})),a.d(e,"B",(function(){return I})),a.d(e,"s",(function(){return O})),a.d(e,"t",(function(){return D})),a.d(e,"g",(function(){return P})),a.d(e,"J",(function(){return z})),a.d(e,"k",(function(){return R})),a.d(e,"E",(function(){return G})),a.d(e,"o",(function(){return L})),a.d(e,"n",(function(){return j})),a.d(e,"f",(function(){return A})),a.d(e,"I",(function(){return T})),a.d(e,"j",(function(){return M})),a.d(e,"p",(function(){return B})),a.d(e,"a",(function(){return E})),a.d(e,"c",(function(){return W})),a.d(e,"q",(function(){return F})),a.d(e,"r",(function(){return $}));var n=a("bc3a"),i=a.n(n);function r(t={}){return i.a.get("/tenants",{params:t})}function s(t){return i.a.post("/tenants",t)}function o(t,e){return i.a.put("/tenants/"+t,e)}function l(t){return i.a.patch(`/tenants/${t}/toggle`)}function c(t,e){return i.a.post(`/tenants/${t}/recharge`,e)}function d(t,e){return i.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function u(t,e={}){return i.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function p(t,e){return i.a.post(`/tenants/${t}/tenant-strategies`,e)}function g(t,e,a){return i.a.put(`/tenants/${t}/tenant-strategies/${e}`,a)}function h(t,e){return i.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function v(t,e){return i.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function f(t={}){return i.a.get("/users",{params:t})}function m(t){return i.a.get("/users/"+t)}function y(t,e){return i.a.post(`/users/${t}/recharge`,e)}function _(t,e={}){return i.a.get(`/users/${t}/team`,{params:e})}function b(t,e){return i.a.post(`/users/${t}/set-market-node`,e)}function w(t,e){return i.a.post(`/users/${t}/toggle-status`,{status:e})}function C(t={}){return i.a.get("/admins",{params:t})}function x(t){return i.a.post("/admins",t)}function S(t,e){return i.a.put("/admins/"+t,e)}function k(t){return i.a.patch(`/admins/${t}/toggle`)}function I(t,e){return i.a.post(`/admins/${t}/reset-password`,e)}function O(t={}){return i.a.get("/strategies",{params:t})}function D(t){return i.a.get("/strategies/"+t)}function P(t){return i.a.post("/strategies",t)}function z(t,e){return i.a.post("/strategies/"+t,e)}function R(t){return i.a.delete("/strategies/"+t)}function G(t){return i.a.patch(`/strategies/${t}/toggle`)}function L(t={}){return i.a.get("/strategy-bindings-admin",{params:t})}function j(){return i.a.get("/strategy-bindings-admin/form-options")}function A(t){return i.a.post("/strategy-bindings-admin",t)}function T(t,e){return i.a.put("/strategy-bindings-admin/"+t,e)}function M(t){return i.a.delete("/strategy-bindings-admin/"+t)}function B(t={}){return i.a.get("/exchange-accounts",{params:t})}function E(t,e){return i.a.put(`/exchange-accounts/${t}/assign-node`,e)}function W(t){return i.a.post("/exchange-accounts/batch-assign-node",t)}function F(t={}){return i.a.get("/signal-events",{params:t})}function $(){return i.a.get("/signal-events/strategies")}},8012:function(t,e,a){"use strict";a.d(e,"e",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"h",(function(){return c})),a.d(e,"c",(function(){return d})),a.d(e,"i",(function(){return u})),a.d(e,"j",(function(){return p})),a.d(e,"b",(function(){return g})),a.d(e,"g",(function(){return h})),a.d(e,"f",(function(){return v})),a.d(e,"a",(function(){return f}));var n=a("bc3a"),i=a.n(n);let r={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function s(t){return{...r,...t}}function o(t={}){return i.a.get("/orders",{params:s({limit:50,...t})})}function l(t={}){return i.a.get("/fills",{params:s({limit:50,...t})})}function c(t={}){return i.a.get("/positions",{params:s({limit:100,...t})})}function d(t={}){return i.a.get("/accounts",{params:s({limit:50,...t})})}function u(t={}){return i.a.get("/transactions",{params:s({limit:50,...t})})}function p(t){return i.a.post("/manual-order",t)}function g(t){return i.a.post("/close-position",t)}function h(t={}){return i.a.get("/pending-limit-orders",{params:s(t)})}function v(t={}){return i.a.get("/pending-limit-orders/stats",{params:s(t)})}function f(t){return i.a.post(`/pending-limit-orders/${t}/cancel`)}},8697:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ele-body ele-body-card"},[a("el-card",{attrs:{shadow:"never","body-style":"padding: 20px;"}},[a("div",{staticClass:"ele-cell workplace-user-card"},[a("div",{staticClass:"ele-cell-content ele-cell"},[a("el-avatar",{attrs:{size:68,src:t.loginUser.avatar||t.defaultAvatar}}),a("div",{staticClass:"ele-cell-content"},[a("h4",{staticClass:"ele-elip"},[t._v("你好，【"+t._s(t.loginUser.nickname||"Admin")+"】，欢迎使用 Aigo 管理后台！")]),a("div",{staticClass:"ele-text-secondary ele-elip",staticStyle:{"margin-top":"8px"}},[a("i",{staticClass:"el-icon-sunny"}),a("span",[t._v("祝您交易顺利，收益满满!")])])])],1),a("div",{staticClass:"workplace-count-group"},[a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:"primary",size:"small"}},[a("i",{staticClass:"el-icon-wallet"})]),a("span",{staticClass:"workplace-count-name"},[t._v("总余额")])],1),a("div",{staticClass:"workplace-count-num"},[t._v("$"+t._s(t.formatMoney(t.tenant.equity)))])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:t.tenant.dailyPnl>=0?"success":"danger",size:"small"}},[a("i",{staticClass:"el-icon-s-data"})]),a("span",{staticClass:"workplace-count-name"},[t._v("日收益")])],1),a("div",{staticClass:"workplace-count-num",class:t.tenant.dailyPnl>=0?"text-success":"text-danger"},[t._v(" $"+t._s(t.formatMoney(t.tenant.dailyPnl))+" ")])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{type:"warning",size:"small"}},[a("i",{staticClass:"el-icon-s-order"})]),a("span",{staticClass:"workplace-count-name"},[t._v("持仓数")])],1),a("div",{staticClass:"workplace-count-num"},[t._v(t._s(t.tenant.positions||0))])]),a("div",{staticClass:"workplace-count-item"},[a("div",{staticClass:"workplace-count-header"},[a("el-tag",{staticClass:"ele-tag-round",attrs:{size:"small"}},[a("i",{staticClass:"el-icon-s-operation"})]),a("span",{staticClass:"workplace-count-name"},[t._v("活跃策略")])],1),a("div",{staticClass:"workplace-count-num"},[t._v(t._s(t.platform.active_bindings||0))])])])])]),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"租户总数",value:t.platform.total_tenants,icon:"el-icon-s-custom",color:"primary","help-text":"平台注册租户数量",loading:t.loading},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"ele-text-secondary"},[t._v("活跃 "+t._s(t.platform.active_tenants))])]},proxy:!0}])})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"用户总数",value:t.platform.total_users,icon:"el-icon-user",color:"success","help-text":"平台注册用户总数",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"订单总数",value:t.platform.total_orders,icon:"el-icon-document",color:"warning","help-text":"平台累计订单数量",loading:t.loading}})],1),a("el-col",{attrs:{lg:6,md:12,sm:12}},[a("stat-card",{attrs:{title:"执行节点",value:t.platform.total_nodes,icon:"el-icon-s-platform",color:"info","help-text":"已注册的执行节点",loading:t.loading},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"ele-text-secondary"},[t._v("在线 "+t._s(t.platform.online_nodes))])]},proxy:!0}])})],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:16,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("绩效摘要")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),a("el-row",{attrs:{gutter:20}},t._l(t.perfItems,(function(e){return a("el-col",{key:e.label,staticClass:"perf-item",attrs:{span:4}},[a("div",{staticClass:"perf-label"},[t._v(t._s(e.label))]),a("div",{staticClass:"perf-value",class:e.cls||""},[t._v(t._s(e.value))])])})),1)],1)],1),a("el-col",{attrs:{lg:8,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("系统状态")]),a("el-tag",{attrs:{type:t.systemHealthy?"success":"danger",size:"small"}},[t._v(" "+t._s(t.systemHealthy?"正常":"异常")+" ")])],1),a("div",{staticClass:"system-status-grid"},[a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("data-api")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.data_api?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.data_api?"在线":"离线")+" ")])],1)]),a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("signal-monitor")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.signal_monitor?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.signal_monitor?"在线":"离线")+" ")])],1)]),a("div",{staticClass:"status-item"},[a("div",{staticClass:"status-label"},[t._v("数据库")]),a("div",{staticClass:"status-value"},[a("el-tag",{attrs:{type:t.services.database?"success":"danger",size:"mini"}},[t._v(" "+t._s(t.services.database?"正常":"异常")+" ")])],1)])]),a("div",{staticStyle:{"text-align":"center","margin-top":"15px"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v(" 刷新数据 ")])],1)])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日订单量")]),a("el-radio-group",{attrs:{size:"mini"},on:{change:t.fetchTrends},model:{value:t.trendDays,callback:function(e){t.trendDays=e},expression:"trendDays"}},[a("el-radio-button",{attrs:{label:7}},[t._v("7天")]),a("el-radio-button",{attrs:{label:30}},[t._v("30天")]),a("el-radio-button",{attrs:{label:60}},[t._v("60天")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartOrders",staticStyle:{height:"260px"}})])],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日新增用户")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartUsers",staticStyle:{height:"260px"}})])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日成交额 (USDT)")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartVolume",staticStyle:{height:"260px"}})])],1),a("el-col",{attrs:{lg:12,md:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("每日利润池入池 (USDT)")])]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],ref:"chartPool",staticStyle:{height:"260px"}})])],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/orders"}},[a("i",{staticClass:"app-link-icon el-icon-s-order"}),a("div",{staticClass:"app-link-title"},[t._v("订单管理")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/positions"}},[a("i",{staticClass:"app-link-icon el-icon-s-data",staticStyle:{color:"#95de64"}}),a("div",{staticClass:"app-link-title"},[t._v("当前持仓")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/strategy/list"}},[a("i",{staticClass:"app-link-icon el-icon-s-opportunity",staticStyle:{color:"#ff9c6e"}}),a("div",{staticClass:"app-link-title"},[t._v("策略目录")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/monitor/signal-control"}},[a("i",{staticClass:"app-link-icon el-icon-connection",staticStyle:{color:"#b37feb"}}),a("div",{staticClass:"app-link-title"},[t._v("信号监控")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/system/tenants"}},[a("i",{staticClass:"app-link-icon el-icon-s-custom",staticStyle:{color:"#ffd666"}}),a("div",{staticClass:"app-link-title"},[t._v("租户管理")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/user/exchange-accounts"}},[a("i",{staticClass:"app-link-icon el-icon-wallet",staticStyle:{color:"#5cdbd3"}}),a("div",{staticClass:"app-link-title"},[t._v("交易账户")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/monitor/nodes"}},[a("i",{staticClass:"app-link-icon el-icon-s-platform",staticStyle:{color:"#ff85c0"}}),a("div",{staticClass:"app-link-title"},[t._v("执行节点")])])],1)],1),a("el-col",{attrs:{lg:3,md:6,sm:6,xs:12}},[a("el-card",{attrs:{shadow:"hover","body-style":"padding: 0;"}},[a("router-link",{staticClass:"app-link-block",attrs:{to:"/trading/analytics"}},[a("i",{staticClass:"app-link-icon el-icon-data-analysis",staticStyle:{color:"#ffc069"}}),a("div",{staticClass:"app-link-title"},[t._v("绩效分析")])])],1)],1)],1),a("el-row",{staticStyle:{"margin-bottom":"15px"},attrs:{gutter:15}},[a("el-col",{attrs:{span:24}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("近期信号")]),a("router-link",{attrs:{to:"/strategy/signal-history"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看全部")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.recentSignals,stripe:"",size:"mini","header-cell-style":{background:"#fafafa"}}},[a("el-table-column",{attrs:{prop:"signal_id",label:"信号ID",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticStyle:{"font-family":"monospace","font-size":"12px"}},[t._v(t._s((n.signal_id||"").slice(0,16)))])]}}])}),a("el-table-column",{attrs:{prop:"event_type",label:"事件",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:t.signalTagType(n.event_type),size:"mini"}},[t._v(t._s(n.event_type))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-tag",{attrs:{type:"SUCCESS"===n.status?"success":"FAILED"===n.status?"danger":"warning",size:"mini"}},[t._v(" "+t._s(n.status)+" ")])]}}])}),a("el-table-column",{attrs:{label:"详情","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticStyle:{"font-size":"12px",color:"#606266"}},[t._v(t._s(t.signalDetail(n)))])]}}])}),a("el-table-column",{attrs:{prop:"created_at",label:"时间",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(n.created_at||"-"))])]}}])})],1),t.loading||0!==t.recentSignals.length?t._e():a("el-empty",{attrs:{description:"暂无信号记录","image-size":60}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("账户资产")]),a("router-link",{attrs:{to:"/trading/accounts"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("详情")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("当前权益")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.formatMoney(t.tenant.equity))+" USDT")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("累计收益率")]),a("div",{staticClass:"trade-overview-value",class:t.tenant.totalReturn>=0?"text-success":"text-danger"},[t._v(" "+t._s(t.fmtPct(t.tenant.totalReturn))+" ")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("最大回撤")]),a("div",{staticClass:"trade-overview-value text-danger"},[t._v(t._s(t.fmtPct(t.tenant.maxDrawdown)))])])])],1),a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("持仓概览")]),a("router-link",{attrs:{to:"/trading/positions"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("管理")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("活跃持仓")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.positions||0)+" 个")])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("总订单数")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.orders||0))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("胜率")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.fmtPct(t.tenant.winRate,1)))])])])],1),a("el-col",{attrs:{lg:8,md:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"card-header-flex",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("风险指标")]),a("router-link",{attrs:{to:"/trading/analytics"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看")])],1)],1),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("夏普比率")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(null!==t.tenant.sharpeRatio&&void 0!==t.tenant.sharpeRatio?t.tenant.sharpeRatio.toFixed(2):"-"))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("总交易次数")]),a("div",{staticClass:"trade-overview-value"},[t._v(t._s(t.tenant.totalTrades||"-"))])]),a("div",{staticClass:"trade-overview-item"},[a("div",{staticClass:"trade-overview-label"},[t._v("日收益")]),a("div",{staticClass:"trade-overview-value",class:t.tenant.dailyPnl>=0?"text-success":"text-danger"},[t._v(" "+t._s(null!==t.tenant.dailyPnl&&void 0!==t.tenant.dailyPnl?t.tenant.dailyPnl.toFixed(2):"-")+" ")])])])],1)],1)],1)},i=[],r=(a("0643"),a("fffc"),a("4e3e"),a("a573"),a("de2b")),s=a("8012"),o=a("7cf8"),l=a("50fc"),c=a("22b4"),d=a("1be7"),u=a("3620"),p=a("4cb5"),g=a("4b2a"),h=a("2da7"),v=a("ff32"),f=a("f95e");c["a"]([u["a"],p["a"],g["a"],h["a"],v["a"],f["a"]]);var m={name:"Workplace",data(){return{loading:!0,trendLoading:!1,trendDays:30,defaultAvatar:a("cf05"),platform:{total_tenants:0,active_tenants:0,total_users:0,total_orders:0,total_nodes:0,online_nodes:0,active_bindings:0},tenant:{orders:0,positions:0,equity:null,totalReturn:null,dailyPnl:null,maxDrawdown:null,sharpeRatio:null,totalTrades:null,winRate:null},services:{data_api:!1,signal_monitor:!1,database:!1},recentSignals:[],chartInstances:{}}},computed:{loginUser(){return this.$store.state.user.user||{}},systemHealthy(){return this.services.data_api&&this.services.database&&this.services.signal_monitor},perfItems(){return[{label:"累计收益率",value:this.fmtPct(this.tenant.totalReturn),cls:this.tenant.totalReturn>=0?"text-success":"text-danger"},{label:"日收益",value:null!==this.tenant.dailyPnl&&void 0!==this.tenant.dailyPnl?this.tenant.dailyPnl.toFixed(2):"-",cls:this.tenant.dailyPnl>=0?"text-success":"text-danger"},{label:"最大回撤",value:this.fmtPct(this.tenant.maxDrawdown),cls:"text-danger"},{label:"夏普比率",value:null!==this.tenant.sharpeRatio&&void 0!==this.tenant.sharpeRatio?this.tenant.sharpeRatio.toFixed(2):"-"},{label:"总交易",value:this.tenant.totalTrades||"-"},{label:"胜率",value:this.fmtPct(this.tenant.winRate,1)}]}},mounted(){this.fetchData(),this.fetchTrends(),this.resizeHandler=()=>{Object.values(this.chartInstances).forEach(t=>t&&t.resize())},window.addEventListener("resize",this.resizeHandler)},beforeDestroy(){window.removeEventListener("resize",this.resizeHandler),Object.values(this.chartInstances).forEach(t=>t&&t.dispose())},methods:{formatMoney(t){return null===t||void 0===t?"0.00":parseFloat(t||0).toFixed(2)},fmtPct(t,e){return null===t||void 0===t?"-":(100*t).toFixed(e||2)+"%"},signalTagType(t){const e={CREATED:"",DISPATCHED:"warning",EXECUTED:"success",FAILED:"danger"};return e[(t||"").toUpperCase()]||"info"},signalDetail(t){try{const e="string"===typeof t.detail?JSON.parse(t.detail):t.detail||{},a=[];return e.strategy&&a.push(e.strategy),e.symbol&&a.push(e.symbol),e.side&&a.push(e.side),t.source&&a.push(t.source),a.join(" · ")||t.detail||"-"}catch(e){return t.detail||"-"}},async fetchData(){this.loading=!0;try{const[t,e,a,n,i,c]=await Promise.allSettled([Object(r["a"])(),Object(s["e"])({limit:1}),Object(s["h"])({limit:1}),Object(r["c"])().catch(()=>null),Object(o["g"])().catch(()=>null),Object(l["q"])({page_size:8}).catch(()=>null)]);if("fulfilled"===t.status&&t.value&&t.value.data){const e=t.value.data.data||t.value.data;Object.assign(this.platform,e)}if("fulfilled"===e.status&&e.value&&(this.tenant.orders=e.value.data.total||0),"fulfilled"===a.status&&a.value&&(this.tenant.positions=a.value.data.total||0),"fulfilled"===n.status&&n.value&&n.value.data){const t=n.value.data.data?n.value.data.data.summary:null;t&&(this.tenant.equity=t.current_equity,this.tenant.totalReturn=t.total_return,this.tenant.dailyPnl=t.daily_pnl,this.tenant.maxDrawdown=t.max_drawdown,this.tenant.sharpeRatio=t.sharpe_ratio,this.tenant.totalTrades=t.total_trades,this.tenant.winRate=t.win_rate)}if("fulfilled"===i.status&&i.value&&i.value.data){const t=i.value.data.data||i.value.data,e=t.services||[],a=t=>{const a=e.find(e=>e.name===t);return!!a&&!!a.healthy};this.services={data_api:a("data-api"),signal_monitor:a("signal-monitor"),database:!(!t.db||!t.db.mysql_ok)}}if("fulfilled"===c.status&&c.value&&c.value.data){const t=c.value.data;this.recentSignals=(t.data||t.events||[]).slice(0,8)}}catch(t){console.error(t)}finally{this.loading=!1}},async fetchTrends(){this.trendLoading=!0;try{const t=await Object(r["b"])(this.trendDays),e=t.data&&t.data.data||t.data||{};this.$nextTick(()=>{this.renderBarChart("chartOrders",e.dates||[],e.orders||[],"订单量","#409EFF"),this.renderLineChart("chartUsers",e.dates||[],e.new_users||[],"新增用户","#67C23A"),this.renderAreaChart("chartVolume",e.dates||[],e.trade_volume||[],"成交额","#E6A23C"),this.renderAreaChart("chartPool",e.dates||[],e.pool_amount||[],"入池金额","#F56C6C")})}catch(t){console.error("trends error",t)}finally{this.trendLoading=!1}},getChartInstance(t){if(this.chartInstances[t])return this.chartInstances[t];const e=this.$refs[t];if(!e)return null;const a=d["b"](e);return this.chartInstances[t]=a,a},buildBaseOption(t){return{tooltip:{trigger:"axis"},grid:{left:50,right:20,top:20,bottom:30},xAxis:{type:"category",data:t.map(t=>t.slice(5)),axisLabel:{fontSize:11,color:"#909399"},axisLine:{lineStyle:{color:"#E4E7ED"}}},yAxis:{type:"value",splitLine:{lineStyle:{color:"#F2F6FC"}},axisLabel:{fontSize:11,color:"#909399"}}}},renderBarChart(t,e,a,n,i){const r=this.getChartInstance(t);if(!r)return;const s=this.buildBaseOption(e);s.series=[{name:n,type:"bar",data:a,itemStyle:{color:i,borderRadius:[3,3,0,0]},barMaxWidth:20}],r.setOption(s,!0)},renderLineChart(t,e,a,n,i){const r=this.getChartInstance(t);if(!r)return;const s=this.buildBaseOption(e);s.series=[{name:n,type:"line",data:a,smooth:!0,symbol:"circle",symbolSize:5,lineStyle:{color:i,width:2},itemStyle:{color:i}}],r.setOption(s,!0)},renderAreaChart(t,e,a,n,i){const r=this.getChartInstance(t);if(!r)return;const s=this.buildBaseOption(e);s.series=[{name:n,type:"line",data:a,smooth:!0,symbol:"none",lineStyle:{color:i,width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:i+"40"},{offset:1,color:i+"05"}]}}}],r.setOption(s,!0)}}},y=m,_=(a("8b21"),a("2877")),b=Object(_["a"])(y,n,i,!1,null,"551da562",null);e["default"]=b.exports},"8b21":function(t,e,a){"use strict";a("41cb")},de2b:function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"d",(function(){return c})),a.d(e,"e",(function(){return d}));var n=a("bc3a"),i=a.n(n);let r={tenant_id:parseInt(localStorage.getItem("ironbull_tenant_id"))||1};function s(){return i.a.get("/dashboard/summary")}function o(t=30){return i.a.get("/dashboard/trends",{params:{days:t}})}function l(t={}){return i.a.get("/analytics/performance",{params:{...r,...t}})}function c(t={}){return i.a.get("/analytics/risk",{params:{...r,...t}})}function d(t={}){return i.a.get("/analytics/statistics",{params:{...r,limit:20,...t}})}},ff32:function(t,e,a){"use strict";a.d(e,"a",(function(){return Z}));var n=a("22b4"),i=a("9ab4"),r=a("6d8b"),s=a("4319"),o=a("e0d3"),l=a("6cb7"),c=function(t,e){return"all"===e?{type:"all",title:t.getLocale(["legend","selector","all"])}:"inverse"===e?{type:"inverse",title:t.getLocale(["legend","selector","inverse"])}:void 0},d=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.layoutMode={type:"box",ignoreSize:!0},a}return Object(i["b"])(e,t),e.prototype.init=function(t,e,a){this.mergeDefaultAndTheme(t,a),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(e,a){t.prototype.mergeOption.call(this,e,a),this._updateSelector(e)},e.prototype._updateSelector=function(t){var e=t.selector,a=this.ecModel;!0===e&&(e=t.selector=["all","inverse"]),r["r"](e)&&r["j"](e,(function(t,n){r["z"](t)&&(t={type:t}),e[n]=r["F"](t,c(a,t.type))}))},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,a=0;a<t.length;a++){var n=t[a].get("name");if(this.isSelected(n)){this.select(n),e=!0;break}}!e&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var e=[],a=[];t.eachRawSeries((function(n){var i,r=n.name;if(a.push(r),n.legendVisualProvider){var s=n.legendVisualProvider,l=s.getAllNames();t.isSeriesFiltered(n)||(a=a.concat(l)),l.length?e=e.concat(l):i=!0}else i=!0;i&&Object(o["l"])(n)&&e.push(n.name)})),this._availableNames=a;var n=this.get("data")||e,i=r["E"](n,(function(t){return"string"!==typeof t&&"number"!==typeof t||(t={name:t}),new s["a"](t,this,this.ecModel)}),this);this._data=i},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var e=this.option.selected,a=this.get("selectedMode");if("single"===a){var n=this._data;r["j"](n,(function(t){e[t.get("name")]=!1}))}e[t]=!0},e.prototype.unSelect=function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,e=this.option.selected;r["j"](t,(function(t){e[t.get("name",!0)]=!0}))},e.prototype.inverseSelect=function(){var t=this._data,e=this.option.selected;r["j"](t,(function(t){var a=t.get("name",!0);e.hasOwnProperty(a)||(e[a]=!0),e[a]=!e[a]}))},e.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&r["p"](this._availableNames,t)>=0},e.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",decal:"inherit",shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit",shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(l["a"]),u=d,p=a("41ef"),g=a("2dc5"),h=a("76a5"),v=a("c7a2"),f=a("2306"),m=a("7d6c"),y=a("7837"),_=a("f934"),b=a("eda2");function w(t,e){var a=b["g"](e.get("padding")),n=e.getItemStyle(["color","opacity"]);return n.fill=e.get("backgroundColor"),t=new v["a"]({shape:{x:t.x-a[3],y:t.y-a[0],width:t.width+a[1]+a[3],height:t.height+a[0]+a[2],r:e.get("borderRadius")},style:n,silent:!0,z2:-1}),t}var C=a("b12f"),x=a("3901"),S=a("551f"),k=a("a15a"),I=r["h"],O=r["j"],D=g["a"],P=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.newlineDisabled=!1,a}return Object(i["b"])(e,t),e.prototype.init=function(){this.group.add(this._contentGroup=new D),this.group.add(this._selectorGroup=new D),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,e,a){var n=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var i=t.get("align"),s=t.get("orient");i&&"auto"!==i||(i="right"===t.get("left")&&"vertical"===s?"right":"left");var o=t.get("selector",!0),l=t.get("selectorPosition",!0);!o||l&&"auto"!==l||(l="horizontal"===s?"end":"start"),this.renderInner(i,t,e,a,o,s,l);var c=t.getBoxLayoutParams(),d={width:a.getWidth(),height:a.getHeight()},u=t.get("padding"),p=_["d"](c,d,u),g=this.layoutInner(t,i,p,n,o,l),h=_["d"](r["i"]({width:g.width,height:g.height},c),d,u);this.group.x=h.x-g.x,this.group.y=h.y-g.y,this.group.markRedraw(),this.group.add(this._backgroundEl=w(g,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,e,a,n,i,s,o){var l=this.getContentGroup(),c=r["f"](),d=e.get("selectedMode"),u=[];a.eachRawSeries((function(t){!t.get("legendHoverLink")&&u.push(t.id)})),O(e.getData(),(function(i,r){var s=i.get("name");if(!this.newlineDisabled&&(""===s||"\n"===s)){var o=new D;return o.newline=!0,void l.add(o)}var g=a.getSeriesByName(s)[0];if(!c.get(s)){if(g){var h=g.getData(),v=h.getVisual("legendLineStyle")||{},f=h.getVisual("legendIcon"),m=h.getVisual("style"),y=this._createItem(g,s,r,i,e,t,v,m,f,d);y.on("click",I(G,s,null,n,u)).on("mouseover",I(j,g.name,null,n,u)).on("mouseout",I(A,g.name,null,n,u)),c.set(s,!0)}else a.eachRawSeries((function(a){if(!c.get(s)&&a.legendVisualProvider){var o=a.legendVisualProvider;if(!o.containName(s))return;var l=o.indexOfName(s),g=o.getItemVisual(l,"style"),h=o.getItemVisual(l,"legendIcon"),v=Object(p["c"])(g.fill);v&&0===v[3]&&(v[3]=.2,g.fill=Object(p["d"])(v,"rgba"));var f=this._createItem(a,s,r,i,e,t,{},g,h,d);f.on("click",I(G,null,s,n,u)).on("mouseover",I(j,null,s,n,u)).on("mouseout",I(A,null,s,n,u)),c.set(s,!0)}}),this);0}}),this),i&&this._createSelector(i,e,n,s,o)},e.prototype._createSelector=function(t,e,a,n,i){var r=this.getSelectorGroup();O(t,(function(t){var n=t.type,i=new h["a"]({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){a.dispatchAction({type:"all"===n?"legendAllSelect":"legendInverseSelect"})}});r.add(i);var s=e.getModel("selectorLabel"),o=e.getModel(["emphasis","selectorLabel"]);Object(y["f"])(i,{normal:s,emphasis:o},{defaultText:t.title}),Object(m["m"])(i)}))},e.prototype._createItem=function(t,e,a,n,i,r,s,o,l,c){var d=t.visualDrawType,u=i.get("itemWidth"),p=i.get("itemHeight"),g=i.isSelected(e),_=n.get("symbolRotate"),b=n.get("icon");l=b||l||"roundRect";var w=i.getModel("lineStyle"),C=z(l,n,w,s,o,d,g),x=new D,S=n.getModel("textStyle");if("function"!==typeof t.getLegendIcon||b&&"inherit"!==b){var k="inherit"===b&&t.getData().getVisual("symbol")?"inherit"===_?t.getData().getVisual("symbolRotate"):_:0;x.add(R({itemWidth:u,itemHeight:p,icon:l,iconRotate:k,itemStyle:C.itemStyle,lineStyle:C.lineStyle}))}else x.add(t.getLegendIcon({itemWidth:u,itemHeight:p,icon:l,iconRotate:_,itemStyle:C.itemStyle,lineStyle:C.lineStyle}));var I="left"===r?u+5:-5,O=r,P=i.get("formatter"),G=e;"string"===typeof P&&P?G=P.replace("{name}",null!=e?e:""):"function"===typeof P&&(G=P(e));var L=n.get("inactiveColor");x.add(new h["a"]({style:Object(y["b"])(S,{text:G,x:I,y:p/2,fill:g?S.getTextColor():L,align:O,verticalAlign:"middle"})}));var j=new v["a"]({shape:x.getBoundingRect(),invisible:!0}),A=n.getModel("tooltip");return A.get("show")&&f["setTooltipConfig"]({el:j,componentModel:i,itemName:e,itemTooltipOption:A.option}),x.add(j),x.eachChild((function(t){t.silent=!0})),j.silent=!c,this.getContentGroup().add(x),Object(m["m"])(x),x.__legendDataIndex=a,x},e.prototype.layoutInner=function(t,e,a,n,i,r){var s=this.getContentGroup(),o=this.getSelectorGroup();_["a"](t.get("orient"),s,t.get("itemGap"),a.width,a.height);var l=s.getBoundingRect(),c=[-l.x,-l.y];if(o.markRedraw(),s.markRedraw(),i){_["a"]("horizontal",o,t.get("selectorItemGap",!0));var d=o.getBoundingRect(),u=[-d.x,-d.y],p=t.get("selectorButtonGap",!0),g=t.getOrient().index,h=0===g?"width":"height",v=0===g?"height":"width",f=0===g?"y":"x";"end"===r?u[g]+=l[h]+p:c[g]+=d[h]+p,u[1-g]+=l[v]/2-d[v]/2,o.x=u[0],o.y=u[1],s.x=c[0],s.y=c[1];var m={x:0,y:0};return m[h]=l[h]+p+d[h],m[v]=Math.max(l[v],d[v]),m[f]=Math.min(0,d[f]+u[1-g]),m}return s.x=c[0],s.y=c[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(C["a"]);function z(t,e,a,n,i,r,s){for(var o=e.getModel("itemStyle"),l=S["a"].concat([["decal"]]),c={},d=0;d<l.length;++d){var u=l[d][l[d].length-1],p=l[d][0],g=o.getShallow(u);if("inherit"===g)switch(p){case"fill":c.fill=i[r];break;case"stroke":c.stroke=i[0===t.lastIndexOf("empty",0)?"fill":"stroke"];break;case"opacity":c.opacity=("fill"===r?i:n).opacity;break;default:c[p]=i[p]}else"auto"===g&&"lineWidth"===p?c.lineWidth=i.lineWidth>0?2:0:c[p]=g}var h=e.getModel("lineStyle"),v=x["a"].concat([["inactiveColor"],["inactiveWidth"]]),f={};for(d=0;d<v.length;++d){u=v[d][1],p=v[d][0],g=h.getShallow(u);"inherit"===g?f[p]=n[p]:"auto"===g&&"lineWidth"===p?f.lineWidth=n.lineWidth>0?2:0:f[p]=g}if("auto"===c.fill&&(c.fill=i.fill),"auto"===c.stroke&&(c.stroke=i.fill),"auto"===f.stroke&&(f.stroke=i.fill),!s){var m=e.get("inactiveBorderWidth"),y=c[t.indexOf("empty")>-1?"fill":"stroke"];c.lineWidth="auto"===m?i.lineWidth>0&&y?2:0:c.lineWidth,c.fill=e.get("inactiveColor"),c.stroke=e.get("inactiveBorderColor"),f.stroke=a.get("inactiveColor"),f.lineWidth=a.get("inactiveWidth")}return{itemStyle:c,lineStyle:f}}function R(t){var e=t.icon||"roundRect",a=Object(k["a"])(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill);return a.setStyle(t.itemStyle),a.rotation=(t.iconRotate||0)*Math.PI/180,a.setOrigin([t.itemWidth/2,t.itemHeight/2]),e.indexOf("empty")>-1&&(a.style.stroke=a.style.fill,a.style.fill="#fff",a.style.lineWidth=2),a}function G(t,e,a,n){A(t,e,a,n),a.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),j(t,e,a,n)}function L(t){var e,a=t.getZr().storage.getDisplayList(),n=0,i=a.length;while(n<i&&!(e=a[n].states.emphasis))n++;return e&&e.hoverLayer}function j(t,e,a,n){L(a)||a.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:n})}function A(t,e,a,n){L(a)||a.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:n})}var T=P;function M(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries((function(t){for(var a=0;a<e.length;a++)if(!e[a].isSelected(t.name))return!1;return!0}))}function B(t,e,a){var n,i={},s="toggleSelected"===t;return a.eachComponent("legend",(function(a){s&&null!=n?a[n?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?a[t]():(a[t](e.name),n=a.isSelected(e.name));var o=a.getData();Object(r["j"])(o,(function(t){var e=t.get("name");if("\n"!==e&&""!==e){var n=a.isSelected(e);i.hasOwnProperty(e)?i[e]=i[e]&&n:i[e]=n}}))})),"allSelect"===t||"inverseSelect"===t?{selected:i}:{name:e.name,selected:i}}function E(t){t.registerAction("legendToggleSelect","legendselectchanged",Object(r["h"])(B,"toggleSelected")),t.registerAction("legendAllSelect","legendselectall",Object(r["h"])(B,"allSelect")),t.registerAction("legendInverseSelect","legendinverseselect",Object(r["h"])(B,"inverseSelect")),t.registerAction("legendSelect","legendselected",Object(r["h"])(B,"select")),t.registerAction("legendUnSelect","legendunselected",Object(r["h"])(B,"unSelect"))}function W(t){t.registerComponentModel(u),t.registerComponentView(T),t.registerProcessor(t.PRIORITY.PROCESSOR.SERIES_FILTER,M),t.registerSubTypeDefaulter("legend",(function(){return"plain"})),E(t)}var F=a("8918"),$=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return Object(i["b"])(e,t),e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(e,a,n){var i=Object(_["c"])(e);t.prototype.init.call(this,e,a,n),N(this,e,i)},e.prototype.mergeOption=function(e,a){t.prototype.mergeOption.call(this,e,a),N(this,this.option,e)},e.type="legend.scroll",e.defaultOption=Object(F["d"])(u.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(u);function N(t,e,a){var n=t.getOrient(),i=[1,1];i[n.index]=0,Object(_["e"])(e,a,{type:"box",ignoreSize:!!i})}var V=$,H=g["a"],U=["width","height"],q=["x","y"],J=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.newlineDisabled=!0,a._currentIndex=0,a}return Object(i["b"])(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.group.add(this._containerGroup=new H),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new H)},e.prototype.resetInner=function(){t.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(e,a,n,i,s,o,l){var c=this;t.prototype.renderInner.call(this,e,a,n,i,s,o,l);var d=this._controllerGroup,u=a.get("pageIconSize",!0),p=r["r"](u)?u:[u,u];v("pagePrev",0);var g=a.getModel("pageTextStyle");function v(t,e){var n=t+"DataIndex",s=f["createIcon"](a.get("pageIcons",!0)[a.getOrient().name][e],{onclick:r["c"](c._pageGo,c,n,a,i)},{x:-p[0]/2,y:-p[1]/2,width:p[0],height:p[1]});s.name=t,d.add(s)}d.add(new h["a"]({name:"pageText",style:{text:"xx/xx",fill:g.getTextColor(),font:g.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1)},e.prototype.layoutInner=function(t,e,a,n,i,s){var o=this.getSelectorGroup(),l=t.getOrient().index,c=U[l],d=q[l],u=U[1-l],p=q[1-l];i&&_["a"]("horizontal",o,t.get("selectorItemGap",!0));var g=t.get("selectorButtonGap",!0),h=o.getBoundingRect(),v=[-h.x,-h.y],f=r["d"](a);i&&(f[c]=a[c]-h[c]-g);var m=this._layoutContentAndController(t,n,f,l,c,u,p,d);if(i){if("end"===s)v[l]+=m[c]+g;else{var y=h[c]+g;v[l]-=y,m[d]-=y}m[c]+=h[c]+g,v[1-l]+=m[p]+m[u]/2-h[u]/2,m[u]=Math.max(m[u],h[u]),m[p]=Math.min(m[p],h[p]+v[1-l]),o.x=v[0],o.y=v[1],o.markRedraw()}return m},e.prototype._layoutContentAndController=function(t,e,a,n,i,s,o,l){var c=this.getContentGroup(),d=this._containerGroup,u=this._controllerGroup;_["a"](t.get("orient"),c,t.get("itemGap"),n?a.width:null,n?null:a.height),_["a"]("horizontal",u,t.get("pageButtonItemGap",!0));var p=c.getBoundingRect(),g=u.getBoundingRect(),h=this._showController=p[i]>a[i],m=[-p.x,-p.y];e||(m[n]=c[l]);var y=[0,0],b=[-g.x,-g.y],w=r["L"](t.get("pageButtonGap",!0),t.get("itemGap",!0));if(h){var C=t.get("pageButtonPosition",!0);"end"===C?b[n]+=a[i]-g[i]:y[n]+=g[i]+w}b[1-n]+=p[s]/2-g[s]/2,c.setPosition(m),d.setPosition(y),u.setPosition(b);var x={x:0,y:0};if(x[i]=h?a[i]:p[i],x[s]=Math.max(p[s],g[s]),x[o]=Math.min(0,g[o]+b[1-n]),d.__rectSize=a[i],h){var S={x:0,y:0};S[i]=Math.max(a[i]-g[i]-w,0),S[s]=x[s],d.setClipPath(new v["a"]({shape:S})),d.__rectSize=S[i]}else u.eachChild((function(t){t.attr({invisible:!0,silent:!0})}));var k=this._getPageInfo(t);return null!=k.pageIndex&&f["updateProps"](c,{x:k.contentPosition[0],y:k.contentPosition[1]},h?t:null),this._updatePageInfoView(t,k),x},e.prototype._pageGo=function(t,e,a){var n=this._getPageInfo(e)[t];null!=n&&a.dispatchAction({type:"legendScroll",scrollDataIndex:n,legendId:e.id})},e.prototype._updatePageInfoView=function(t,e){var a=this._controllerGroup;r["j"](["pagePrev","pageNext"],(function(n){var i=n+"DataIndex",r=null!=e[i],s=a.childOfName(n);s&&(s.setStyle("fill",r?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),s.cursor=r?"pointer":"default")}));var n=a.childOfName("pageText"),i=t.get("pageFormatter"),s=e.pageIndex,o=null!=s?s+1:0,l=e.pageCount;n&&i&&n.setStyle("text",r["z"](i)?i.replace("{current}",null==o?"":o+"").replace("{total}",null==l?"":l+""):i({current:o,total:l}))},e.prototype._getPageInfo=function(t){var e=t.get("scrollDataIndex",!0),a=this.getContentGroup(),n=this._containerGroup.__rectSize,i=t.getOrient().index,r=U[i],s=q[i],o=this._findTargetItemIndex(e),l=a.children(),c=l[o],d=l.length,u=d?1:0,p={contentPosition:[a.x,a.y],pageCount:u,pageIndex:u-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return p;var g=y(c);p.contentPosition[i]=-g.s;for(var h=o+1,v=g,f=g,m=null;h<=d;++h)m=y(l[h]),(!m&&f.e>v.s+n||m&&!_(m,v.s))&&(v=f.i>v.i?f:m,v&&(null==p.pageNextDataIndex&&(p.pageNextDataIndex=v.i),++p.pageCount)),f=m;for(h=o-1,v=g,f=g,m=null;h>=-1;--h)m=y(l[h]),m&&_(f,m.s)||!(v.i<f.i)||(f=v,null==p.pagePrevDataIndex&&(p.pagePrevDataIndex=v.i),++p.pageCount,++p.pageIndex),v=m;return p;function y(t){if(t){var e=t.getBoundingRect(),a=e[s]+t[s];return{s:a,e:a+e[r],i:t.__legendDataIndex}}}function _(t,e){return t.e>=e&&t.s<=e+n}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var e,a,n=this.getContentGroup();return n.eachChild((function(n,i){var r=n.__legendDataIndex;null==a&&null!=r&&(a=i),r===t&&(e=i)})),null!=e?e:a},e.type="legend.scroll",e}(T),X=J;function Y(t){t.registerAction("legendScroll","legendscroll",(function(t,e){var a=t.scrollDataIndex;null!=a&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},(function(t){t.setScrollDataIndex(a)}))}))}function K(t){Object(n["a"])(W),t.registerComponentModel(V),t.registerComponentView(X),Y(t)}function Z(t){Object(n["a"])(W),Object(n["a"])(K)}}}]);