(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e27f5a9"],{"1a59":function(t,e,n){},"50fc":function(t,e,n){"use strict";n.d(e,"o",(function(){return i})),n.d(e,"f",(function(){return s})),n.d(e,"B",(function(){return l})),n.d(e,"y",(function(){return o})),n.d(e,"s",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"n",(function(){return d})),n.d(e,"g",(function(){return p})),n.d(e,"C",(function(){return f})),n.d(e,"d",(function(){return h})),n.d(e,"h",(function(){return _})),n.d(e,"r",(function(){return m})),n.d(e,"p",(function(){return g})),n.d(e,"t",(function(){return w})),n.d(e,"q",(function(){return b})),n.d(e,"v",(function(){return v})),n.d(e,"i",(function(){return y})),n.d(e,"e",(function(){return k})),n.d(e,"z",(function(){return x})),n.d(e,"w",(function(){return R})),n.d(e,"u",(function(){return $})),n.d(e,"l",(function(){return S})),n.d(e,"m",(function(){return D})),n.d(e,"A",(function(){return z})),n.d(e,"x",(function(){return N})),n.d(e,"j",(function(){return I})),n.d(e,"k",(function(){return C})),n.d(e,"a",(function(){return O})),n.d(e,"c",(function(){return T}));var a=n("bc3a"),r=n.n(a);function i(t={}){return r.a.get("/tenants",{params:t})}function s(t){return r.a.post("/tenants",t)}function l(t,e){return r.a.put("/tenants/"+t,e)}function o(t){return r.a.patch(`/tenants/${t}/toggle`)}function u(t,e){return r.a.post(`/tenants/${t}/recharge`,e)}function c(t,e){return r.a.post(`/tenants/${t}/assign-plan`,{plan_id:e})}function d(t,e={}){return r.a.get(`/tenants/${t}/tenant-strategies`,{params:e})}function p(t,e){return r.a.post(`/tenants/${t}/tenant-strategies`,e)}function f(t,e,n){return r.a.put(`/tenants/${t}/tenant-strategies/${e}`,n)}function h(t,e){return r.a.post(`/tenants/${t}/tenant-strategies/${e}/copy-from-master`)}function _(t,e){return r.a.delete(`/tenants/${t}/tenant-strategies/${e}`)}function m(t={}){return r.a.get("/users",{params:t})}function g(t){return r.a.get("/users/"+t)}function w(t,e){return r.a.post(`/users/${t}/recharge`,e)}function b(t,e={}){return r.a.get(`/users/${t}/team`,{params:e})}function v(t,e){return r.a.post(`/users/${t}/set-market-node`,e)}function y(t={}){return r.a.get("/admins",{params:t})}function k(t){return r.a.post("/admins",t)}function x(t,e){return r.a.put("/admins/"+t,e)}function R(t){return r.a.patch(`/admins/${t}/toggle`)}function $(t,e){return r.a.post(`/admins/${t}/reset-password`,e)}function S(t={}){return r.a.get("/strategies",{params:t})}function D(t){return r.a.get("/strategies/"+t)}function z(t,e){return r.a.post("/strategies/"+t,e)}function N(t){return r.a.patch(`/strategies/${t}/toggle`)}function I(t={}){return r.a.get("/strategy-bindings-admin",{params:t})}function C(t={}){return r.a.get("/exchange-accounts",{params:t})}function O(t,e){return r.a.put(`/exchange-accounts/${t}/assign-node`,e)}function T(t){return r.a.post("/exchange-accounts/batch-assign-node",t)}},"7a00":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ele-body"},[n("el-card",{attrs:{shadow:"never"}},[n("div",{staticClass:"toolbar"},[n("span",{staticClass:"toolbar-title"},[t._v("策略绑定")]),n("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.fetchData}},[t._v("刷新")])],1),n("div",{staticClass:"search-bar"},[n("el-form",{attrs:{inline:!0,size:"small"}},[n("el-form-item",{attrs:{label:"租户ID"}},[n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"租户ID",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.tenant_id,callback:function(e){t.$set(t.where,"tenant_id",t._n(e))},expression:"where.tenant_id"}})],1),n("el-form-item",{attrs:{label:"用户ID"}},[n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"用户ID",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.where.user_id,callback:function(e){t.$set(t.where,"user_id",t._n(e))},expression:"where.user_id"}})],1),n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.where.status,callback:function(e){t.$set(t.where,"status",e)},expression:"where.status"}},[n("el-option",{attrs:{label:"运行",value:1}}),n("el-option",{attrs:{label:"停止",value:0}})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.resetSearch}},[t._v("重置")])],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"12px"},attrs:{data:t.list,stripe:"",border:"",size:"small","header-cell-style":{background:"#fafafa"}}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),n("el-table-column",{attrs:{prop:"tenant_name",label:"租户",width:"120","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"user_email",label:"用户","min-width":"150","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"strategy_name",label:"策略",width:"150","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"exchange_account_label",label:"交易所账户",width:"150","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{prop:"mode",label:"模式",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:2===a.mode?"danger":"info",size:"mini"}},[t._v(t._s(2===a.mode?"实盘":"模拟"))])]}}])}),n("el-table-column",{attrs:{label:"点卡",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("div",{staticStyle:{"font-size":"12px"}},[t._v("自充: "+t._s(t.formatNum(a.point_card_self)))]),n("div",{staticStyle:{"font-size":"12px",color:"#909399"}},[t._v("赠送: "+t._s(t.formatNum(a.point_card_gift)))])]}}])}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-tag",{attrs:{type:1===a.status?"success":"info",size:"mini",effect:"dark"}},[t._v(t._s(1===a.status?"运行":"停止"))])]}}])}),n("el-table-column",{attrs:{prop:"created_at",label:"绑定时间",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(t._s(t.formatTime(n.created_at)))]}}])}),n("el-table-column",{attrs:{label:"操作",width:"100",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(e){return t.showDetail(a)}}},[t._v("详情")])]}}])})],1),t.loading||0!==t.list.length?t._e():n("el-empty",{attrs:{description:"暂无策略绑定"}}),t.total>0?n("div",{staticStyle:{"margin-top":"12px",display:"flex","justify-content":"space-between","align-items":"center"}},[n("span",{staticClass:"tip"},[t._v("共 "+t._s(t.total)+" 条")]),n("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":t.pageSize,total:t.total,layout:"prev, pager, next"},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.fetchData}})],1):t._e()],1),n("el-dialog",{attrs:{title:"绑定详情",visible:t.detailVisible,width:"560px","append-to-body":""},on:{"update:visible":function(e){t.detailVisible=e}}},[t.detailRow?n("el-descriptions",{attrs:{column:1,border:"",size:"small"}},[n("el-descriptions-item",{attrs:{label:"绑定ID"}},[t._v(t._s(t.detailRow.id))]),n("el-descriptions-item",{attrs:{label:"租户"}},[t._v(t._s(t.detailRow.tenant_name||"-")+" (ID: "+t._s(t.detailRow.tenant_id||"-")+")")]),n("el-descriptions-item",{attrs:{label:"用户"}},[t._v(t._s(t.detailRow.user_email||"-")+" (ID: "+t._s(t.detailRow.user_id)+")")]),n("el-descriptions-item",{attrs:{label:"策略"}},[t._v(t._s(t.detailRow.strategy_name||t.detailRow.strategy_code)+" ("+t._s(t.detailRow.strategy_code)+")")]),n("el-descriptions-item",{attrs:{label:"交易所账户"}},[t._v(t._s(t.detailRow.exchange_account_label||"-")+" (账户ID: "+t._s(t.detailRow.account_id)+")")]),n("el-descriptions-item",{attrs:{label:"模式"}},[t._v(t._s(2===t.detailRow.mode?"实盘":"模拟"))]),n("el-descriptions-item",{attrs:{label:"点卡（自充/赠送）"}},[t._v(t._s(t.formatNum(t.detailRow.point_card_self))+" / "+t._s(t.formatNum(t.detailRow.point_card_gift)))]),n("el-descriptions-item",{attrs:{label:"累计盈亏"}},[t._v(t._s(t.formatNum(t.detailRow.total_profit)))]),n("el-descriptions-item",{attrs:{label:"交易笔数"}},[t._v(t._s(t.detailRow.total_trades||0))]),n("el-descriptions-item",{attrs:{label:"状态"}},[n("el-tag",{attrs:{type:1===t.detailRow.status?"success":"info",size:"small"}},[t._v(t._s(1===t.detailRow.status?"运行":"停止"))])],1),n("el-descriptions-item",{attrs:{label:"绑定时间"}},[t._v(t._s(t.formatTime(t.detailRow.created_at)))])],1):t._e(),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.detailVisible=!1}}},[t._v("关闭")]),n("el-button",{attrs:{type:"primary"},on:{click:t.goToUser}},[t._v("前往用户管理")])],1)],1)],1)},r=[],i=n("50fc"),s={name:"StrategyBindings",data(){return{loading:!1,list:[],total:0,page:1,pageSize:20,where:{tenant_id:null,user_id:null,status:null},detailVisible:!1,detailRow:null}},mounted(){this.fetchData()},methods:{formatNum(t){return null!==t&&void 0!==t?parseFloat(t).toFixed(2):"0.00"},formatTime(t){return t?t.replace("T"," ").substring(0,19):"-"},onSearch(){this.page=1,this.fetchData()},resetSearch(){this.where={tenant_id:null,user_id:null,status:null},this.page=1,this.fetchData()},showDetail(t){this.detailRow=t,this.detailVisible=!0},goToUser(){this.detailRow&&this.detailRow.user_id&&(this.detailVisible=!1,this.$router.push({path:"/operation/users",query:{user_id:this.detailRow.user_id}}))},async fetchData(){this.loading=!0;try{const t={page:this.page,page_size:this.pageSize};null!=this.where.tenant_id&&""!==this.where.tenant_id&&(t.tenant_id=Number(this.where.tenant_id)),null!=this.where.user_id&&""!==this.where.user_id&&(t.user_id=Number(this.where.user_id)),null!==this.where.status&&""!==this.where.status&&(t.status=Number(this.where.status));const e=await Object(i["j"])(t),n=e.data;this.list=n.data||n||[],this.total=null!=n.total?n.total:this.list.length}catch(e){var t;this.$message.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.detail)||"获取策略绑定失败")}finally{this.loading=!1}}}},l=s,o=(n("fdb7"),n("2877")),u=Object(o["a"])(l,a,r,!1,null,"5332c3dc",null);e["default"]=u.exports},fdb7:function(t,e,n){"use strict";n("1a59")}}]);