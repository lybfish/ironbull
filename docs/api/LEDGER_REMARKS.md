# 流水类接口备注（remark）说明

所有返回流水的接口中，`remark` 字段为系统或业务写入的**中文说明**，便于对账与运营查看。本文档按接口/流水类型逐一列出**备注取值及含义**。

---

## 一、点卡流水（Merchant API）

**接口**：`GET /merchant/point-card/logs`（需 AppKey+Sign 鉴权）

- **传 `email`**：查询该**用户**的点卡流水（App 端「点卡记录」）。
- **不传 `email`**：查询**商户（代理商）**自己的点卡流水。

### 1. 用户点卡流水（传了 email）

| change_type | change_type_name | remark 取值说明 |
|-------------|------------------|-----------------|
| 1 | 充值 | `代理商充值`：商户给该用户充的自充点卡；或来自**后台充值**时写 `后台充值(self)` |
| 2 | 赠送 | `代理商赠送`：商户给该用户充的赠送点卡；或来自**后台充值**时写 `后台充值(gift)` |
| 3 | 转出 | `自充转出给用户#<to_user_id>` / `赠送转出给用户#<to_user_id>`：用户间互转时的转出方 |
| 4 | 转入 | `从用户#<from_user_id>自充转入` / `从用户#<from_user_id>赠送转入`：用户间互转时的转入方 |
| 5 | 盈利扣费 | `盈利扣费30%`：策略盈利结算时扣点卡 30% 写入的流水 |

**说明**：`source_type` / `source_type_name` 仅用户流水有，1=自充、2=赠送（表示该笔来自自充池还是赠送池）。

### 2. 商户（代理商）点卡流水（未传 email）

| change_type | change_type_name | remark 取值说明 |
|-------------|------------------|-----------------|
| 1 | 后台充值 | `后台充值(self)` / `后台充值(gift)`：运营在 data-api 后台给该商户充的自充/赠送点卡 |
| 2 | 后台赠送 | 同上，由后台操作写入 |
| 3 | 分发给用户 | `分发给用户#<user_id>（充值）` / `分发给用户#<user_id>（赠送）`：商户通过接口给用户充值/赠送点卡 |

---

## 二、奖励流水（Merchant API）

**接口**：`GET /merchant/user/rewards`（需 AppKey+Sign，传 `email` 查该用户的奖励记录）

| reward_type | reward_type_name | remark 取值说明 |
|-------------|------------------|-----------------|
| 直推奖励 | 直推奖励 | `直推奖励`：下级盈利扣费进入利润池后，直推上级分得的奖励 |
| 级差奖 | 级差奖 | `级差奖`：级差规则下分得的奖励 |
| 平级奖 | 平级奖 | `平级奖`：平级规则下分得的奖励 |

**说明**：奖励流水表为 `fact_user_reward`，每条对应一笔奖励入账；`remark` 固定为上述三种之一。

---

## 三、奖励余额流水 / 提现相关（内部 fact_reward_log）

**说明**：提现申请、审核拒绝会写 `fact_reward_log`（奖励余额变动），Merchant API 的「奖励流水」为 `fact_user_reward`。若后续有接口暴露 `fact_reward_log`，其 `remark` 取值为：

| 场景 | remark 取值说明 |
|------|-----------------|
| 用户申请提现 | `提现冻结`：扣减可提现余额、写入待审核记录时 |
| 审核拒绝提现 | `提现拒绝退回: <原因>` 或 `提现拒绝退回`：拒绝后余额退回时 |

---

## 四、账务流水（Data API）

**接口**：`GET /api/transactions`（需登录态，tenant_id 必填）

**用途**：Ledger 层交易/资金流水（订单成交、入金、手续费、盈亏等）。

| 说明 |
|------|
| `remark` 由业务在写入流水时传入，**无固定枚举**。常见为成交结算、入金、出金、手续费、强平等描述，具体以实际写入为准。 |

---

## 五、接口与字段速查

| 接口 | 流水类型 | remark 是否枚举 | 说明文档 |
|------|----------|-----------------|----------|
| GET /merchant/point-card/logs | 点卡流水 | 是（见上表） | 本节 一 |
| GET /merchant/user/rewards | 奖励流水 | 是（直推/级差/平级） | 本节 二 |
| GET /api/transactions | 账务流水 | 否，业务自定义 | 本节 四 |

**约定**：所有流水接口返回的 `remark` 均为**字符串**，可能为空字符串；展示时建议对空值显示为「—」或留空。
